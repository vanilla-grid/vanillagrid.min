function getVanillagrid(){return new function(){let e={};this.gridIds=[],this.sortAscSpan=null,this.sortDescSpan=null,this.filterSpan=null,this.footerFormula={},this.dataType={},this.lessoreq0x7ffByte=2,this.lessoreq0xffffByte=3,this.greater0xffffByte=4,this.get=function(t){if(this.gridIds.indexOf(t)<0)throw new Error("The grid id is not defined.");return e[t]},this.defaultGridInfo={},this.defaultGridInfo.locked=!1,this.defaultGridInfo.lockedColor=!0,this.defaultGridInfo.resizable=!0,this.defaultGridInfo.redoable=!0,this.defaultGridInfo.redoCount=30,this.defaultGridInfo.visible=!0,this.defaultGridInfo.headerVisible=!0,this.defaultGridInfo.rownumVisible=!0,this.defaultGridInfo.rownumSize="60px",this.defaultGridInfo.statusVisible=!0,this.defaultGridInfo.selectionPolicy="range",this.defaultGridInfo.nullValue=null,this.defaultGridInfo.dateFormat="yyyy-mm-dd",this.defaultGridInfo.monthFormat="yyyy-mm",this.defaultGridInfo.alterRow=!0,this.defaultGridInfo.frozenColCount=0,this.defaultGridInfo.frozenRowCount=0,this.defaultGridInfo.sortable=!0,this.defaultGridInfo.filterable=!0,this.defaultGridInfo.allCheckable=!0,this.defaultGridInfo.checkedValue="Y",this.defaultGridInfo.uncheckedValue="N",this.defaultGridCssInfo={},this.defaultGridCssInfo.width="100%",this.defaultGridCssInfo.height="600px",this.defaultGridCssInfo.margin="0 auto",this.defaultGridCssInfo.padding="0",this.defaultGridCssInfo.sizeLevel=5,this.defaultGridCssInfo.verticalAlign="center",this.defaultGridCssInfo.cellFontSize=14,this.defaultGridCssInfo.cellMinHeight=21,this.defaultGridCssInfo.horizenBorderSize=1,this.defaultGridCssInfo.verticalBorderSize=1,this.defaultGridCssInfo.gridFontFamily="Arial",this.defaultGridCssInfo.editorFontFamily="Arial",this.defaultGridCssInfo.overflowWrap=null,this.defaultGridCssInfo.wordBreak=null,this.defaultGridCssInfo.whiteSpace=null,this.defaultGridCssInfo.linkHasUnderLine=!0,this.defaultGridCssInfo.invertColor=!1,this.defaultGridCssInfo.color=null,this.defaultGridCssInfo.colorSet=null,this.defaultGridCssInfo.gridBorderColor=null,this.defaultGridCssInfo.headerCellBackColor=null,this.defaultGridCssInfo.headerCellBorderColor=null,this.defaultGridCssInfo.headerCellFontColor=null,this.defaultGridCssInfo.footerCellBackColor=null,this.defaultGridCssInfo.footerCellBorderColor=null,this.defaultGridCssInfo.footerCellFontColor=null,this.defaultGridCssInfo.bodyBackColor=null,this.defaultGridCssInfo.bodyCellBackColor=null,this.defaultGridCssInfo.bodyCellBorderColor=null,this.defaultGridCssInfo.bodyCellFontColor=null,this.defaultGridCssInfo.editorBackColor=null,this.defaultGridCssInfo.editorFontColor=null,this.defaultGridCssInfo.selectCellBackColor=null,this.defaultGridCssInfo.selectCellFontColor=null,this.defaultGridCssInfo.selectColBackColor=null,this.defaultGridCssInfo.selectColFontColor=null,this.defaultGridCssInfo.selectRowBackColor=null,this.defaultGridCssInfo.selectRowFontColor=null,this.defaultGridCssInfo.mouseoverCellBackColor=null,this.defaultGridCssInfo.mouseoverCellFontColor=null,this.defaultGridCssInfo.lockCellBackColor=null,this.defaultGridCssInfo.lockCellFontColor=null,this.defaultGridCssInfo.alterRowBackColor=null,this.defaultGridCssInfo.alterRowFontColor=null,this.defaultGridCssInfo.buttonFontColor=null,this.defaultGridCssInfo.buttonBorderColor=null,this.defaultGridCssInfo.buttonBackColor=null,this.defaultGridCssInfo.buttonHoverFontColor=null,this.defaultGridCssInfo.buttonHoverBackColor=null,this.defaultGridCssInfo.buttonActiveFontColor=null,this.defaultGridCssInfo.buttonActiveBackColor=null,this.defaultGridCssInfo.linkFontColor=null,this.defaultGridCssInfo.linkHoverFontColor=null,this.defaultGridCssInfo.linkActiveFontColor=null,this.defaultGridCssInfo.linkVisitedFontColor=null,this.defaultGridCssInfo.linkFocusFontColor=null,this.defaultColInfo={},this.defaultColInfo.rowMerge=!1,this.defaultColInfo.colMerge=!1,this.defaultColInfo.colVisible=!0,this.defaultColInfo.required=!1,this.defaultColInfo.resizable=!0,this.defaultColInfo.sortable=!0,this.defaultColInfo.filterable=!0,this.defaultColInfo.originWidth="80px",this.defaultColInfo.dataType="text",this.defaultColInfo.selectSize="100%",this.defaultColInfo.format=null,this.defaultColInfo.codes=null,this.defaultColInfo.defaultCode=null,this.defaultColInfo.maxLength=null,this.defaultColInfo.maxByte=null,this.defaultColInfo.maxNumber=null,this.defaultColInfo.minNumber=null,this.defaultColInfo.roundNumber=null,this.defaultColInfo.align=null,this.defaultColInfo.verticalAlign=null,this.defaultColInfo.overflowWrap=null,this.defaultColInfo.wordBreak=null,this.defaultColInfo.whiteSpace=null,this.defaultColInfo.backColor=null,this.defaultColInfo.fontColor=null,this.defaultColInfo.fontBold=!1,this.defaultColInfo.fontItalic=!1,this.defaultColInfo.fontThruline=!1,this.defaultColInfo.fontUnderline=!1,this.checkRequiredFunction=function(e){return e&&window[e.gridId]?(alert(e.row+" For the row, please enter the value for "+e.name+"."),void window[e.gridId].editCell(e.row,e.col)):e&&this.get(e.gridId)?(alert(e.row+" For the row, please enter the value for "+e.name+"."),void this.get(e.gridId).editCell(e.row,e.col)):void 0},this._docEvent_mousedown=null,this._docEvent_mouseup=null,this._docEvent_keydown=null,this._docEvent_copy=null,this._docEvent_paste=null,this._VanillaGrid=null,this._GridHeader=null,this._GridBody=null,this._GridHeader=null,this._GridFooter=null,this._GridData=null,this.create=function(){const t=this,o=document.querySelectorAll("vanilla-grid");for(const e of o){if(!e.getAttribute("id"))throw new Error("The grid's id is a required attribute.");t.gridIds.push(e.getAttribute("id"))}if(new Set(t.gridIds).size!==t.gridIds.length)throw new Error("There is a duplicate grid ID.");if(t.gridIds.length<=0)return;const l={isDragging:!1,onHeaderDragging:!1,isHeaderDragging:!1,mouseX:0,mouseY:0,activeGrid:null,activeGridEditor:null,editOldValue:null,editNewValue:null,filterOldValue:null,filterNewValue:null,mouseoverCell:null,validateNumber(e){const t=Number(e);if(isNaN(t))throw new Error("The provided parameter is not a number.");return t},validateIntegerAndZero(e){const t=Number(e);if(isNaN(t))throw new Error("The provided parameter is not a number.");if(!Number.isInteger(t))throw new Error("The provided number is not an integer.");return t},validatePositiveIntegerAndZero(e){const t=Number(e);if(isNaN(t))throw new Error("The provided parameter is not a number.");if(!Number.isInteger(t))throw new Error("The provided number is not an integer.");if(t<0)throw new Error("The provided number is not a positive integer.");return t},extractNumberAndUnit(e){if(null==e)return"";const t=(e=""+e.trim()).match(/^(\d+)(\D*)$/);if(t){const e=""===t[2]?null:t[2];return{number:parseInt(t[1],10),unit:e}}return""},toLowerCase:e=>e&&"string"==typeof e?e.toLowerCase():"",toUpperCase:e=>e&&"string"==typeof e?e.toUpperCase():"",isIncludeEnum:(e,t)=>Object.values(e).includes(t),isValidDate(e,t,o){const l=new Date(e,t-1,o);return l.getFullYear()==e&&l.getMonth()+1==t&&l.getDate()==o},isValidEmail:e=>/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e),getCutByteLength(e,o){if(null==e)return null;let l=0,r=(e=String(e)).length;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);if(l+=i<=127?1:i<=2047?t.lessoreq0x7ffByte:i<=65535?t.lessoreq0xffffByte:t.greater0xffffByte,l>o){r=n;break}}return e.substring(0,r)},deepCopy(e,t){if(null===e||"object"!=typeof e)return e;if(e.constructor!==Object&&e.constructor!==Array)return e;t||(t=[]);for(let o=0;o<t.length;o++)if(t[o].source===e)return t[o].copy;let o;if(Array.isArray(e)){o=[],t.push({source:e,copy:o});for(let l=0;l<e.length;l++)o[l]=this.deepCopy(e[l],t)}else{o={},t.push({source:e,copy:o});for(let l in e)e.hasOwnProperty(l)&&(o[l]=this.deepCopy(e[l],t))}return o},deepFreeze(e,t){const o=Object.getOwnPropertyNames(e),l=this;return o.forEach((o=>{const r=e[o];t&&t.indexOf(o)<0&&"object"==typeof r&&null!==r&&l.deepFreeze(r,t)})),Object.freeze(e)},getArrayElementWithBoundCheck(e,t){if(null==(t=this.getOnlyNumberWithNaNToNull(t)))throw new Error("Please enter the correct index.");if(t<0||t>=e.length)throw new Error("Index is out of range. Please enter the correct index.");return e[t]},removeAllChild(e){for(;e.firstChild;)e.removeChild(e.firstChild)},getBorderWidth(e){const t=getComputedStyle(e);return this.extractNumberAndUnit(t.borderLeftWidth).number+this.extractNumberAndUnit(t.borderRightWidth).number},getBorderHeight(e){const t=getComputedStyle(e);return this.extractNumberAndUnit(t.borderTopWidth).number+this.extractNumberAndUnit(t.borderBottomWidth).number},getHexColorFromColorName(e){if(/^#[0-9a-fA-F]{6}$/.test(e))return e;const t=document.createElement("div");t.style.color=e,document.body.appendChild(t);const o=window.getComputedStyle(t).color;document.body.removeChild(t);const l=o.match(/\d+/g);return"#"+((1<<24)+(+l[0]<<16)+(+l[1]<<8)+ +l[2]).toString(16).slice(1)},getColorShade(e){let t=0;return parseInt(e.slice(1,3),16)>=160&&t++,parseInt(e.slice(3,5),16)>=160&&t++,parseInt(e.slice(5,7),16)>=160&&t++,t>=2?"light":"dark"},getAdjustHexColor(e,t){e.startsWith("#")&&(e=e.slice(1));let o=parseInt(t,16);t.startsWith("-")&&(o=-parseInt(t.slice(1),16));let l=parseInt(e.slice(0,2),16),r=parseInt(e.slice(2,4),16),n=parseInt(e.slice(4,6),16);return l=parseInt(l+o),r=parseInt(r+o),n=parseInt(n+o),l=(l<0?0:l>255?255:l).toString(16).padStart(2,"0"),r=(r<0?0:r>255?255:r).toString(16).padStart(2,"0"),n=(n<0?0:n>255?255:n).toString(16).padStart(2,"0"),"#"+l+r+n},getMostLightHexColor(e){e.startsWith("#")&&(e=e.slice(1));let t=parseInt(e.slice(0,2),16),o=parseInt(e.slice(2,4),16),l=parseInt(e.slice(4,6),16);return t=parseInt(210+t/255*50),o=parseInt(210+o/255*50),l=parseInt(210+l/255*50),t=(t<0?0:t>255?248:t).toString(16).padStart(2,"0"),o=(o<0?0:o>255?248:o).toString(16).padStart(2,"0"),l=(l<0?0:l>255?248:l).toString(16).padStart(2,"0"),"#"+t+o+l},getInvertColor(e){e.startsWith("#")&&(e=e.slice(1));let t=255-parseInt(e.slice(0,2),16),o=255-parseInt(e.slice(2,4),16),l=255-parseInt(e.slice(4,6),16);return t=t<127.5?t+16:t-16,o=o<127.5?o+16:o-16,l=l<127.5?l+16:l-16,t=(t<0?0:t>255?255:t).toString(16).padStart(2,"0"),o=(o<0?0:o>255?255:o).toString(16).padStart(2,"0"),l=(l<0?0:l>255?255:l).toString(16).padStart(2,"0"),"#"+t+o+l},getCssTextFromObject(e){let t="";if(!e||e.constructor!==Object||0===Object.keys(e).length)return t;let o=Object.entries(e);for(let e=0;e<o.length;e++)o[e].length<2||(t+=o[e][0].trim()+":"+o[e][1].trim()+";");return t},getColorFromColorSet(e){switch(e){case"skyblue":return"#91c8e4";case"blue":return"#4682a9";case"light-red":return"#fdd2bf";case"red":return"#b61919";case"light-green":return"#a4be7b";case"green":return"#217346";case"orange":return"#f79327";case"yellow":return"#ffe569";case"purple":return"#804674";case"brown":return"#675d50";case"black":return"#272829";default:throw new Error("Please enter the correct colorSet.")}},setColorSet(e){let t=e.color;if(t||(t="#f3f3f3"),"black"!==t&&"#000"!==t&&"#000000"!==t&&"#000000"===this.getHexColorFromColorName(t))throw new Error("Please enter the correct color.");t=this.getHexColorFromColorName(t);const o="light"===this.getColorShade(t),l=o?"#333333":"#ffffff",r=this.getMostLightHexColor(t);e.gridBorderColor=this.getAdjustHexColor(t,"-4f"),e.bodyBackColor="#ffffff",e.headerCellBackColor=t,e.headerCellBorderColor=this.getAdjustHexColor(t,"-4f"),e.headerCellFontColor=l,e.footerCellBackColor=t,e.footerCellBorderColor=this.getAdjustHexColor(t,"-4f"),e.footerCellFontColor=l,e.bodyCellBackColor="#ffffff",e.bodyCellBorderColor=this.getAdjustHexColor(t,"-f"),e.bodyCellFontColor="#333333",e.editorBackColor="#fefefe",e.editorFontColor="#333333",e.selectCellBackColor=this.getAdjustHexColor(t,"-2f"),e.selectCellFontColor=l,e.selectColBackColor=this.getAdjustHexColor(t,"-2f"),e.selectColFontColor=l,e.selectRowBackColor=this.getAdjustHexColor(r,o?"-f":"-2f"),e.selectRowFontColor="#333333",e.mouseoverCellBackColor=t,e.mouseoverCellFontColor=l,e.lockCellBackColor=this.getAdjustHexColor(r,o?"-6":"-1f"),e.lockCellFontColor="#666666",e.alterRowBackColor=r,e.alterRowFontColor="#333333",e.buttonFontColor=l,e.buttonBackColor=t,e.buttonBorderColor=this.getAdjustHexColor(t,o?"-cf":"-4f"),e.buttonHoverFontColor=l,e.buttonHoverBackColor=this.getAdjustHexColor(t,"-f"),e.buttonActiveFontColor=l,e.buttonActiveBackColor=this.getAdjustHexColor(t,"-2f"),e.linkFontColor=this.getAdjustHexColor(t,o?"-cf":"0"),e.linkHoverFontColor=this.getAdjustHexColor(t,o?"-4f":"af"),e.linkActiveFontColor=this.getAdjustHexColor(t,o?"-cf":"0"),e.linkVisitedFontColor=this.getAdjustHexColor(t,o?"-5f":"2f"),e.linkFocusFontColor=this.getAdjustHexColor(t,o?"-4f":"bf")},setInvertColor(e){e.gridBorderColor=this.getInvertColor(e.gridBorderColor),e.headerCellBackColor=this.getInvertColor(e.headerCellBackColor),e.headerCellBorderColor=this.getInvertColor(e.headerCellBorderColor),e.headerCellFontColor=this.getInvertColor(e.headerCellFontColor),e.footerCellBackColor=this.getInvertColor(e.footerCellBackColor),e.footerCellBorderColor=this.getInvertColor(e.footerCellBorderColor),e.footerCellFontColor=this.getInvertColor(e.footerCellFontColor),e.bodyBackColor=this.getInvertColor(e.bodyBackColor),e.bodyCellBackColor=this.getInvertColor(e.bodyCellBackColor),e.bodyCellBorderColor=this.getInvertColor(e.bodyCellBorderColor),e.bodyCellFontColor=this.getInvertColor(e.bodyCellFontColor),e.editorBackColor=this.getInvertColor(e.editorBackColor),e.editorFontColor=this.getInvertColor(e.editorFontColor),e.selectCellBackColor=this.getInvertColor(e.selectCellBackColor),e.selectCellFontColor=this.getInvertColor(e.selectCellFontColor),e.selectColBackColor=this.getInvertColor(e.selectColBackColor),e.selectColFontColor=this.getInvertColor(e.selectColFontColor),e.selectRowBackColor=this.getInvertColor(e.selectRowBackColor),e.selectRowFontColor=this.getInvertColor(e.selectRowFontColor),e.mouseoverCellBackColor=this.getInvertColor(e.mouseoverCellBackColor),e.mouseoverCellFontColor=this.getInvertColor(e.mouseoverCellFontColor),e.lockCellBackColor=this.getInvertColor(e.lockCellBackColor),e.lockCellFontColor=this.getInvertColor(e.lockCellFontColor),e.alterRowBackColor=this.getInvertColor(e.alterRowBackColor),e.alterRowFontColor=this.getInvertColor(e.alterRowFontColor),e.buttonFontColor=this.getInvertColor(e.buttonFontColor),e.buttonBorderColor=this.getInvertColor(e.buttonBorderColor),e.buttonBackColor=this.getInvertColor(e.buttonBackColor),e.buttonHoverFontColor=this.getInvertColor(e.buttonHoverFontColor),e.buttonHoverBackColor=this.getInvertColor(e.buttonHoverBackColor),e.buttonActiveFontColor=this.getInvertColor(e.buttonActiveFontColor),e.buttonActiveBackColor=this.getInvertColor(e.buttonActiveBackColor),e.linkFontColor=this.getInvertColor(e.linkFontColor),e.linkHoverFontColor=this.getInvertColor(e.linkHoverFontColor),e.linkActiveFontColor=this.getInvertColor(e.linkActiveFontColor),e.linkVisitedFontColor=this.getInvertColor(e.linkVisitedFontColor),e.linkFocusFontColor=this.getInvertColor(e.linkFocusFontColor)},getAttributeWithCheckRequired(e,t){if(t.getAttribute(e))return t.getAttribute(e);throw new Error("'"+e+"' is required.")},getAttributeOnlyNumberIntegerOrZero(e,t){let o=t.getAttribute(e);return null==o||""===o?null:(o=Number(o),Number.isInteger(o)&&o>=0?o:null)},getAttributeOnlyNumberInteger(e,t){let o=t.getAttribute(e);return null==o||""===o?null:(o=Number(o),Number.isInteger(o)?o:null)},getAttributeOnlyNumber(e,t){let o=t.getAttribute(e);return null==o||""===o?null:(o=Number(o),isNaN(o)?null:o)},getAttributeOnlyBoolean(e,t){let o=t.getAttribute(e);return null==o||""===o?null:"true"===this.toLowerCase(o)},getOnlyNumberWithNaNToZero(e){const t=Number(e);return isNaN(t)?0:t},getOnlyNumberWithNaNToNull(e){const t=Number(e);return isNaN(t)?null:t},getCheckboxCellTrueOrFalse(e){const t=e.cValue,o=this[e.gId].info.gCheckedValue,l=this[e.gId].info.gUncheckedValue;return"boolean"==typeof t?(e.cValue=t?o:l,t):t===o||(e.cValue=l,!1)},isElementVisible(e){const t=e.getBoundingClientRect();if(t.top>=0&&t.left>=0&&t.bottom<=window.innerHeight&&t.right<=window.innerWidth){const o=t.left+(t.right-t.left)/2,l=t.top+(t.bottom-t.top)/2,r=document.elementFromPoint(o,l);return e.contains(r)||e===r}return!1},getFirstChildTextNode(e){for(let t=0;t<e.childNodes.length;t++){const o=e.childNodes[t];if(o.nodeType===Node.TEXT_NODE)return o}return null},nvl:(e,t)=>null==e||""===e?t:e,getVerticalAlign(e){switch(this.toLowerCase(e)){case"top":return"flex-start";case"bottom":return"flex-end";default:return"center"}},reConnectedCallbackElement(e){if(["ghd","gbd","gfd"].indexOf(e.gType)<0)return;const t=e.parentNode;t&&(this.setGridDataPosition(e),t.removeChild(e),t.appendChild(e))},checkIsValueOrData(e){let t=null;for(const o of e)if(o.constructor===Object){if(null!==t&&!1===t)throw new Error("Please insert valid datas.");t=!0}else{if(!Array.isArray(o))throw new Error("Please insert valid datas.");if(o[0]&&o[0].constructor!==Object)throw new Error("Please insert valid datas.");if(null!==t&&!0===t)throw new Error("Please insert valid datas.");t=!1}return t},modifyColSize(e,t,o){if(!t)return;if(!t.cResizable)return;if("v-g-rownum"===t.cId||"v-g-status"===t.cId)return;if(!1===this.doEventWithCheckChanged(e,"_onResize",t.cId))return;const l=this[e]._getHeader(),r=this[e]._getBody(),n=this[e]._getFooter(),i=l.style.gridTemplateColumns.split(" "),a=i[t.col-1];"%"===this.extractNumberAndUnit(a).unit&&(o=o>0?1:o<0?-1:0);const s=this.extractNumberAndUnit(a).number+o+this.extractNumberAndUnit(a).unit;i[t.col-1]=s;const c=i.join(" ");l.style.gridTemplateColumns=c,r.style.gridTemplateColumns=c,n.style.gridTemplateColumns=c},changeColSize(e,t,o){if("number"!=typeof o||o<0)throw new Error("The format of size is only zero or positive integers.");const l=this[e];if(l._getHeaderCell(1,t).frozenCol)return;const r=0!==o;for(let o=1;o<=this[e].getHeaderRowCount();o++){const e=l._getHeaderCell(o,t);e.cColVisible=r,this.reConnectedCallbackElement(e)}for(let o=1;o<=this[e].getRowCount();o++)l._getCell(o,t).cColVisible=r;for(let o=1;o<=this[e].getFooterRowCount();o++){const e=l._getFooterCell(o,t);e.cColVisible=r,this.reConnectedCallbackElement(e)}const n=l._getHeader(),i=l._getBody(),a=l._getFooter(),s=n.style.gridTemplateColumns.split(" "),c=s[t-1],d=o+this.extractNumberAndUnit(c).unit;s[t-1]=d;const u=s.join(" ");n.style.gridTemplateColumns=u,i.style.gridTemplateColumns=u,a.style.gridTemplateColumns=u},selectCell(e){const t=e.gId;return!1!==this.doEventWithCheckChanged(t,"_onActiveCell",e.row,e.cId)&&(!1!==this.doEventWithCheckChanged(t,"_onActiveRow",e.row)&&(!1!==this.doEventWithCheckChanged(t,"_onActiveCol",e.cId)&&("none"!==this[t].info.gSelectionPolicy&&(this.resetSelection(t),this[t].variables._targetCell=e,this.selectCells(e,e),this.focusCell(e),!0))))},focusCell(e){const t=e.gId,o=this[t].getBoundingClientRect(),l=this[t]._getHeader(),r=this[t]._getFooter(),n=e.getBoundingClientRect(),i=n.top-o.top-l.clientHeight,a=n.bottom-o.top+r.clientHeight,s=n.left-o.left,c=n.right-o.left;i<0?this[t].scrollTop+=i:a>this[t].clientHeight&&(this[t].scrollTop+=a-this[t].clientHeight),s<0?this[t].scrollLeft+=s:c>this[t].clientWidth&&(this[t].scrollLeft+=c-this[t].clientWidth)},resetSelection(e){e&&(this[e].variables._activeRows&&(this[e].variables._activeRows=[]),this[e].variables._activeCols&&(this[e].variables._activeCols=[]),this[e].variables._activeCells&&(this[e].variables._activeCells=[]),this[e].variables._targetCell&&(this[e].variables._targetCell=[]),this.unselectCells(e))},unselectCells(e){const o=this[e].querySelectorAll("."+e+"_selected-cell");for(const l of o){if(l.classList.remove(e+"_selected-cell"),"link"===l.cDataType||"select"===l.cDataType){l.querySelectorAll("*").forEach((t=>{t.classList.remove(e+"_selected-cell")}))}t.dataType&&Object.keys(t.dataType).forEach((o=>{if(l.cDataType===o&&t.dataType[o].onUnselected){if("function"!=typeof t.dataType[o].onUnselected)throw new Error("onSelected must be a function.");t.dataType[o].onUnselected(l,this[e].__getData(l))}}))}const l=this[e].querySelectorAll("."+e+"_selected-col");for(const t of l)t.classList.remove(e+"_selected-col");const r=this[e].querySelectorAll("."+e+"_selected-row");for(const t of r)t.classList.remove(e+"_selected-row")},selectCells(e,o,l){const r=e.gId;if(!1===this.doEventWithCheckChanged(r,"_onActiveCells",e.row,e.cId,o.row,o.cId))return!1;if(!1===this.doEventWithCheckChanged(r,"_onActiveRows",e.row,o.row))return!1;if(!1===this.doEventWithCheckChanged(r,"_onActiveCols",e.cId,o.cId))return!1;if("range"!==this[r].info.gSelectionPolicy&&e!==o)return!1;const n=e.row<o.row?e.row:o.row,i=e.row>o.row?e.row:o.row,a=e.col<o.col?e.col:o.col,s=e.col>o.col?e.col:o.col;let c;this[r].variables._activeCells=[],this[r].variables._activeRows=[],this[r].variables._activeCols=[];for(let e=n;e<=i;e++){for(let o=a;o<=s;o++)if(e===n&&this[r].variables._activeCols.push(o),c=this[r]._getCell(e,o),!c.cUntarget&&this.isCellVisible(c)){if(this[r].variables._activeCells.push(c),c.classList.add(r+"_selected-cell"),"link"===c.cDataType||"select"===c.cDataType){c.querySelectorAll("*").forEach((e=>{e.classList.add(r+"_selected-cell")}))}t.dataType&&Object.keys(t.dataType).forEach((e=>{if(c.cDataType===e&&t.dataType[e].onSelected){if("function"!=typeof t.dataType[e].onSelected)throw new Error("onSelected must be a function.");t.dataType[e].onSelected(c,this[r].__getData(c))}}))}this[r].variables._activeRows.push(e)}return this.setActiveCol(r),this.setActiveRow(r),this.focusCell(l||o),!0},setActiveCol(e){const t=this[e];for(const o of this[e].variables._activeCols)for(let l=1;l<=t.getHeaderRowCount();l++)t._getHeaderCell(l,o).classList.add(e+"_selected-col")},setActiveRow(e){for(const t of this[e].variables._activeRows)for(const o of this[e]._getRow(t))o.classList.add(e+"_selected-row")},scrollInterval:null,startScrolling(e,t){this.scrollInterval||(this.scrollInterval=setInterval((()=>{if("range"!==this[e].info.gSelectionPolicy)return;const o=this[e];if(o.variables._activeCells.length<=0)return;const l=o.variables._activeCells[0],r=o.variables._activeCells[o.variables._activeCells.length-1];let n;switch(t){case"up":n=this.getMoveRowCell(l,-1),this.unselectCells(e),this.selectCells(n,r,n);break;case"down":n=this.getMoveRowCell(r,1),this.unselectCells(e),this.selectCells(l,n);break;case"left":n=this.getMoveColCell(l,-1),this.unselectCells(e),this.selectCells(n,r,n);break;case"right":n=this.getMoveColCell(r,1),this.unselectCells(e),this.selectCells(l,n)}}),100))},stopScrolling(){this.scrollInterval&&clearInterval(this.scrollInterval),this.scrollInterval=null},copyGrid(e){const t=this.getCopyText(e);!1!==l.doEventWithCheckChanged(e[0].gId,"_onCopy",e[0].row,e[0].cId,e[e.length-1].row,e[e.length-1].cId,t)&&navigator.clipboard.writeText(t).then((()=>{}),(e=>{}))},getCopyText(e){let o="",l=null;return e.forEach((e=>{let r=e.row,n=String(this.getCellText(e));Object.keys(t.dataType).forEach((o=>{if(e.cDataType===o&&t.dataType[o].getCopyValue){if("function"!=typeof t.dataType[o].getCopyValue)throw new Error("getCopyValue must be a function.");n=t.dataType[o].getCopyValue(e.cValue)}})),n.includes("\n")&&(n='"'+n+'"'),null!==l&&l!==r?o+="\n":l===r&&(o+="\t"),o+=n,l=r})),o},modifyCellValue(e,t,o,r=!1){const n=this[e.gId];if(!r){if(!this.isCellVisible(e))return;if(e.cUntarget||e.cLocked)return}if(t=this.getValidValue(e,t),e.cValue===t)return;const i=e.cValue,a=t;o&&Array.isArray(o)&&o.push({cell:e,oldValue:i,newValue:a}),n.getRowStatus(e.row)||n.setRowStatus(e.row,"U"),e.cValue=t,l.reConnectedCallbackElement(e),this.reloadGridWithModifyCell(e.gId,e.cIndex)},getRecodesWithModifyValue(e,t,o=!1){const l=[];return this.modifyCellValue(e,t,l,o),l},pasteGrid(e,o){const r=this,n=o.gId,i=e.clipboardData||window.clipboardData,a=r[n].variables._activeCells[0],s=i.getData("text");if(!1===l.doEventWithCheckChanged(a.gId,"_onPaste",a.row,a.cId,s))return e.stopPropagation(),void e.preventDefault();const c=[],d=[];let u="",C=!1;for(let e=0;e<s.length;e++){let t=s[e],o=s[e+1];'"'===t&&(C=!C),C||"\n"!==t&&("\r"!==t||"\n"!==o)?u+=t:(c.push(u),u="","\r"===t&&"\n"===o&&e++)}u&&c.push(u);const f=a.row,g=a.col,h=o.getRowCount(),_=o.getColCount();let b=0,w=0;for(let e=0;e<c.length;e++){const e=f+w+b;if(e>h)return;const l=o._getRow(e);if(!l[0].cRowVisible||l[0].cFilter){b++;let e=1,t=r[n]._getCell(l[0].row+e,1);for(;t&&(!t.cRowVisible||t.cFilter);)b++,e++,t=r[n]._getCell(l[0].row+e,1);continue}let i=0,a=0;const s=c[w].split("\t");for(let e=0;e<s.length;e++){const e=g+a-1+i;if(e>=_)break;const n=l[e];if(!n.cColVisible){i++;let t=1,o=l[e+t];for(;o&&!o.cColVisible;)i++,t++,o=l[e+t];continue}let c=s[a];if(["select","checkbox","button","link"].indexOf(n.cDataType)<0&&!n.cUntarget&&!n.cLocked){c=c.replaceAll('"',"");let e=!0;Object.keys(t.dataType).forEach((l=>{if(n.cDataType===l)if(t.dataType[l].getPasteValue){if("function"!=typeof t.dataType[l].getPasteValue)throw new Error("getPasteValue must be a function.");c=t.dataType[l].getPasteValue(o.__getData(n),c)}else e=!1})),e&&d.push(...r.getRecodesWithModifyValue(n,c))}a++}w++}d.length>0&&r.recodeGridModify(n,d)},modifyCell(){if(!this.activeGridEditor)return;let e=this.activeGridEditor.parentNode;if(e.cUntarget||e.cLocked)return;if(this.editNewValue=this.activeGridEditor.value,Object.keys(t.dataType).forEach((o=>{if(e.cDataType===o)if(t.dataType[o].getEditedValue){if("function"!=typeof t.dataType[o].getEditedValue)throw new Error("getEditedValue must be a function.");this.editNewValue=t.dataType[o].getEditedValue(this.activeGridEditor,this[e.gId].__getData(e))}else this.editNewValue=this.editOldValue})),this.removeGridEditor(),!1===this.doEventWithCheckChanged(e.gId,"_onBeforeChange",e.row,e.cId,this.editOldValue,this.editNewValue))return!1;const o=this.editNewValue,l=this.getRecodesWithModifyValue(e,o);this.recodeGridModify(e.gId,l),this.doEventWithCheckChanged(e.gId,"_onAfterChange",e.row,e.cId,this.editOldValue,this.editNewValue)},getTabCell(e,t){if(!e)return null;let o,l=e.row,r=t?e.col-1:e.col+1;for(;!o&&l>=1&&l<=this.activeGrid.getRowCount();){for(;!o&&r>=1&&r<=this.activeGrid.getColCount();)o=this.activeGrid._getCell(l,r),o&&(o.rowMerge||o.colMerge||o.cUntarget?o=null:this.isCellVisible(o)||(o=null)),r=t?r-1:r+1;l=t?l-1:l+1,r=t?this.activeGrid.getColCount():1}return o||(o=e),o},getMoveRowCell(e,t){if(!e)return null;let o,l=e.row,r=e.col;if(!t)return e;for(;!(o||(l+=t,l<1||l>this[e.gId].getRowCount()));)o=this.activeGrid._getCell(l,r),o&&(o.rowMerge||o.colMerge||o.cUntarget?o=null:this.isCellVisible(o)||(o=null));return o||(o=e),o},getMoveColCell(e,t){if(!e)return null;let o,l=e.row,r=e.col;if(!t)return e;for(;!(o||(r+=t,r<1||r>this[e.gId].getColCount()));)o=this.activeGrid._getCell(l,r),o&&(o.rowMerge||o.colMerge||o.cUntarget?o=null:this.isCellVisible(o)||(o=null));return o||(o=e),o},sort(e,o,l,r=!0,n=!1){const i=this.deepCopy(o),a=this[e];return i.sort(((e,o)=>{const i=e.find((e=>e.id===l)),s=o.find((e=>e.id===l));let c=i?i.value:null;const d=i?i.dataType:null;let u=s?s.value:null;const C=s?s.dataType:null;let f=n;if("number"!=typeof c&&"number"!=typeof u||(f=!0),c===a.info.gNullValue&&(c=null),u===a.info.gNullValue&&(u=null),"select"===d&&null!==c&&Array.isArray(c)){let e=c.find((e=>e.selected));c=e?e.text:c.length>0&&void 0!==c[0].text?c[0].text:null}else"link"===d&&null!==c&&c.constructor===Object&&(c=c.text);if("select"===C&&null!==u&&Array.isArray(u)){let e=u.find((e=>e.selected));u=e?e.text:u.length>0&&void 0!==u[0].text?u[0].text:null}else"link"===C&&null!==u&&u.constructor===Object&&(u=u.text);if(t.dataType&&Object.keys(t.dataType).forEach((e=>{if(d===e)if(t.dataType[e].getSortValue){if("function"!=typeof t.dataType[e].getSortValue)throw new Error("getSortValue must be a function.");c=t.dataType[e].getSortValue(c)}else c=i.text;if(C===e)if(t.dataType[e].getSortValue){if("function"!=typeof t.dataType[e].getSortValue)throw new Error("getSortValue must be a function.");u=t.dataType[e].getSortValue(u)}else u=s.text})),f){const e=null===c?NaN:Number(c),t=null===u?NaN:Number(u);if(!isNaN(e)&&!isNaN(t))return!1!==r?e-t:t-e;isNaN(e)&&(c=null),isNaN(t)&&(u=null)}return null===c&&null===u?0:null===c?!1!==r?1:-1:null===u?!1!==r?-1:1:c.localeCompare||u.localeCompare?c.localeCompare?u.localeCompare?f?!1!==r?c.localeCompare(u,void 0,{numeric:!0}):u.localeCompare(c,void 0,{numeric:!0}):!1!==r?c.localeCompare(u):u.localeCompare(c):!1!==r?-1:1:!1!==r?1:-1:0})),a.variables._sortToggle[l]=r,i},setFilterOptions(e,t){const o=e.value;this.removeAllChild(e),t.forEach((t=>{option=document.createElement("option"),option.value=t.value,option.textContent=t.text,e.appendChild(option)})),o&&(e.value=o)},reloadFilterValue(e,o){const l=this[e];if(!l||!l.info.gFilterable)return;const r=l.__getColInfo(o);if(r.cFilterable){r.cFilterValues=new Set;for(let e=1;e<=l.getRowCount();e++){let o,n=l._getCell(e,r.cIndex);n&&n.cRowVisible&&n.cColVisible&&(o=this.getCellText(n),Object.keys(t.dataType).forEach((e=>{if(n.cDataType===e&&t.dataType[e].getFilterValue){if("function"!=typeof t.dataType[e].getFilterValue)throw new Error("getFilterValue must be a function.");o=t.dataType[e].getFilterValue(n.cValue)}})),""!==o&&null!=o&&o!==l.info.gNullValue||(o="$$NULL"),r.cFilterValues.add(o))}this.reloadFilter(e,o)}},reloadFilter(e,t){const o=this[e],l=o.__getHeaderFilter(t);if(!l)return;const r=o.__getColInfo(t),n=r.cFilterValues,i=r.cDataType;if(!n)return;let a=[],s={value:"$$ALL",text:"*"};a.push(s),n.forEach((e=>{s={},s.value=e,s.text=e,"$$NULL"===e&&(s.text=o.info.gNullValue),"checkbox"===i&&(s.text=e===o.info.gCheckedValue?"☑":"☐"),a.push(s)}));const c=l.value;this.removeAllChild(l),a.forEach((e=>{s=document.createElement("option"),s.value=e.value,s.textContent=e.text,l.appendChild(s)})),c&&(l.value=c,r.cFilterValue=c)},reloadColForMerge(e,t){const o=this[e],l=o.__getColInfo(t);let r,n,i,a;if(l.cRowMerge){for(a=l.cIndex,i=1;i<=o.getRowCount();i++)n=o._getCell(i,a),delete n.rowSpan,delete n.rowMerge,delete n.colSpan,delete n.colMerge;for(i=2;i<=o.getRowCount();i++)if(r=o._getCell(i-1,a),n=o._getCell(i,a),r&&this.isCellVisible(r)&&r.cDataType===n.cDataType&&this.getCellText(r)===this.getCellText(n)){for(let e=r.row-1;e>0;e--)if(r=o._getCell(e,a),!0!==r.rowMerge){r.rowSpan=this.nvl(r.rowSpan,1)+1;break}n.rowMerge=!0}for(i=1;i<=o.getRowCount();i++)n=o._getCell(i,a),this.reConnectedCallbackElement(n)}if(l.cColMerge&&!o.__getColInfo(t-1).cRowMerge){const e=o._getCells();for(i=1;i<=o.getRowCount();i++)for(a=l.cIndex-1;a<=l.cIndex;a++)n=o._getCell(i,a),delete n.rowSpan,delete n.rowMerge,delete n.colSpan,delete n.colMerge;for(a=l.cIndex,i=1;i<=o.getRowCount();i++)if(r=e[i-1][a-2],n=e[i-1][a-1],r&&this.isCellVisible(r)&&r.cDataType===n.cDataType&&this.getCellText(r)===this.getCellText(n)){for(let t=r.col-1;t>2;t--)if(r=e[i-1][t],!0!==r.colMerge){r.colSpan=this.nvl(r.colSpan,1)+1;break}n.colMerge=!0}for(i=1;i<=o.getRowCount();i++)for(a=l.cIndex-1;a<=l.cIndex;a++)n=o._getCell(i,a),this.reConnectedCallbackElement(n)}},reloadGridWithModifyCell(e,t){this.reloadFooterValue(e),this.reloadFilterValue(e,t);const o=this[e].__getColInfo(t+1);o&&o.cColMerge?this.reloadColForMerge(e,t+1):this.reloadColForMerge(e,t)},reloadGridForMerge(e){for(let t=3;t<=this[e].getColCount();t++)this.reloadColForMerge(e,t)},reloadFooterValue(e){const t=this[e]._getFooterCells();for(const e of t)for(const t of e)null!==t.cFooter&&void 0!==t.cFooter&&this.reConnectedCallbackElement(t)},setGridDataRowCol(e,t,o){e.row=t,e.col=o,e.cIndex=o,this.setGridDataPosition(e)},setGridDataPosition(e){const t=e.row,o=e.col;e.style.gridRowStart=t,e.style.gridRowEnd=t+1,e.style.gridColumnStart=o,e.style.gridColumnEnd=o+1},getGridCell(e,t,o,r,n){let i,a,s;if(o&&o.constructor===Object)i={},i.value=o[t.cId];else if(o&&Array.isArray(o))for(s of o)if(s.id===t.cId){i=s;break}i||(i={},i.value=null);const c=document.createElement("v-g-d");switch(c.gId=e,c.gType="gbd",Object.keys(t).forEach((e=>{["cHeader","cFooter","cRowMerge","cColMerge","cFilterValue","cIndex"].indexOf(e)<0&&(a=e.charAt(1).toLowerCase()+e.slice(2),c[e]=a in i?i[a]:t[e])})),c.cId){case"v-g-rownum":c.cValue=r;break;case"v-g-status":c.cValue=l.getCodeValue(["C","U","D"],null,i.value);break;default:c.cValue=l.getValidValue(c,i.value)}return t.cFilterable&&c.cColVisible&&t.cFilterValues.add(c.textContent),this.setGridDataRowCol(c,r,n),c},isCellVisible(e){if(e)return!(!1===e.cColVisible||!1===e.cRowVisible||!0===e.cFilter)},getFirstCellValidNumber(e,t){let o,l;for(let r=1;r<e.getRowCount();r++)if(l=e._getCell(r,t.col),this.isCellVisible(l)&&(o=this.getOnlyNumberWithNaNToNull(l.cValue),o))return o;return null},recodeGridModify(e,t){if(t.length<=0)return;const o=this[e];o.variables._recodeseq<o.variables._recodes.length&&o.variables._recodes.splice(o.variables._recodeseq),o.variables._recodes.push(t),o.variables._recodeseq=o.variables._recodeseq+1,o.variables._recodeseq>o.info.gRedoCount&&(o.variables._recodes.shift(),o.variables._recodeseq=o.variables._recodeseq-1)},redoundo(e,t){const o=this[e];if(!o.info.gRedoable)return!1;const l=!1!==t;if(l&&o.variables._recodeseq<=0)return!1;if(!l&&o.variables._recodeseq+1>o.variables._recodes.length)return!1;if(o.variables._recodeseq=l?o.variables._recodeseq-1:o.variables._recodeseq+1,redoCellInfos=l?o.variables._recodes[o.variables._recodeseq]:o.variables._recodes[o.variables._recodeseq-1],!redoCellInfos||!Array.isArray(redoCellInfos))return!1;this.selectCell(redoCellInfos[0].cell);for(const e of redoCellInfos)e.cell.cValue=l?e.oldValue:e.newValue,this.reConnectedCallbackElement(e.cell),this.reloadGridWithModifyCell(e.cell.gId,e.cell.cIndex);return!0},removeGridEditor(){if(!this.activeGridEditor)return!1;const e=this.activeGridEditor.targetCell;return this.doEventWithCheckChanged(e.gId,"_onEditEnding",e.row,e.cId,this.editOldValue,this.editNewValue),e.style.padding="",e.style.fontSize="",this.activeGridEditor.parentNode.removeChild(this.activeGridEditor),this.activeGridEditor=null,!0},addBagicEventListenerToGridEditor(e){e.addEventListener("keydown",(function(e){const t=l.activeGrid,o=t.gId,r=t.variables._targetCell;if(!1===l.doEventWithCheckChanged(o,"_onKeydownEditor",e))return e.stopPropagation(),void e.preventDefault();let n;switch(e.key){case"Enter":e.shiftKey||(l.modifyCell(),n=l.getMoveRowCell(r,1),l.selectCell(n),e.stopPropagation(),e.preventDefault());break;case"Escape":l.editNewValue=l.editOldValue,l.removeGridEditor(),e.stopPropagation(),e.preventDefault();break;case"Tab":l.modifyCell(),n=l.getTabCell(r,e.shiftKey),l.selectCell(n),e.stopPropagation(),e.preventDefault();break;case"F2":l.modifyCell(),e.stopPropagation(),e.preventDefault()}})),e.addEventListener("input",(function(e){const t=l.activeGrid.gId;l.doEventWithCheckChanged(t,"_onInputEditor",e)}))},setBagicAttributesToGridEditor(e,t){e.eId=t.gId+"_Editor",e.gId=t.gId,e.targetCell=t,e.style.width=t.offsetWidth+"px",e.style.height=t.scrollHeight+e.offsetHeight-e.clientHeight+"px",e.classList.add(e.gId+"_editor")},createGridEditorTextarea(e){const t=document.createElement("textarea");this.setBagicAttributesToGridEditor(t,e),t.placeholder,t.classList.add(t.gId+"_editor_textarea");const o=this[e.gId].info.gNullValue===e.cValue?null:e.cValue;return this.editOldValue=o,t.value=this.editOldValue,t.addEventListener("input",(function(e){e.target.style.height=e.target.scrollHeight+t.offsetHeight-t.clientHeight+"px"}),!1),t.addEventListener("keyup",(function(e){e.target.value&&e.target.parentNode&&e.target.parentNode.cMaxLength&&(e.target.value=e.target.value.substring(0,e.target.parentNode.cMaxLength)),e.target.value&&e.target.parentNode&&e.target.parentNode.cMaxByte&&(e.target.value=l.getCutByteLength(e.target.value,e.target.parentNode.cMaxByte))}),!1),this.addBagicEventListenerToGridEditor(t),t},createGridEditorNumber(e){const t=document.createElement("input");this.setBagicAttributesToGridEditor(t,e),t.classList.add(t.gId+"_editor_number"),t.setAttribute("type","number");const o=this[e.gId].info.gNullValue===e.cValue?null:e.cValue;return this.editOldValue=o,t.value=this.editOldValue,this.addBagicEventListenerToGridEditor(t),t},createGridEditorDate(e){const t=document.createElement("input");return this.setBagicAttributesToGridEditor(t,e),t.classList.add(t.gId+"_editor_date"),t.setAttribute("type","date"),this.editOldValue=this.getDateWithInputDateFormat(e.cValue),t.value=this.editOldValue,this.addBagicEventListenerToGridEditor(t),t},createGridEditorMonth(e){const t=document.createElement("input");return this.setBagicAttributesToGridEditor(t,e),t.classList.add(t.gId+"_editor_month"),t.setAttribute("type","month"),this.editOldValue=this.getDateWithInputMonthFormat(e.cValue),t.value=this.editOldValue,this.addBagicEventListenerToGridEditor(t),t},createGridEditorMask(e){const t=document.createElement("input");this.setBagicAttributesToGridEditor(t,e),t.classList.add(t.gId+"_editor_mask"),t.setAttribute("type","text");const o=this[e.gId].info.gNullValue===e.cValue?null:e.cValue;return this.editOldValue=o,t.value=this.editOldValue,t.addEventListener("keyup",(function(e){e.target.value=l.getMaskValue(e.target.targetCell.cFormat,e.target.value)})),this.addBagicEventListenerToGridEditor(t),t},createGridEditorCode(e){const t=document.createElement("input");this.setBagicAttributesToGridEditor(t,e),t.classList.add(t.gId+"_editor_code"),t.setAttribute("type","text");const o=e.cValue;return this.editOldValue=o,t.value=this.editOldValue,this.addBagicEventListenerToGridEditor(t),t},createGridEditor(e,o=!1){if(e.cLocked||e.cUntarget)return;if(["select","checkbox","button","link"].indexOf(e.cDataType)>=0)return;let r;switch(this.removeGridEditor(),e.cDataType){case"text":r=this.createGridEditorTextarea(e);break;case"number":r=this.createGridEditorNumber(e);break;case"date":r=this.createGridEditorDate(e);break;case"month":r=this.createGridEditorMonth(e);break;case"mask":r=this.createGridEditorMask(e);break;case"code":r=this.createGridEditorCode(e);break;default:Object.keys(t.dataType).forEach((o=>{if(e.cDataType===o&&t.dataType[o].getEditor){if("function"!=typeof t.dataType[o].getEditor)throw new Error("getEditor must be a function.");const n=()=>{l.editNewValue=l.editOldValue,l.removeGridEditor()},i=()=>{this.modifyCell()};if(r=t.dataType[o].getEditor(e,this[e.gId].__getData(e),(()=>{i()}),(()=>{n()})),r){if(!(r instanceof HTMLElement)||1!==r.nodeType)throw new Error("getEditor must return an html element.");r.eId=e.gId+"_Editor",r.gId=e.gId,r.targetCell=e,r.classList.add(r.gId+"_editor_"+o),r.classList.add(r.gId+"_editor"),this.editOldValue=e.cValue}}}))}!1!==this.doEventWithCheckChanged(e.gId,"_onEditEnter",e.row,e.cId,r)&&r&&(e.style.padding="0",e.style.fontSize="0px",e.appendChild(r),r.focus(),o&&r.select(),this.activeGridEditor=r,this.doEventWithCheckChanged(e.gId,"_onEditEnter",e.row,e.cId,r))},getValidValue(e,o){const l=this.nvl(this[e.gId].info.gNullValue,null);if(!e)return null;if("code"!==e.cDataType){if(null==o||""===o)return l;if(o===l)return l}switch(e.cDataType){case"text":return e.cMaxLength&&(o=o.substring(0,e.cMaxLength)),e.cMaxByte&&(o=this.getCutByteLength(o,e.cMaxByte)),o;case"mask":return this.nvl(this.getMaskValue(e.cFormat,o),l);case"date":return this.nvl(this.getDateWithValueDateFormat(o),l);case"month":return this.nvl(this.getDateWithValueMonthFormat(o),l);case"number":if(null===(o=this.getOnlyNumberWithNaNToNull(o)))return l;const r=e.cMaxNumber,n=e.cMinNumber,i=e.cRoundNumber;null!=r&&"number"==typeof r&&o>r&&(o=r),null!=n&&"number"==typeof n&&o<n&&(o=n);let a=parseFloat(o);if(null==i||"number"!=typeof i)return Number(o);if(i>=0){let e=a.toFixed(i);return e=e.replace(/(\.[0-9]*?)0+$/,"$1"),e=e.replace(/\.$/,""),Number(e)}{const e=Math.pow(10,-i);return Number((Math.round(a/e)*e).toFixed(-i))}case"select":case"button":case"link":return o;case"checkbox":if("boolean"==typeof o)return o;return this[e.gId].info.gCheckedValue===o;case"code":return this.getCodeValue(e.cCodes,e.cDefaultCode,o);default:return t.dataType&&Object.keys(t.dataType).forEach((l=>{if(e.cDataType===l&&t.dataType[l].getValue){if("function"!=typeof t.dataType[l].getValue)throw new Error("getValue must be a function.");o=t.dataType[l].getValue(o)}})),o}},getCellText(e){if(!e)return null;let o=null;const r=this[e.gId];let n=this.nvl(e.cValue,r.info.gNullValue);switch(e.cDataType){case"number":o=n===r.info.gNullValue?n:l.nvl(this.getFormatNumberFromCell(e),r.info.gNullValue);break;case"date":o=n===r.info.gNullValue?n:l.nvl(this.getDateWithGridDateFormat(e),r.info.gNullValue);break;case"month":o=n===r.info.gNullValue?n:l.nvl(this.getDateWithGridMonthFormat(e),r.info.gNullValue);break;case"select":if(Array.isArray(e.cValue)&&e.cValue.length>0){o=e.cValue[0].text;for(const t of e.cValue)t.selected&&(o=t.text);null==o&&(o=r.info.gNullValue)}break;case"link":o=e.cValue&&e.cValue.text?e.cValue.text:n;break;default:o=n,t.dataType?Object.keys(t.dataType).forEach((l=>{if(e.cDataType===l&&t.dataType[l].getText){if("function"!=typeof t.dataType[l].getText)throw new Error("getText must be a function.");o=t.dataType[l].getText(o)}})):o=String(n)}return o},selectAndCheckboxOnChange(e){if(!e.nType)return;const t=e.parentNode;let o=!0;if("select"===e.nType?l.editNewValue=e.value:"checkbox"===e.nType&&(l.editNewValue=e.checked?l[e.parentNode.gId].info.gCheckedValue:l[e.parentNode.gId].info.gUncheckedValue),!1===this.doEventWithCheckChanged(t.gId,"_onBeforeChange",t.row,t.cId,l.editOldValue,l.editNewValue)&&(o=!1),!o||t.cUntarget||t.cLocked){switch(e.nType){case"select":e.value=l.editOldValue;break;case"checkbox":e.checked=!e.checked}return l.editOldValue=null,!1}switch(e.nType){case"select":l.recodeGridModify(t.gId,l.getRecodesWithModifyValue(t,l.getSelectOptions(e)));break;case"checkbox":l.recodeGridModify(t.gId,l.getRecodesWithModifyValue(t,l.editNewValue))}this.doEventWithCheckChanged(t.gId,"_onAfterChange",t.row,t.cId,l.editOldValue,l.editNewValue)},getFormatNumber(e,t){if(!e||null==t)return Number(t);const o=e.match(/^(.*?)([#0,.]+)(.*?)$/);if(!o)return Number(t);const l=e=>isNaN(e)||!isFinite(e)?0:Number(e),r=e=>isNaN(e)||!isFinite(e)?0:parseFloat(e),n=o[1],i=o[2],a=o[3],s=i.split(".")[0],c=i.split(".").length>1?i.split(".")[1]:"";"%"!==a&&" %"!==a||(t*=100);let d=String(t);const u="-"===d[0];d=u?d.substring(1):d;let C,f=d.split(".")[0],g=d.split(".").length>1?d.split(".")[1]:"";switch(g=r("0."+g).toLocaleString("en",{minimumFractionDigits:c.lastIndexOf("0")+1,maximumFractionDigits:c.length}),g="0"===g?"":g.substring(1),s){case"#,###":0===l(f)?C=g:(f=r(f).toLocaleString("en"),C=f+g);break;case"#,##0":f=r(f).toLocaleString("en"),C=f+g;break;case"#":C=0===l(f)?g:f+g;break;case"0":C=f+g;break;default:return t}return C=u?"-"+C:C,n+C+a},getFormatNumberFromCell(e){return e.cFormat?null===e.cValue||void 0===e.cValue?null:this.getFormatNumber(e.cFormat,e.cValue):e.cValue},getDateWithValueDateFormat(e){if(!e||"string"!=typeof e)return null;const t=/^(\d{4})[-/.]? ?(\d{2})[-/.]? ?(\d{2})$/.exec(e.replace(/\s+/g,""));if(!t)return null;const o=t[1],l=t[2],r=t[3];return this.isValidDate(o,l,r)?`${o}${l}${r}`:null},getDateWithValueMonthFormat(e){if(!e||"string"!=typeof e)return null;e=e.replace(/\s+/g,"");const t=/^(\d{4})[-/.]? ?(\d{2})[-/.]? ?(\d{2})?$/.exec(e),o=/^(\d{4})[-/.]? ?(\d{2})$/.exec(e);let l,r;if(t)l=t[1],r=t[2];else{if(!o)return null;l=o[1],r=o[2]}return this.isValidDate(l,r,"01")?`${l}${r}`:null},getDateWithInputDateFormat(e){if(!e||"string"!=typeof e)return null;const t=/^(\d{4})[-/.]?(\d{2})[-/.]?(\d{2})$/.exec(e);if(!t)return null;const o=t[1],l=t[2],r=t[3];return this.isValidDate(o,l,r)?`${o}-${l}-${r}`:null},getDateWithInputMonthFormat(e){if(!e||"string"!=typeof e)return null;const t=/^(\d{4})[-/.]?(\d{2})$/.exec(e);if(!t)return null;const o=t[1],l=t[2];return this.isValidDate(o,l,"01")?`${o}-${l}`:null},getDateWithGridDateFormat(e){const t=/^(\d{4})[-/.]?(\d{2})[-/.]?(\d{2})$/.exec(e.cValue);if(!t)return null;const o=t[1],l=t[2],r=t[3];if(!this.isValidDate(o,l,r))return null;switch(this[e.gId].info.gDateFormat){case"yyyy-mm-dd":default:return`${o}-${l}-${r}`;case"yyyy/mm/dd":return`${o}/${l}/${r}`;case"yyyy. mm. dd":return`${o}. ${l}. ${r}`;case"yyyymmdd":return`${o}${l}${r}`;case"mm-dd-yyyy":return`${l}-${r}-${o}`;case"mm/dd/yyyy":return`${l}/${r}/${o}`;case"mm. dd. yyyy":return`${l}. ${r}. ${o}`;case"mmddyyyy":return`${l}${r}${o}`;case"dd-mm-yyyy":return`${r}-${l}-${o}`;case"dd/mm/yyyy":return`${r}/${l}/${o}`;case"dd. mm. yyyy":return`${r}. ${l}. ${o}`;case"ddmmyyyy":return`${r}${l}${o}`}},getDateWithGridMonthFormat(e){const t=/^(\d{4})[-/.]?(\d{2})$/.exec(e.cValue);if(!t)return null;const o=t[1],l=t[2];if(!this.isValidDate(o,l,"01"))return null;switch(this[e.gId].info.gMonthFormat){case"yyyy-mm":default:return`${o}-${l}`;case"yyyy/mm":return`${o}/${l}`;case"yyyy. mm":return`${o}. ${l}`;case"yyyymm":return`${o}${l}`;case"mm-yyyy":return`${l}-${o}`;case"mm/yyyy":return`${l}/${o}`;case"mm. yyyy":return`${l}. ${o}`;case"mmyyyy":return`${l}${o}`}},getCodeValue:(e,t,o)=>e&&Array.isArray(e)&&e.indexOf(o)>=0?o:t,getMaskValue(e,t){if("string"!=typeof e)return null;if("string"!=typeof t)return null;const o=e.split(""),r=t.split("");let n,i="";return o.every(((e,t)=>{switch(n=!1,e){case"A":/^[A-Z]$/.test(r[t])?(i+=r[t],n=!0):/^[a-z]$/.test(r[t])&&(i+=l.toUpperCase(r[t]),n=!0);break;case"a":/^[a-z]$/.test(r[t])?(i+=r[t],n=!0):/^[A-Z]$/.test(r[t])&&(i+=l.toLowerCase(r[t]),n=!0);break;case"9":/^[0-9]$/.test(r[t])&&(i+=r[t],n=!0);break;default:e===r[t]&&(i+=r[t],n=!0)}return n})),i},setSelectOptions(e,t){Array.isArray(t)&&(this.removeAllChild(e),t.forEach((t=>{option=document.createElement("option"),option.value=t.value,option.textContent=t.text,t.selected&&option.setAttribute("selected",""),t.disabled&&option.setAttribute("disabled",""),t.label&&option.setAttribute("label",t.label),e.appendChild(option)})))},getSelectOptions(e){if(!e)return null;const t=e.options;if(!t)return null;const o=[];for(const e of t){let t={};t.value=e.value,t.text=e.textContent,e.selected&&(t.selected=!0),e.disabled&&(t.disabled=!0),e.label&&(t.label=e.label),o.push(t)}return 0===o.length?null:o},doEventWithCheckChanged(e,t,...o){if(this[e].events[e+t]!==window[e+t])throw new Error("Abnormal access has been detected. An initially defined event has changed. \nevent : "+e+t);return window[e+t](...o)}},r=Object.freeze({PIXEL:"px",PERCENT:"%"}),n={TEXT:"text",NUMBER:"number",DATE:"date",MONTH:"month",MASK:"mask",SELECT:"select",CHECKBOX:"checkbox",BUTTON:"button",LINK:"link",CODE:"code"};t.dataType&&Object.keys(t.dataType).forEach((e=>{n[l.toUpperCase(e)]=e})),Object.freeze(n);const i=Object.freeze({LEFT:"left",CENTER:"center",RIGHT:"right"}),a=Object.freeze({TOP:"top",CENTER:"center",BOTTOM:"bottom"}),s=Object.freeze({MAX:"$$MAX",MIN:"$$MIN",SUM:"$$SUM",AVG:"$$AVG"}),c=Object.freeze({CREATE:"C",UPDATE:"U",DELETE:"D"}),d=Object.freeze({SINGLE:"single",RANGE:"range",NONE:"none"});let u=1;for(const s of o){const o=[],C=[],f=[];let g,h;const _=[];let b=0;const w=l.getAttributeWithCheckRequired("id",s);s.classList.add(w+"_vanillagrid");const I=document.createElement("v-g");if(I.info={},I.gId=w,I.info.gIndex=u,u++,I.info.gType="g",I.info.gName=l.nvl(s.getAttribute("name"),w),I.info.gLocked=l.nvl(l.getAttributeOnlyBoolean("locked",s),t.defaultGridInfo.locked),I.info.gLockedColor=l.nvl(l.getAttributeOnlyBoolean("locked-color",s),t.defaultGridInfo.lockedColor),I.info.gResizable=l.nvl(l.getAttributeOnlyBoolean("resizable",s),t.defaultGridInfo.resizable),I.info.gRedoable=l.nvl(l.getAttributeOnlyBoolean("redoable",s),t.defaultGridInfo.redoable),I.info.gRedoCount=l.nvl(l.getAttributeOnlyNumberIntegerOrZero("redo-count",s),t.defaultGridInfo.redoCount),I.info.gVisible=l.nvl(l.getAttributeOnlyBoolean("visible",s),t.defaultGridInfo.visible),I.info.gHeaderVisible=l.nvl(l.getAttributeOnlyBoolean("header-visible",s),t.defaultGridInfo.headerVisible),I.info.gRownumVisible=l.nvl(l.getAttributeOnlyBoolean("rownum-visible",s),t.defaultGridInfo.rownumVisible),I.info.gRownumSize=l.nvl(s.getAttribute("rownum-size"),t.defaultGridInfo.rownumSize),I.info.gRownumLockedColor=l.nvl(l.getAttributeOnlyBoolean("rownum-locked-color",s),I.info.gLocked),I.info.gStatusVisible=l.nvl(l.getAttributeOnlyBoolean("status-visible",s),t.defaultGridInfo.statusVisible),I.info.gStatusLockedColor=l.nvl(l.getAttributeOnlyBoolean("status-locked-color",s),I.info.gLocked),I.info.gSelectionPolicy=l.nvl(l.isIncludeEnum(d,l.toLowerCase(s.getAttribute("selection-policy")))?l.toLowerCase(s.getAttribute("selectionPolicy")):"",t.defaultGridInfo.selectionPolicy),I.info.gNullValue=l.nvl(s.getAttribute("null-value"),t.defaultGridInfo.nullValue),I.info.gDateFormat=l.nvl(s.getAttribute("date-format"),t.defaultGridInfo.dateFormat),I.info.gMonthFormat=l.nvl(s.getAttribute("month-format"),t.defaultGridInfo.monthFormat),I.info.gAlterRow=l.nvl(l.getAttributeOnlyBoolean("alter-row",s),t.defaultGridInfo.alterRow),I.info.gFrozenColCount=l.nvl(l.getAttributeOnlyNumberIntegerOrZero("frozen-col-count",s),t.defaultGridInfo.frozenColCount),I.info.gFrozenRowCount=l.nvl(l.getAttributeOnlyNumberIntegerOrZero("frozen-row-count",s),t.defaultGridInfo.frozenRowCount),I.info.gSortable=l.nvl(l.getAttributeOnlyBoolean("sortable",s),t.defaultGridInfo.sortable),I.info.gFilterable=l.nvl(l.getAttributeOnlyBoolean("filterable",s),t.defaultGridInfo.filterable),I.info.gAllCheckable=l.nvl(l.getAttributeOnlyBoolean("all-checkable",s),t.defaultGridInfo.allCheckable),I.info.gCheckedValue=l.nvl(s.getAttribute("checked-value"),t.defaultGridInfo.checkedValue),I.info.gUncheckedValue=l.nvl(s.getAttribute("unchecked-value"),t.defaultGridInfo.uncheckedValue),I.info.gCheckedValue===I.info.gUncheckedValue)throw new Error("Checked and unchecked values cannot be the same.");I.cssInfo={},I.cssInfo.width=l.nvl(s.getAttribute("width"),t.defaultGridCssInfo.width),I.cssInfo.height=l.nvl(s.getAttribute("height"),t.defaultGridCssInfo.height),I.cssInfo.margin=l.nvl(s.getAttribute("margin"),t.defaultGridCssInfo.margin),I.cssInfo.padding=l.nvl(s.getAttribute("padding"),t.defaultGridCssInfo.padding),I.cssInfo.sizeLevel=l.nvl(l.getAttributeOnlyNumberIntegerOrZero("size-level",s),t.defaultGridCssInfo.sizeLevel),I.cssInfo.verticalAlign=l.nvl(l.isIncludeEnum(a,l.toLowerCase(s.getAttribute("vertical-align")))?l.toLowerCase(s.getAttribute("vertical-align")):"",t.defaultGridCssInfo.verticalAlign),I.cssInfo.cellFontSize=l.nvl(s.getAttribute("cell-font-size"),(I.cssInfo.sizeLevel+15)/20*t.defaultGridCssInfo.cellFontSize+"px"),I.cssInfo.cellMinHeight=l.nvl(s.getAttribute("cell-min-height"),(I.cssInfo.sizeLevel+15)/20*t.defaultGridCssInfo.cellMinHeight+"px"),I.cssInfo.horizenBorderSize=l.nvl(l.getAttributeOnlyNumberIntegerOrZero("horizen-border-size",s),t.defaultGridCssInfo.horizenBorderSize),I.cssInfo.verticalBorderSize=l.nvl(l.getAttributeOnlyNumberIntegerOrZero("vertical-border-size",s),t.defaultGridCssInfo.verticalBorderSize),I.cssInfo.gridFontFamily=l.nvl(s.getAttribute("grid-font-family"),t.defaultGridCssInfo.gridFontFamily),I.cssInfo.editorFontFamily=l.nvl(s.getAttribute("editor-font-family"),t.defaultGridCssInfo.editorFontFamily),I.cssInfo.color=l.nvl(s.getAttribute("color"),t.defaultGridCssInfo.color),I.cssInfo.colorSet=l.nvl(s.getAttribute("color-set"),t.defaultGridCssInfo.colorSet),I.cssInfo.overflowWrap=l.nvl(s.getAttribute("overflow-wrap"),t.defaultGridCssInfo.overflowWrap),I.cssInfo.wordBreak=l.nvl(s.getAttribute("word-break"),t.defaultGridCssInfo.wordBreak),I.cssInfo.whiteSpace=l.nvl(s.getAttribute("white-space"),t.defaultGridCssInfo.whiteSpace),I.cssInfo.linkHasUnderLine=l.nvl(l.getAttributeOnlyBoolean("link-has-under-line",s),t.defaultGridCssInfo.linkHasUnderLine),I.cssInfo.invertColor=l.nvl(l.getAttributeOnlyBoolean("invert-color",s),t.defaultGridCssInfo.invertColor),I.cssInfo.colorSet?(I.cssInfo.color=l.getColorFromColorSet(I.cssInfo.colorSet),l.setColorSet(I.cssInfo)):l.setColorSet(I.cssInfo),I.cssInfo.gridBorderColor=l.nvl(s.getAttribute("grid-border-color"),l.nvl(t.defaultGridCssInfo.gridBorderColor,I.cssInfo.gridBorderColor)),I.cssInfo.headerCellBackColor=l.nvl(s.getAttribute("header-cell-back-color"),l.nvl(t.defaultGridCssInfo.headerCellBackColor,I.cssInfo.headerCellBackColor)),I.cssInfo.headerCellBorderColor=l.nvl(s.getAttribute("header-cell-border-color"),l.nvl(t.defaultGridCssInfo.headerCellBorderColor,I.cssInfo.headerCellBorderColor)),I.cssInfo.headerCellFontColor=l.nvl(s.getAttribute("header-cell-font-color"),l.nvl(t.defaultGridCssInfo.headerCellFontColor,I.cssInfo.headerCellFontColor)),I.cssInfo.footerCellBackColor=l.nvl(s.getAttribute("footer-cell-back-color"),l.nvl(t.defaultGridCssInfo.footerCellBackColor,I.cssInfo.footerCellBackColor)),I.cssInfo.footerCellBorderColor=l.nvl(s.getAttribute("footer-cell-border-color"),l.nvl(t.defaultGridCssInfo.footerCellBorderColor,I.cssInfo.footerCellBorderColor)),I.cssInfo.footerCellFontColor=l.nvl(s.getAttribute("footer-cell-font-color"),l.nvl(t.defaultGridCssInfo.footerCellFontColor,I.cssInfo.footerCellFontColor)),I.cssInfo.bodyBackColor=l.nvl(s.getAttribute("body-back-color"),l.nvl(t.defaultGridCssInfo.bodyBackColor,I.cssInfo.bodyBackColor)),I.cssInfo.bodyCellBackColor=l.nvl(s.getAttribute("body-cell-back-color"),l.nvl(t.defaultGridCssInfo.bodyCellBackColor,I.cssInfo.bodyCellBackColor)),I.cssInfo.bodyCellBorderColor=l.nvl(s.getAttribute("body-cell-border-color"),l.nvl(t.defaultGridCssInfo.bodyCellBorderColor,I.cssInfo.bodyCellBorderColor)),I.cssInfo.bodyCellFontColor=l.nvl(s.getAttribute("body-cell-font-color"),l.nvl(t.defaultGridCssInfo.bodyCellFontColor,I.cssInfo.bodyCellFontColor)),I.cssInfo.editorBackColor=l.nvl(s.getAttribute("editor-back-color"),l.nvl(t.defaultGridCssInfo.editorBackColor,I.cssInfo.editorBackColor)),I.cssInfo.editorFontColor=l.nvl(s.getAttribute("editor-font-color"),l.nvl(t.defaultGridCssInfo.editorFontColor,I.cssInfo.editorFontColor)),I.cssInfo.selectCellBackColor=l.nvl(s.getAttribute("select-cell-back-color"),l.nvl(t.defaultGridCssInfo.selectCellBackColor,I.cssInfo.selectCellBackColor)),I.cssInfo.selectCellFontColor=l.nvl(s.getAttribute("select-cell-font-color"),l.nvl(t.defaultGridCssInfo.selectCellFontColor,I.cssInfo.selectCellFontColor)),I.cssInfo.selectColBackColor=l.nvl(s.getAttribute("selectCol-back-color"),l.nvl(t.defaultGridCssInfo.selectColBackColor,I.cssInfo.selectColBackColor)),I.cssInfo.selectColFontColor=l.nvl(s.getAttribute("selectCol-font-color"),l.nvl(t.defaultGridCssInfo.selectColFontColor,I.cssInfo.selectColFontColor)),I.cssInfo.selectRowBackColor=l.nvl(s.getAttribute("selectRow-back-color"),l.nvl(t.defaultGridCssInfo.selectRowBackColor,I.cssInfo.selectRowBackColor)),I.cssInfo.selectRowFontColor=l.nvl(s.getAttribute("selectRow-font-color"),l.nvl(t.defaultGridCssInfo.selectRowFontColor,I.cssInfo.selectRowFontColor)),I.cssInfo.mouseoverCellBackColor=l.nvl(s.getAttribute("mouseover-cell-back-color"),l.nvl(t.defaultGridCssInfo.mouseoverCellBackColor,I.cssInfo.mouseoverCellBackColor)),I.cssInfo.mouseoverCellFontColor=l.nvl(s.getAttribute("mouseover-cell-font-color"),l.nvl(t.defaultGridCssInfo.mouseoverCellFontColor,I.cssInfo.mouseoverCellFontColor)),I.cssInfo.lockCellBackColor=l.nvl(s.getAttribute("lock-cell-back-color"),l.nvl(t.defaultGridCssInfo.lockCellBackColor,I.cssInfo.lockCellBackColor)),I.cssInfo.lockCellFontColor=l.nvl(s.getAttribute("lock-cell-font-color"),l.nvl(t.defaultGridCssInfo.lockCellFontColor,I.cssInfo.lockCellFontColor)),I.cssInfo.alterRowBackColor=l.nvl(s.getAttribute("alter-row-back-color"),l.nvl(t.defaultGridCssInfo.alterRowBackColor,I.cssInfo.alterRowBackColor)),I.cssInfo.alterRowFontColor=l.nvl(s.getAttribute("alter-row-font-color"),l.nvl(t.defaultGridCssInfo.alterRowFontColor,I.cssInfo.alterRowFontColor)),I.cssInfo.buttonFontColor=l.nvl(s.getAttribute("button-font-color"),l.nvl(t.defaultGridCssInfo.buttonFontColor,I.cssInfo.buttonFontColor)),I.cssInfo.buttonBorderColor=l.nvl(s.getAttribute("buttonBorderColor"),l.nvl(t.defaultGridCssInfo.buttonBorderColor,I.cssInfo.buttonBorderColor)),I.cssInfo.buttonBackColor=l.nvl(s.getAttribute("button-back-color"),l.nvl(t.defaultGridCssInfo.buttonBackColor,I.cssInfo.buttonBackColor)),I.cssInfo.buttonHoverFontColor=l.nvl(s.getAttribute("buttonHover-font-color"),l.nvl(t.defaultGridCssInfo.buttonHoverFontColor,I.cssInfo.buttonHoverFontColor)),I.cssInfo.buttonHoverBackColor=l.nvl(s.getAttribute("buttonHover-back-color"),l.nvl(t.defaultGridCssInfo.buttonHoverBackColor,I.cssInfo.buttonHoverBackColor)),I.cssInfo.buttonActiveFontColor=l.nvl(s.getAttribute("buttonActive-font-color"),l.nvl(t.defaultGridCssInfo.buttonActiveFontColor,I.cssInfo.buttonActiveFontColor)),I.cssInfo.buttonActiveBackColor=l.nvl(s.getAttribute("buttonActive-back-color"),l.nvl(t.defaultGridCssInfo.buttonActiveBackColor,I.cssInfo.buttonActiveBackColor)),I.cssInfo.linkFontColor=l.nvl(s.getAttribute("link-font-color"),l.nvl(t.defaultGridCssInfo.linkFontColor,I.cssInfo.linkFontColor)),I.cssInfo.linkHoverFontColor=l.nvl(s.getAttribute("linkHover-font-color"),l.nvl(t.defaultGridCssInfo.linkHoverFontColor,I.cssInfo.linkHoverFontColor)),I.cssInfo.linkActiveFontColor=l.nvl(s.getAttribute("linkActive-font-color"),l.nvl(t.defaultGridCssInfo.linkActiveFontColor,I.cssInfo.linkActiveFontColor)),I.cssInfo.linkVisitedFontColor=l.nvl(s.getAttribute("linkVisited-font-color"),l.nvl(t.defaultGridCssInfo.linkVisitedFontColor,I.cssInfo.linkVisitedFontColor)),I.cssInfo.linkFocusFontColor=l.nvl(s.getAttribute("linkFocus-font-color"),l.nvl(t.defaultGridCssInfo.linkFocusFontColor,I.cssInfo.linkFocusFontColor)),I.cssInfo.invertColor&&l.setInvertColor(I.cssInfo),I.classList.add(w+"_v-g");const v=document.createElement("v-g-h");v.gId=w,v.gType="gh",v.classList.add(w+"_v-g-h");const p=document.createElement("v-g-b");p.gId=w,p.gType="gb",p.classList.add(w+"_v-g-b");const y=document.createElement("v-g-f");y.gId=w,y.gType="gf",y.classList.add(w+"_v-g-f");let m,k=1,x=0;Array.from(s.querySelectorAll("v-col")).forEach((e=>{let o=e.getAttribute("header");o||(o=e.getAttribute("id")),k=k>o.split(";").length?k:o.split(";").length,e.getAttribute("footer")&&(x=x>e.getAttribute("footer").split(";").length?x:e.getAttribute("footer").split(";").length),m=e.getAttribute("width")?" "+e.getAttribute("width"):" "+t.defaultColInfo.originWidth;let n=l.extractNumberAndUnit(m).unit;if(n||(m+="px",n="px"),!l.isIncludeEnum(r,n))throw new Error("Width units can only be pixel or %.")}));let F=I.info.gRownumVisible?I.info.gRownumSize+" ":"0px ",E=I.info.gStatusVisible?"60px ":"0px ",V={cId:"v-g-rownum",cIndex:1,cName:"rownum"};V.cHeader=new Array(k),V.cHeader[0]="",V.cUntarget=!1,V.cRowMerge=!1,V.cColMerge=!1,V.cColVisible=I.info.gRownumVisible,V.cRowVisible=!0,V.cRequired=!1,V.cResizable=!1,V.cSortable=!1,V.cFilterable=!1,V.cOriginWidth=F,V.cDataType="text",V.cSelectSize=null,V.cLocked=!0,V.cLockedColor=I.info.gRownumLockedColor,V.cFormat=null,V.cCodes=null,V.cDefaultCode=null,V.cMaxLength=null,V.cMaxByte=null,V.cMaxNumber=null,V.cMinNumber=null,V.cRoundNumber=null,V.cFilterValues=null,V.cFilterValue=null,V.cFilter=!1,V.cAlign="center",V.cVerticalAlign=null,V.cOverflowWrap=null,V.cWordBreak=null,V.cWhiteSpace=null,V.cBackColor=null,V.cFontColor=null,V.cFontBold=!1,V.cFontItalic=!1,V.cFontThruline=!1,V.cFontUnderline=!1,_.push(V),V={},V.cId="v-g-status",V.cIndex=2,V.cName="status",V.cHeader=new Array(k),V.cHeader[0]="status",V.cUntarget=!0,V.cRowMerge=!1,V.cColMerge=!1,V.cColVisible=I.info.gStatusVisible,V.cRowVisible=!0,V.cRequired=!1,V.cResizable=!1,V.cSortable=!1,V.cFilterable=!1,V.cOriginWidth=E,V.cDataType="code",V.cSelectSize=null,V.cLocked=!0,V.cLockedColor=I.info.gStatusLockedColor,V.cFormat=null,V.cCodes=["C","U","D"],V.cDefaultCode=null,V.cMaxLength=null,V.cMaxByte=null,V.cMaxNumber=null,V.cMinNumber=null,V.cRoundNumber=null,V.cFilterValues=null,V.cFilterValue=null,V.cFilter=!1,V.cAlign="center",V.cVerticalAlign=null,V.cOverflowWrap=null,V.cWordBreak=null,V.cWhiteSpace=null,V.cBackColor=null,V.cFontColor=null,V.cFontBold=!1,V.cFontItalic=!1,V.cFontThruline=!1,V.cFontUnderline=!1,_.push(V),b=2,Array.from(s.querySelectorAll("v-col")).forEach((e=>{if(V={},b++,!e.getAttribute("id"))throw new Error("Column ID is required.");if(_.some((t=>t.cId===e.getAttribute("id"))))throw new Error("Column ID is primary key.");if(V.cId=e.getAttribute("id"),V.cIndex=b,V.cName=l.nvl(l.toLowerCase(e.getAttribute("name")),V.cId),e.getAttribute("header")){V.cHeader=e.getAttribute("header").split(";");for(let e=V.cHeader.length;e<k;e++)V.cHeader.push("")}else V.cHeader=new Array(k),V.cHeader[0]=V.cId;if(e.getAttribute("footer")){V.cFooter=e.getAttribute("footer").split(";");for(let e=V.cFooter.length;e<x;e++)V.cFooter.push("")}let o=l.toLowerCase(e.getAttribute("data-type"));if(o||(o=t.defaultColInfo.dataType),!l.isIncludeEnum(n,o))throw new Error("Please insert a valid dataType.");V.cDataType=o,V.cUntarget=l.nvl(l.getAttributeOnlyBoolean("untarget",e),"none"===I.info.gSelectionPolicy),V.cRowMerge=l.nvl(l.getAttributeOnlyBoolean("row-merge",e),t.defaultColInfo.rowMerge),V.cColMerge=l.nvl(l.getAttributeOnlyBoolean("col-merge",e),t.defaultColInfo.colMerge),V.cColVisible=l.nvl(l.getAttributeOnlyBoolean("visible",e),t.defaultColInfo.colVisible),V.cRowVisible=!0,V.cRequired=l.nvl(l.getAttributeOnlyBoolean("required",e),t.defaultColInfo.required),V.cResizable=l.nvl(l.getAttributeOnlyBoolean("resizable",e),t.defaultColInfo.resizable),V.cSortable=l.nvl(l.getAttributeOnlyBoolean("sortable",e),t.defaultColInfo.sortable),V.cFilterable=l.nvl(l.getAttributeOnlyBoolean("filterable",e),t.defaultColInfo.filterable),"checkbox"===V.cDataType&&(V.cSortable=!1),m=e.getAttribute("width")?e.getAttribute("width"):t.defaultColInfo.originWidth,l.extractNumberAndUnit(m).unit||(m+="px"),V.cOriginWidth=m,V.cSelectSize=l.nvl(l.isIncludeEnum(r,l.extractNumberAndUnit(e.getAttribute("select-size")).unit)?e.getAttribute("select-size"):"",t.defaultColInfo.selectSize),V.cLocked=l.nvl(l.getAttributeOnlyBoolean("locked",e),I.info.gLocked),V.cLockedColor=l.nvl(l.getAttributeOnlyBoolean("locked-color",e),I.info.gLockedColor),V.cFormat=l.nvl(e.getAttribute("format"),t.defaultColInfo.format),V.cCodes=e.getAttribute("codes")?e.getAttribute("codes").split(";"):t.defaultColInfo.codes,V.cDefaultCode=l.nvl(e.getAttribute("default-code"),t.defaultColInfo.defaultCode),V.cMaxLength=l.nvl(l.getAttributeOnlyNumberIntegerOrZero("max-length",e),t.defaultColInfo.maxLength),V.cMaxByte=l.nvl(l.getAttributeOnlyNumberIntegerOrZero("max-byte",e),t.defaultColInfo.maxByte),V.cMaxNumber=l.nvl(l.getAttributeOnlyNumber("max-number",e),t.defaultColInfo.maxNumber),V.cMinNumber=l.nvl(l.getAttributeOnlyNumber("min-number",e),t.defaultColInfo.minNumber),V.cRoundNumber=l.nvl(l.getAttributeOnlyNumberInteger("round-number",e),t.defaultColInfo.roundNumber),V.cFilterValues=new Set,V.cFilterValue=V.cFilterable?"$$ALL":void 0,V.cFilter=!1,V.cAlign=l.nvl(l.isIncludeEnum(i,l.toLowerCase(e.getAttribute("align")))?l.toLowerCase(e.getAttribute("align")):"",t.defaultColInfo.align),V.cVerticalAlign=l.nvl(l.isIncludeEnum(a,l.toLowerCase(e.getAttribute("vertical-align")))?l.toLowerCase(e.getAttribute("vertical-align")):"",t.defaultColInfo.verticalAlign),V.cOverflowWrap=l.nvl(e.getAttribute("overflow-wrap"),t.defaultColInfo.overflowWrap),V.cWordBreak=l.nvl(e.getAttribute("word-break"),t.defaultColInfo.wordBreak),V.cWhiteSpace=l.nvl(e.getAttribute("white-space"),t.defaultColInfo.whiteSpace),V.cBackColor=l.nvl(l.toLowerCase(e.getAttribute("back-color")),t.defaultColInfo.backColor),V.cFontColor=l.nvl(l.toLowerCase(e.getAttribute("font-color")),t.defaultColInfo.fontColor),V.cFontBold=l.nvl(l.getAttributeOnlyBoolean("font-bold",e),t.defaultColInfo.fontBold),V.cFontItalic=l.nvl(l.getAttributeOnlyBoolean("font-italic",e),t.defaultColInfo.fontItalic),V.cFontThruline=l.nvl(l.getAttributeOnlyBoolean("font-thruline",e),t.defaultColInfo.fontThruline),V.cFontUnderline=l.nvl(l.getAttributeOnlyBoolean("font-underline",e),t.defaultColInfo.fontUnderline),_.push(V),s.removeChild(e)})),I.__getDefaultColInfo=(e,o=!1)=>{if(!e||!e.id)throw new Error("Column ID is required.");if(o)for(const t of _)if(e.id===t.cId)throw new Error("Column ID is primary key.");return resultnewColInfo={},resultnewColInfo.cId=e.id,resultnewColInfo.cName=e.name?e.name:e.id,e.header&&"string"==typeof e.header?resultnewColInfo.cHeader=e.header.split(";"):(resultnewColInfo.cHeader=new Array(I.getHeaderRowCount()),resultnewColInfo.cHeader[0]=e.id),e.footer&&"string"==typeof e.footer&&(resultnewColInfo.cFooter=e.footer.split(";")),resultnewColInfo.cUntarget=e.untarget?e.untarget:"none"===I.info.gSelectionPolicy,resultnewColInfo.cRowMerge=e.rowMerge?e.rowMerge:t.defaultColInfo.rowMerge,resultnewColInfo.cColMerge=e.colMerge?e.colMerge:t.defaultColInfo.colMerge,resultnewColInfo.cColVisible=e.colVisible?e.colVisible:t.defaultColInfo.colVisible,resultnewColInfo.cRequired=e.required?e.required:t.defaultColInfo.required,resultnewColInfo.cResizable=e.resizable?e.resizable:t.defaultColInfo.resizable,resultnewColInfo.cSortable=e.sortable?e.sortable:t.defaultColInfo.sortable,resultnewColInfo.cFilterable=e.filterable?e.filterable:t.defaultColInfo.filterable,resultnewColInfo.cOriginWidth=e.originWidth?e.originWidth:t.defaultColInfo.originWidth,resultnewColInfo.cDataType=e.dataType?e.dataType:t.defaultColInfo.dataType,resultnewColInfo.cSelectSize=e.selectSize?e.selectSize:t.defaultColInfo.selectSize,resultnewColInfo.cLocked=e.locked?e.locked:I.info.gLocked,resultnewColInfo.cLockedColor=e.lockedColor?e.lockedColor:I.info.gLockedColor,resultnewColInfo.cFormat=e.format?e.format:t.defaultColInfo.format,resultnewColInfo.cCodes=e.codes?e.codes:t.defaultColInfo.codes,resultnewColInfo.cDefaultCode=e.defaultCode?e.defaultCode:t.defaultColInfo.defaultCode,resultnewColInfo.cMaxLength=e.maxLength?e.maxLength:t.defaultColInfo.maxLength,resultnewColInfo.cMaxByte=e.maxByte?e.maxByte:t.defaultColInfo.maxByte,resultnewColInfo.cMaxNumber=e.maxNumber?e.maxNumber:t.defaultColInfo.maxNumber,resultnewColInfo.cMinNumber=e.minNumber?e.minNumber:t.defaultColInfo.minNumber,resultnewColInfo.cRoundNumber=e.roundNumber?e.roundNumber:t.defaultColInfo.roundNumber,resultnewColInfo.cAlign=e.align?e.align:t.defaultColInfo.align,resultnewColInfo.cVerticalAlign=e.verticalAlign?e.verticalAlign:t.defaultColInfo.verticalAlign,resultnewColInfo.cOverflowWrap=e.overflowWrap?e.overflowWrap:t.defaultColInfo.overflowWrap,resultnewColInfo.cWordBreak=e.wordBreak?e.wordBreak:t.defaultColInfo.wordBreak,resultnewColInfo.cWhiteSpace=e.whiteSpace?e.whiteSpace:t.defaultColInfo.whiteSpace,resultnewColInfo.cBackColor=e.backColor?e.backColor:t.defaultColInfo.backColor,resultnewColInfo.cFontColor=e.fontColor?e.fontColor:t.defaultColInfo.fontColor,resultnewColInfo.cFontBold=e.fontBold?e.fontBold:t.defaultColInfo.fontBold,resultnewColInfo.cFontItalic=e.fontItalic?e.fontItalic:t.defaultColInfo.fontItalic,resultnewColInfo.cFontThruline=e.fontThruline?e.fontThruline:t.defaultColInfo.fontThruline,resultnewColInfo.cFontUnderline=e.fontUnderline?e.fontUnderline:t.defaultColInfo.fontUnderline,resultnewColInfo.cRowVisible=!0,resultnewColInfo.cFilterValues=new Set,resultnewColInfo.cFilterValue=resultnewColInfo.cFilterable?"$$ALL":void 0,resultnewColInfo.cFilter=!1,resultnewColInfo},I.__getColInfo=(e,t=!1)=>{let o;if("number"==typeof e)o=_[e-1];else for(const t of _)t.cId===e&&(o=t);if(!o){if(t)throw new Error("There is no "+("number"==typeof e?e+"th":e)+" colunm.");return null}return o},I.__getColIndex=(e,t=!1)=>{if("number"==typeof e)return t&&I.__checkColIndex(e),e;for(const t of _)if(t.cId===e)return t.cIndex;if(t)throw new Error("There is no "+("number"==typeof e?e+"th":e)+" colunm.");return null},I.__setGridColSize=()=>{const e=[];for(const t of _)e.push(t.cColVisible?t.cOriginWidth:"0px");const t=e.join(" ");if(t.includes("%")&&0!==I.info.gFrozenColCount)throw new Error(w+" has error. If you set the horizontal size to a percentage, property A is not available.");v.style.gridTemplateColumns=t,p.style.gridTemplateColumns=t,y.style.gridTemplateColumns=t},I._getCellChildNode=e=>{if(!e)return null;let o;switch(e.cDataType){case"text":o=document.createElement("span"),o.classList.add(w+"_data-value-text"),o.innerText=e.cValue,o.nType="text";break;case"number":o=document.createElement("span"),o.classList.add(w+"_data-value-number"),null===e.cValue||void 0===e.cValue||e.cValue===I.info.gNullValue?o.innerText=I.info.gNullValue:o.innerText=l.getFormatNumberFromCell(e),o.nType="number";break;case"mask":o=document.createElement("span"),o.classList.add(w+"_data-value-mask"),o.innerText=e.cValue,o.nType="mask";break;case"date":o=document.createElement("span"),o.classList.add(w+"_data-value-date"),null===e.cValue||void 0===e.cValue||e.cValue===I.info.gNullValue?o.innerText=I.info.gNullValue:o.innerText=l.getDateWithGridDateFormat(e),o.nType="date";break;case"month":o=document.createElement("span"),o.classList.add(w+"_data-value-month"),null===e.cValue||void 0===e.cValue||e.cValue===I.info.gNullValue?o.innerText=I.info.gNullValue:o.innerText=l.getDateWithGridMonthFormat(e),o.nType="month";break;case"select":Array.isArray(e.cValue)&&e.cValue.length>0?(o=document.createElement("select"),o.classList.add(w+"_data-value-select"),o.addEventListener("change",(function(e){l.selectAndCheckboxOnChange(e.target)})),l.setSelectOptions(o,e.cValue),o.nType="select",e.cSelectSize&&(o.style.width=e.cSelectSize)):(o=document.createElement("span"),o.classList.add(w+"_data-value-text"),o.innerText=I.info.gNullValue,o.nType="text");break;case"checkbox":o=document.createElement("input"),o.classList.add(w+"_data-value-checkbox"),o.addEventListener("change",(function(e){l.selectAndCheckboxOnChange(e.target)})),o.type="checkbox",o.nType="checkbox",l.getCheckboxCellTrueOrFalse(e)&&o.setAttribute("checked","");break;case"button":null===e.cValue||void 0===e.cValue||e.cValue===I.info.gNullValue?(o=document.createElement("span"),o.classList.add(w+"_data-value-text"),o.innerText=I.info.gNullValue,o.nType="text"):(o=document.createElement("button"),o.classList.add(w+"_data-value-button"),o.innerText=e.cValue,o.nType="button",o.addEventListener("touchstart",(function(){o.classList.add("active")})),o.addEventListener("touchend",(function(){o.classList.remove("active")})));break;case"link":null===e.cValue||void 0===e.cValue||e.cValue===I.info.gNullValue?(o=document.createElement("span"),o.classList.add(w+"_data-value-text"),o.innerText=I.info.gNullValue,o.nType="text"):(o=document.createElement("a"),o.classList.add(w+"_data-value-link"),o.innerText=e.cValue.text,o.setAttribute("href",e.cValue.value),o.setAttribute("target",e.cValue.target?e.cValue.target:"_blank"),o.nType="link");break;case"code":o=document.createElement("span"),o.classList.add(w+"_data-value-code"),o.innerText=e.cValue,o.nType="code";break;default:t.dataType&&Object.keys(t.dataType).forEach((l=>{if(l===e.cDataType){if(t.dataType[l].getChildNode){if("function"!=typeof t.dataType[l].getChildNode)throw new Error("getChildNode must be a function.");if(o=t.dataType[l].getChildNode(I.__getData(e)),o){if(!(o instanceof HTMLElement)||1!==o.nodeType)throw new Error("getChildNode must return an html element.")}else o=document.createElement("span"),o.innerText=e.cValue}else o=document.createElement("span"),o.innerText=e.cValue;o.classList.add(w+"_data-value-"+l),o.nType=l}}))}return o.classList.add(w+"_data-value"),o.gType="gbdv",o},I.__loadHeader=()=>{I.__setGridColSize(),l.removeAllChild(v),o.length=0;for(let e=1;e<=I.getHeaderRowCount();e++){h=[],b=1;for(const t of _){if(g=document.createElement("v-g-d"),g.gId=w,g.gType="ghd",Object.keys(t).forEach((e=>{["cHeader","cFooter","cRowMerge","cColMerge","cFilterValue","cIndex"].indexOf(e)<0&&(g[e]=t[e])})),Array.isArray(t.cHeader)?g.cValue=t.cHeader[e-1]?t.cHeader[e-1].replaceAll("\\n","\n"):"":g.cValue=t.cHeader,l.setGridDataRowCol(g,e,b),1!==b){if(!t.cHeader[e-1]){for(let o=e-2;o>=0;o--)t.cHeader[o]&&(g.rowMerge=!0);if(!g.rowMerge)for(let t=b-2;t>=0;t--)_[t].cHeader[e-1]&&(g.colMerge=!0)}}else 1!==e&&(g.rowMerge=!0);g.addEventListener("mousemove",(function(e){if(e.target.style.cursor&&this.style.removeProperty("cursor"),!l[e.target.gId]||!l[e.target.gId].info.gResizable)return;if("ghd"!==e.target.gType)return;const{left:t,right:o}=e.target.getBoundingClientRect(),r=e.clientX;let n,i;if(r-t<20){if(e.target.col<=3)return;if(e.target.frozenCol)return;for(let t=e.target.col-1;t>1&&(i=l[w]._getHeaderCell(1,t),!0!==i.cColVisible);t--);if(!i.cResizable)return;e.target.style.cursor="ew-resize",l.onHeaderDragging=!0,l.isHeaderDragging&&(n=r-l.mouseX,l.modifyColSize(e.target.gId,i,n),l.mouseX=r)}else if(o-r<20){if(e.target.col<3)return;if(e.target.frozenCol)return;for(let t=e.target.col;t>1&&(i=l[w]._getHeaderCell(1,t),!0!==i.cColVisible);t--);if(!i.cResizable)return;e.target.style.cursor="ew-resize",l.onHeaderDragging=!0,l.isHeaderDragging&&(n=r-l.mouseX,l.modifyColSize(e.target.gId,i,n),l.mouseX=r)}else e.target.style.cursor="",l.onHeaderDragging=!1})),g.addEventListener("mousedown",(function(e){l.mouseX=e.clientX,l.onHeaderDragging&&(l.isHeaderDragging=!0)})),h.push(g),b++}o.push(h)}for(const e of o)for(const t of e)v.append(t)},I._getHeaderRow=e=>l.getArrayElementWithBoundCheck(o,e-1),I._getHeaderCell=(e,t)=>{if("number"==typeof t)return l.getArrayElementWithBoundCheck(I._getHeaderRow(e),t-1);for(const o of I._getHeaderRow(e))if(o.cId===t)return o;throw new Error("There is no "+("number"==typeof t?t+"th":t)+" colunm.")},I._getHeaderCells=()=>o,I.getHeaderRowCount=()=>{let e=0;for(const t of _)t.cHeader.length>e&&(e=t.cHeader.length);return e},I.getHeaderText=e=>I.__getColInfo(e,!0).cHeader.join(";"),I.setHeaderText=(e,t)=>{const o=t.split(";");for(let e=o.length;e<I.getHeaderRowCount();e++)o.push("");for(let e=o.length;e>I.getHeaderRowCount();e--)_.forEach((e=>{e.cHeader.push("")}));return I.__getColInfo(e,!0).cHeader=o,I.__loadHeader(),I.reloadFilterValue(),!0},I.__getHeaderFilter=e=>{const t=I.__getColIndex(e);if(!_[t-1].cFilterable)return null;let o,l;for(let e=1;e<=I.getHeaderRowCount();e++)if(o=I._getHeaderCell(e,t),o&&(l=o.querySelectorAll("."+I.gId+"_filterSelect"),l[0]))return l[0];return null},I.reloadFilterValue=()=>{for(const e of _)I.reloadColFilter(e.cIndex);return!0},I.reloadColFilter=e=>(l.reloadFilterValue(I.gId,e),!0),I.__loadFooter=()=>{l.removeAllChild(y),C.length=0;for(let e=1;e<=I.getFooterRowCount();e++){for(V of(h=[],b=1,_))g=document.createElement("v-g-d"),g.gId=w,g.gType="gfd",Object.keys(V).forEach((e=>{["cHeader","cFooter","cRowMerge","cColMerge","cFilterValue","cIndex"].indexOf(e)<0&&(g[e]=V[e])})),V.cFooter&&V.cFooter[e-1]&&(g.cFooter=V.cFooter[e-1]),l.setGridDataRowCol(g,e,b),h.push(g),b++;C.push(h)}for(const e of C)for(const t of e)y.append(t)},I._getFooterRow=e=>l.getArrayElementWithBoundCheck(C,e-1),I._getFooterCell=(e,t)=>{if("number"==typeof t)return l.getArrayElementWithBoundCheck(I._getFooterRow(e),t-1);for(const o of I._getFooterRow(e))if(o.cId===t)return o;throw new Error("There is no "+("number"==typeof t?t+"th":t)+" colunm.")},I._getFooterCells=()=>C,I.getFooterRowCount=()=>{let e=0;for(const t of _)t.cFooter&&t.cFooter.length>e&&(e=t.cFooter.length);return e},I.reloadFooterValue=()=>(l.reloadFooterValue(I.gId),!0),I.setFooterValue=(e,t,o)=>{const l=I._getFooterCell(e,t);return l.cValue=o,l.innerText=o,!0},I.getFooterValue=(e,t)=>I._getFooterCell(e,t).cValue,I.setFooterFormula=(e,t)=>(I.__getColInfo(e,!0).cFooter=t.split(";"),I.__loadFooter(),!0),I.getFooterFormula=e=>{const t=l.deepCopy(I.__getColInfo(e,!0).cFooter);if(t&&Array.isArray(t)){for(let e=0;e<t.length;e++)"function"==typeof t[e]&&(t[e]="$$FUNC");return t.join(";")}return null},I.setFooterFunction=(e,t,o)=>{const r=I.__getColInfo(t,!0).cFooter;return r?(l.getArrayElementWithBoundCheck(r,e-1),r[e-1]=o):(I.__getColInfo(t,!0).cFooter=new Array(I.getFooterRowCount()).fill(""),I.__getColInfo(t,!0).cFooter[e-1]=o),I.__loadFooter(),!0},I._getRow=e=>f[e-1],I._getCell=(e,t)=>{try{if("number"==typeof t)return f[e-1][t-1];for(const o of f[e-1])if(o.cId===t)return o}catch(e){return null}return null},I._getCells=()=>f,I.__gridBodyCellsReConnected=()=>{if(I.variables._isDrawable)for(const e of f)for(const t of e)l.reConnectedCallbackElement(t)},I.__mountGridBodyCell=()=>{if(I.variables._isDrawable){l.removeAllChild(p);for(const e of f)for(const t of e)p.append(t);l.reloadGridForMerge(w),I.reloadFilterValue(),I.reloadFooterValue()}},I.__clear=()=>{f.length=0,I.variables._activeRows=[],I.variables._activeCols=[],I.variables._activeCells=[],I.variables._targetCell=null,I.variables._recodes=[],I.variables._recodeseq=0},I.__checkRowIndex=e=>{if(!(e=l.validatePositiveIntegerAndZero(e))||e<1||e>I.getRowCount())throw new Error("Please insert a row of valid range.")},I.__checkColRownumOrStatus=e=>{if("number"==typeof e){if(e<=2)throw new Error("The row number or status columns info cannot be modified.")}else if("v-g-rownum"===e||"v-g-status"===e)throw new Error("The row number or status columns info cannot be modified.")},I.__checkColIndex=e=>{if(!(e=l.validatePositiveIntegerAndZero(e))||e<1||e>I.getColCount())throw new Error("Please insert a col of valid range.")},I.getGridInfo=()=>{const e=I.info,t={};return Object.keys(e).forEach((o=>{const r=o.charAt(1).toLowerCase()+o.slice(2);"type"!==r&&(t[r]=l.deepCopy(e[o]))})),t.id=w,t.cssInfo=l.deepCopy(I.cssInfo),t},I.load=e=>{if(!e)return!1;if(!Array.isArray(e))throw new Error("Please insert valid datas.");const t=l.checkIsValueOrData(e);if(I.__clear(),t){const t=e;for(let e=1;e<=t.length;e++){h=[];const o=t[e-1];for(let t=1;t<=_.length;t++)g=l.getGridCell(w,_[t-1],o,e,t),h.push(g);f.push(h)}}else{const t=e;for(let e=1;e<=t.length;e++){h=[];const o=t[e-1];for(let t=1;t<=_.length;t++)g=l.getGridCell(w,_[t-1],o,e,t),h.push(g);f.push(h)}}return I.__mountGridBodyCell(),!0},I.clear=()=>(l.removeAllChild(p),I.variables._sortToggle={},I.variables._filters=[],I.__clear(),!0),I.clearStatus=()=>{for(let e=1;e<=I.getRowCount();e++)cell=I._getCell(e,2),cell.cValue=null,l.reConnectedCallbackElement(cell);return!0},I.getRowCount=()=>f.length,I.getColCount=()=>_.length,I.getValues=()=>{const e=[];let t;for(const o of f){t={};for(const e of o)t[e.cId]=l.deepCopy(e.cValue);e.push(t)}return e},I.___getDatasWithoutExceptedProperty=(e=[])=>{const t=[];let o;for(const l of f){o=[];for(const t of l){const l=I.__getData(t,e);o.push(l)}t.push(o)}return t},I.getDatas=()=>I.___getDatasWithoutExceptedProperty(),I.sort=(e,t=!0,o=!1)=>{const r=I.getDatas(),n=l.sort(I.gId,r,e,t,o),i=I.variables._sortToggle[e];return I.load(n),I.variables._sortToggle[e]=i,!0},I.checkRequired=e=>{if(e&&"function"!=typeof e)throw new Error("Please insert a valid function.");for(const o of f)for(const l of o)if(l.cRequired&&["select","checkbox","button","link"].indexOf(l.cDataType)<0&&(""===l.cValue||null===l.cValue||void 0===l.cValue||l.cValue===I.info.gNullValue)){if(e)e(I.__getData(l));else{if(!t.checkRequiredFunction||"function"!=typeof t.checkRequiredFunction)throw new Error("Please insert a valid checkRequired function.");t.checkRequiredFunction(I.__getData(l))}return!1}return!0},I.setGridMount=e=>(e=!0===e,I.variables._isDrawable=e,e&&I.__mountGridBodyCell(),!0),I.getGridFilter=()=>I.variables._filters,I.setGridWidth=e=>{if(!e)throw new Error("Please insert cssText of width.");return I.cssInfo.width=e,I._setGridCssStyle(),!0},I.setGridHeight=e=>{if(!e)throw new Error("Please insert cssText of height.");return I.cssInfo.height=e,I._setGridCssStyle(),!0},I.setGridSizeLevel=e=>{if(!(e=l.getOnlyNumberWithNaNToNull(e)))throw new Error("Please insert number of size level.");return I.cssInfo.sizeLevel=e,I.cssInfo.cellFontSize=(I.cssInfo.sizeLevel+15)/20*14+"px",I.cssInfo.cellMinHeight=(I.cssInfo.sizeLevel+15)/20*21+"px",I._setGridCssStyle(),!0},I.setGridVerticalAlign=e=>{if(!e)throw new Error("Please insert vertical align.");if(!l.isIncludeEnum(a,e))throw new Error("Please insert valid vertical align. (top, center, bottom)");const t=l.getVerticalAlign(e);return I.cssInfo.verticalAlign=t,I._setGridCssStyle(),!0},I.setCellFontSize=e=>{if(!e)throw new Error("Please insert cssText of cell font size.");return I.cssInfo.cellFontSize=e,I._setGridCssStyle(),!0},I.setCellMinHeight=e=>{if(!e)throw new Error("Please insert cssText of cell min height.");return I.cssInfo.cellMinHeight=e,I._setGridCssStyle(),!0},I.setHorizenBorderSize=e=>(l.validatePositiveIntegerAndZero(e),I.cssInfo.horizenBorderSize=e,I._setGridCssStyle(),!0),I.setVerticalBorderSize=e=>(l.validatePositiveIntegerAndZero(e),I.cssInfo.verticalBorderSize=e,I._setGridCssStyle(),!0),I.setGridColor=e=>{if(!/^#[0-9a-fA-F]{6}$/.test(e))throw new Error("Please insert valid cssText of hexadecimal color. (#ffffff)");return I.cssInfo.color=e,l.setColorSet(I.cssInfo),I._setGridCssStyle(),!0},I.setGridColorSet=e=>{const t=l.getColorFromColorSet(e);return I.cssInfo.color=t,l.setColorSet(I.cssInfo),I._setGridCssStyle(),!0},I.invertColor=e=>((e=!0===e)?l.setInvertColor(I.cssInfo):l.setColorSet(I.cssInfo),I._setGridCssStyle(),!0),I.setGridName=e=>{if(!e)throw new Error("Please insert a gridName.");return I.info.gName=String(e),!0},I.getGridName=()=>I.info.gName,I.setGridLocked=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");I.info.gLocked=e,_.forEach(((t,o)=>{o>=2&&(t.cLocked=e)}));const t=I.___getDatasWithoutExceptedProperty(["locked"]);return I.load(t),!0},I.isGridLocked=()=>I.info.gLocked,I.setGridLockedColor=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");I.info.gLockedColor=e,_.forEach(((t,o)=>{o>=2&&(t.cLockedColor=e)}));const t=I.___getDatasWithoutExceptedProperty(["lockedColor"]);return I.load(t),!0},I.setGridResizable=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");return I.info.gResizable=e,!0},I.isGridResizable=()=>I.info.gResizable,I.setGridRecodeCount=e=>(e=l.validatePositiveIntegerAndZero(e),I.info.gRedoCount=e,!0),I.getGridRecodeCount=()=>I.info.gRedoCount,I.setGridRedoable=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");I.info.gRedoable=e},I.isGridRedoable=()=>I.info.gRedoable,I.setGridVisible=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");return I.info.gVisible=e,I._setGridCssStyle(),!0},I.isGridVisible=()=>I.info.gVisible,I.setHeaderVisible=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");return I.info.gHeaderVisible=e,I._setGridCssStyle(),!0},I.isHeaderVisible=()=>I.info.gHeaderVisible,I.setGridRownumLockedColor=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");I.info.gRownumLockedColor=e,_[0].cLockedColor=e;for(const t of f)t[0].cLockedColor=e,l.reConnectedCallbackElement(t[0]);return!0},I.isGridRownumLockedColor=()=>I.info.gRownumLockedColor,I.setGridRownumSize=e=>{e=l.validatePositiveIntegerAndZero(e);const t=_[0];return t.cOriginWidth=String(e)+l.extractNumberAndUnit(t.cOriginWidth).unit,l.changeColSize(w,t.cIndex,e),t.cColVisible=0!==e,l.reloadGridWithModifyCell(w,t.cIndex),!0},I.getGridRownumSize=()=>_[0].cOriginWidth,I.setGridStatusLockedColor=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");I.info.gStatusLockedColor=e,_[1].cLockedColor=e;for(const t of f)t[1].cLockedColor=e,l.reConnectedCallbackElement(t[1]);return!0},I.isGridStatusLockedColor=()=>I.info.gStatusLockedColor,I.setGridSelectionPolicy=e=>{if(!l.isIncludeEnum(d,e))throw new Error("Please insert the correct selectionPolicy properties. (single, range, none)");return I.info.gSelectionPolicy=e,!0},I.getGridSelectionPolicy=e=>I.info.gSelectionPolicy,I.setGridNullValue=e=>(I.info.gNullValue=e,I.__gridBodyCellsReConnected(),!0),I.getGridNullValue=()=>l.deepCopy(I.info.gNullValue),I.setGridDateFormat=e=>(I.info.gDateFormat=e,I.__gridBodyCellsReConnected(),!0),I.getGridDateFormat=()=>I.info.gDateFormat,I.setGridMonthFormat=e=>(I.info.gMonthFormat=e,I.__gridBodyCellsReConnected(),!0),I.getGridMonthFormat=()=>I.info.gMonthFormat,I.setGridAlterRow=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");return I.info.gAlterRow=e,I.__gridBodyCellsReConnected(),!0},I.setGridFrozenColCount=e=>{e=l.validatePositiveIntegerAndZero(e);if(v.style.gridTemplateColumns.includes("%")&&0!==I.info.gFrozenColCount)throw new Error(w+" has error. If you set the horizontal size to a percentage, property A is not available.");I.info.gFrozenColCount=e;const t=I.getDatas();return I.__loadHeader(),I.__loadFooter(),I.load(t),!0},I.getGridFrozenColCount=()=>I.info.gFrozenColCount,I.setGridFrozenRowCount=e=>{e=l.validatePositiveIntegerAndZero(e),I.info.gFrozenRowCount=e;const t=I.getDatas();return I.__loadHeader(),I.__loadFooter(),I.load(t),!0},I.getGridFrozenRowCount=()=>I.info.gFrozenRowCount,I.setGridSortable=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");return I.info.gSortable=e,!0},I.isGridSortable=()=>I.info.gSortable,I.setGridFilterable=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");I.info.gFilterable=e;const t=I.getDatas();return I.__loadHeader(),I.__loadFooter(),I.load(t),!0},I.isGridFilterable=()=>I.info.gFilterable,I.setGridAllCheckable=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");return I.info.gAllCheckable=e,!0},I.isGridAllCheckable=()=>I.info.gAllCheckable,I.setGridCheckedValue=e=>{if("string"!=typeof e)throw new Error("Please insert a string type.");if(I.info.gUncheckedValue===e)throw new Error("Checked and unchecked values cannot be the same.");const t=I.getDatas();for(const o of t)for(const t of o)"checkbox"===t.dataType&&t.value===I.info.gCheckedValue&&(t.value=e);return I.info.gCheckedValue=e,I.__loadHeader(),I.__loadFooter(),I.load(t),!0},I.getGridCheckedValue=()=>I.info.gCheckedValue,I.setGridUncheckedValue=e=>{if("string"!=typeof e)throw new Error("Please insert a string type.");if(I.info.gCheckedValue===e)throw new Error("Checked and unchecked values cannot be the same.");const t=I.getDatas();for(const o of t)for(const t of o)"checkbox"===t.dataType&&t.value!==I.info.gCheckedValue&&(t.value=e);return I.info.gUncheckedValue=e,I.__loadHeader(),I.__loadFooter(),I.load(t),!0},I.getGridUncheckedValue=()=>I.info.gUncheckedValue,I.addCol=(e,t)=>{let o=I.__getColIndex(e);if(o<2)throw new Error("You cannot add new columns between the row number and status columns.");(!o||o>I.getColCount())&&(o=I.getColCount());const l=I.__getDefaultColInfo(t,!0),r=I.getDatas();return _.splice(o,0,l),_.forEach(((e,t)=>{e.cIndex=t+1})),I.__loadHeader(),I.__loadFooter(),I.load(r),!0},I.removeCol=e=>{const t=I.__getColIndex(e,!0);if(t<=2)throw new Error("The row number or status columns cannot be removed.");const o=I.getColValues(t);_.splice(t-1,1),_.forEach(((e,t)=>{e.cIndex=t+1}));const l=I.getDatas();return I.__loadHeader(),I.__loadFooter(),I.load(l),o},I.setColInfo=e=>{if(!e)throw new Error("Column info is required.");if(e.constructor!==Object)throw new Error("Please insert a valid column info");let t;if(e.index&&(t=e.index),e.id&&(t=e.id),!t)throw new Error("Column id is required.");const o=I.__getColIndex(t,!0);if(o<=2)throw new Error("The row number or status columns are immutable.");const l=_[o-1];Object.keys(l).forEach((t=>{if(-1===["cId","cIndex"].indexOf(t)){const o=t.charAt(1).toLowerCase()+t.slice(2);Object.keys(e).forEach((r=>{o===r&&(l[t]=e[r])}))}}));const r=I.getDatas();return r.forEach((e=>{for(const t of e)t.id===l.cId&&Object.keys(l).forEach((e=>{if(["cHeader","cFooter","cRowMerge","cColMerge","cFilterValue"].indexOf(e)<0){const o=e.charAt(1).toLowerCase()+e.slice(2);t[o]=l[e]}}))})),I.__loadHeader(),I.__loadFooter(),I.load(r),!0},I.getColInfo=e=>{V=I.__getColInfo(e);const t={};return t.id=V.cId,t.index=V.cIndex,t.name=V.cName,t.untarget=V.cUntarget,t.colVisible=V.cColVisible,t.required=V.cRequired,t.resizable=V.cResizable,t.originWidth=V.cOriginWidth,t.dataType=V.cDataType,t.selectSize=V.cSelectSize,t.locked=V.cLocked,t.lockedColor=V.cLockedColor,t.format=V.cFormat,t.codes=l.deepCopy(V.cCodes),t.defaultCode=V.cDefaultCode,t.maxLength=V.cMaxLength,t.maxByte=V.cMaxByte,t.maxNumber=V.cMaxNumber,t.minNumber=V.cMinNumber,t.roundNumber=V.cRoundNumber,t.align=V.cAlign,t.verticalAlign=V.cVerticalAlign,t.overflowWrap=V.cOverflowWrap,t.wordBreak=V.cWordBreak,t.whiteSpace=V.cWhiteSpace,t.backColor=V.cBackColor,t.fontColor=V.cFontColor,t.fontBold=V.cFontBold,t.fontItalic=V.cFontItalic,t.fontThruline=V.cFontThruline,t.fontUnderline=V.cFontUnderline,V.cHeader&&Array.isArray(V.cHeader)&&(t.header=V.cHeader.join(";")),V.cFooter&&Array.isArray(V.cFooter)&&(t.footer=V.cFooter.join(";")),t.rowMerge=V.cRowMerge,t.colMerge=V.cColMerge,t.sortable=V.cSortable,t.filterable=V.cFilterable,t.filterValues=l.deepCopy(V.cFilterValues),t.filterValue=l.deepCopy(V.cFilterValue),t},I.getColDatas=e=>{const t=I.__getColIndex(e,!0),o=[];for(let e=1;e<=I.getRowCount();e++)o.push(I.getCellData(e,t));return o},I.setColSameValue=(e,t,o=!1)=>{if(I.__checkColRownumOrStatus(e),o){const o=[];for(let r=1;r<=I.getRowCount();r++){let n=I._getCell(r,e),i=l.getRecodesWithModifyValue(n,t,!0);Array.isArray(i)&&i.length>0&&o.push(i[0])}l.recodeGridModify(I.gId,o)}else{for(let o=1;o<=I.getRowCount();o++){let r=I._getCell(o,e);r.cValue=l.getValidValue(r,t),l.reConnectedCallbackElement(r)}l.reloadGridWithModifyCell(w,e)}return!0},I.getColValues=e=>{const t=I.__getColIndex(e,!0),o=[];for(let e=1;e<=I.getRowCount();e++){let r=I._getCell(e,t);o.push(l.deepCopy(r.cValue))}return o},I.getColTexts=e=>{const t=I.__getColIndex(e,!0),o=[];for(let e=1;e<=I.getRowCount();e++)o.push(I.getCellText(e,t));return o},I.isColUnique=e=>{const t=I.__getColIndex(e,!0),o=[];for(let e=1;e<=I.getRowCount();e++){let r=I._getCell(e,t);switch(r.cDataType){case"select":case"checkbox":case"button":case"link":o.push(l.getCellText(r));break;default:o.push(r.cValue)}}return o.length===new Set(o).size},I._doFilter=()=>{let e;if(I.variables._filters=[],I._getHeader().querySelectorAll("."+w+"_filterSelect").forEach((function(t){"$$ALL"!==t.value&&(e={},e.cId=t.cId,e.value=t.value,I.__getColInfo(t.parentNode.parentNode.cIndex).cFilterValue=t.value,"$$NULL"!==e.value&&null!==e.value&&void 0!==e.value&&""!==e.value||(e.value=I.info.gNullValue),I.variables._filters.push(e))})),0===I.variables._filters.length)I._getCells().forEach((function(e){e.forEach((function(e){e.cFilter=!1}))}));else{let e=1;I._getCells().forEach((function(o){let r=!1;o.forEach((function(e){I.variables._filters.forEach((function(o){if(e.cId===o.cId){let n=l.getCellText(e);Object.keys(t.dataType).forEach((o=>{if(e.cDataType===o&&t.dataType[o].getFilterValue){if("function"!=typeof t.dataType[o].getFilterValue)throw new Error("getFilterValue must be a function.");n=t.dataType[o].getFilterValue(e.cValue)}})),n!=o.value&&(r=!0)}}))})),I._getRow(e).forEach((function(e){e.cFilter=r})),e++}))}I.load(I.getDatas())},I.openColFilter=e=>(I.__getHeaderFilter(e).style.display="block",!0),I.closeColFilter=e=>(I.__getHeaderFilter(e).style.display="none",!0),I.setColFilterValue=(e,t)=>{const o=I.__getColInfo(e,!0);if(!o.cFilterValues.has(t))throw new Error("Please insert a valid filterValue. "+Array.from(o.cFilterValues).join(", "));let l,r;for(let e=1;e<=I.getHeaderRowCount();e++)if(l=I._getHeaderCell(e,o.cIndex),r=l.querySelectorAll("."+w+"_filterSelect"),r.length>0){r=r[0];break}return r.value=t,"$$ALL"!==r.value&&(r.style.display="block"),I._doFilter(),!0},I.getColFilterValues=e=>{const t=I.__getColInfo(e,!0);return Array.from(t.cFilterValues)},I.getColFilterValue=e=>I.__getColInfo(e,!0).cFilterValue,I.getColId=e=>I.__getColInfo(e,!0).cId,I.getColIndex=e=>I.__getColIndex(e,!0),I.setColName=(e,t)=>{const o=I.__getColIndex(e,!0);if(!t)throw new Error("Column Name is required");if("string"!=typeof t)throw new Error("Please insert a string type.");I.__getColInfo(o).cName=t;for(let e=1;e<=I.getRowCount();e++)I._getCell(e,o).cName=t;return!0},I.getColName=e=>I.__getColInfo(e).cName,I.setColUntarget=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");I.__getColInfo(o).cUntarget=t;for(let e=1;e<=I.getRowCount();e++)I._getCell(e,o).cUntarget=t;return!0},I.setColRowMerge=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");I.__getColInfo(o).cRowMerge=t;const l=I.getDatas();return I.load(l),!0},I.isColRowMerge=e=>I.__getColInfo(e,!0).cRowMerge,I.setColColMerge=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");I.__getColInfo(o).cColMerge=t;const l=I.getDatas();return I.load(l),!0},I.isColColMerge=e=>I.__getColInfo(e,!0).cColMerge,I.setColVisible=(e,t)=>{if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");const o=I.__getColInfo(e,!0);return t?l.changeColSize(w,o.cIndex,l.extractNumberAndUnit(o.cOriginWidth).number):l.changeColSize(w,o.cIndex,0),o.cColVisible=t,I.__loadHeader(),l.reloadGridWithModifyCell(w,o.cIndex),!0},I.isColVisible=e=>I.__getColInfo(e,!0).cColVisible,I.setColRequired=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");I.__getColInfo(o,!0).cRequired=t;for(let e=1;e<=I.getRowCount();e++)I._getCell(e,o).cRequired=t;return!0},I.isColRequired=e=>I.__getColInfo(e,!0).cRequired,I.setColResizable=(e,t)=>{if(I.__checkColRownumOrStatus(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");return I.__getColInfo(e,!0).cResizable=t,I.__loadHeader(),!0},I.isColResizable=e=>I.__getColInfo(e,!0).cResizable,I.setColSortable=(e,t)=>{if(I.__checkColRownumOrStatus(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");return I.__getColInfo(e,!0).cSortable=t,!0},I.isColSortable=e=>I.__getColInfo(e,!0).cSortable,I.setColFilterable=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");return I.__getColInfo(o,!0).cFilterable=t,I.__loadHeader(),l.reloadFilterValue(w,o),!0},I.isColFilterable=e=>I.__getColInfo(e,!0).cFilterable,I.setColOriginWidth=(e,t)=>{const o=I.__getColInfo(e,!0),n=l.extractNumberAndUnit(t);if(!l.isIncludeEnum(r,n.unit))throw new Error("Width units can only be pixel or %.");return o.cOriginWidth=n.number+n.unit,l.changeColSize(w,o.cIndex,n.number),0===n.number?o.cColVisible=!1:o.cColVisible=!0,I.__loadHeader(),l.reloadGridWithModifyCell(w,o.cIndex),!0},I.getColOriginWidth=e=>I.__getColInfo(e,!0).cOriginWidth,I.setColDataType=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);if(!l.isIncludeEnum(n,t))throw new Error("Please insert a valid dataType.");I.__getColInfo(o).cDataType=t;for(let e=1;e<=I.getRowCount();e++){const r=I._getCell(e,o);r.cDataType=t,l.reConnectedCallbackElement(r)}return l.reloadGridWithModifyCell(w,o),!0},I.getColDataType=e=>I.__getColInfo(e,!0).cDataType,I.setColSelectSize=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);I.__getColInfo(o).cSelectSize=t;for(let e=1;e<=I.getRowCount();e++){const l=I._getCell(e,o);l.cSelectSize=t,I.__gridCellReConnectedWithControlSpan(l)}return!0},I.getColSelectSize=e=>I.__getColInfo(e,!0).cSelectSize,I.setColLocked=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");I.__getColInfo(o).cLocked=t;for(let e=1;e<=I.getRowCount();e++){const l=I._getCell(e,o);l.cLocked=t,I.__gridCellReConnectedWithControlSpan(l)}return!0},I.isColLocked=e=>I.__getColInfo(e,!0).cLocked,I.setColLockedColor=(e,t)=>{const o=I.__getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");I.__getColInfo(o).cLockedColor=t;for(let e=1;e<=I.getRowCount();e++){const l=I._getCell(e,o);l.cLockedColor=t,I.__gridCellReConnectedWithControlSpan(l)}return!0},I.isColLockedColor=e=>I.__getColInfo(e,!0).cLockedColor,I.setColFormat=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);if("string"!=typeof t)throw new Error("Please insert a string type.");I.__getColInfo(o).cFormat=t;for(let e=1;e<=I.getRowCount();e++){const r=I._getCell(e,o);r.cFormat=t,"mask"===r.cDataType&&(r.cValue=l.getValidValue(r,r.cValue)),l.reConnectedCallbackElement(r)}return l.reloadGridWithModifyCell(w,o),!0},I.getColFormat=e=>I.__getColInfo(e,!0).cFormat,I.setColCodes=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);if(!Array.isArray(t))throw new Error("Please insert a vaild codes. (Array)");I.__getColInfo(o).cCodes=t;for(let e=1;e<=I.getRowCount();e++){const r=I._getCell(e,o);r.cCodes=t,"code"===r.cDataType&&(r.cValue=l.getValidValue(r,r.cValue)),l.reConnectedCallbackElement(r)}return l.reloadGridWithModifyCell(w,o),!0},I.getColCodes=e=>I.__getColInfo(e,!0).cCodes,I.setColDefaultCode=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);I.__getColInfo(o).cDefaultCode=t;for(let e=1;e<=I.getRowCount();e++){const r=I._getCell(e,o);r.cDefaultCode=t,"code"===r.cDataType&&(r.cValue=l.getValidValue(r,r.cValue)),l.reConnectedCallbackElement(r)}return l.reloadGridWithModifyCell(w,o),!0},I.getColDefaultCode=e=>I.__getColInfo(e,!0).cDefaultCode,I.setColMaxLength=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);t=l.validatePositiveIntegerAndZero(t);I.__getColInfo(o).cMaxLength=t;for(let e=1;e<=I.getRowCount();e++){const r=I._getCell(e,o);r.cMaxLength=t,"text"===r.cDataType&&(r.cValue=l.getValidValue(r,r.cValue)),l.reConnectedCallbackElement(r)}return l.reloadGridWithModifyCell(w,o),!0},I.getColMaxLength=e=>I.__getColInfo(e,!0).cMaxLength,I.setColMaxByte=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);t=l.validatePositiveIntegerAndZero(t);I.__getColInfo(o).cMaxByte=t;for(let e=1;e<=I.getRowCount();e++){const r=I._getCell(e,o);r.cMaxByte=t,"text"===r.cDataType&&(r.cValue=l.getValidValue(r,r.cValue)),l.reConnectedCallbackElement(r)}return l.reloadGridWithModifyCell(w,o),!0},I.getColMaxByte=e=>I.__getColInfo(e,!0).cMaxByte,I.setColMaxNumber=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);t=l.validateNumber(t);I.__getColInfo(o).cMaxNumber=t;for(let e=1;e<=I.getRowCount();e++){const r=I._getCell(e,o);r.cMaxNumber=t,"number"===r.cDataType&&(r.cValue=l.getValidValue(r,r.cValue)),l.reConnectedCallbackElement(r)}return l.reloadGridWithModifyCell(w,o),!0},I.getColMaxNumber=e=>I.__getColInfo(e,!0).cMaxNumber,I.setColMinNumber=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);t=l.validateNumber(t);I.__getColInfo(o).cMinNumber=t;for(let e=1;e<=I.getRowCount();e++){const r=I._getCell(e,o);r.cMinNumber=t,"number"===r.cDataType&&(r.cValue=l.getValidValue(r,r.cValue)),l.reConnectedCallbackElement(r)}return l.reloadGridWithModifyCell(w,o),!0},I.getColMinNumber=e=>I.__getColInfo(e,!0).cMinNumber,I.setColRoundNumber=(e,t)=>{I.__checkColRownumOrStatus(e);const o=I.__getColIndex(e,!0);t=l.validateIntegerAndZero(t);I.__getColInfo(o).cRoundNumber=t;for(let e=1;e<=I.getRowCount();e++){const r=I._getCell(e,o);r.cRoundNumber=t,"number"===r.cDataType&&(r.cValue=l.getValidValue(r,r.cValue)),l.reConnectedCallbackElement(r)}return l.reloadGridWithModifyCell(w,o),!0},I.getColRoundNumber=e=>I.__getColInfo(e,!0).cRoundNumber,I.setColAlign=(e,t)=>{const o=I.__getColIndex(e,!0);if(!l.isIncludeEnum(i,t))throw new Error("Please insert a vaild align. (left, center, right)");I.__getColInfo(o).cAlign=t;for(let e=1;e<=I.getRowCount();e++){const l=I._getCell(e,o);l.cAlign=t,I.__gridCellReConnectedWithControlSpan(l)}return!0},I.getColAlign=e=>I.__getColInfo(e,!0).cAlign,I.setColVerticalAlign=(e,t)=>{const o=I.__getColIndex(e,!0);if(!l.isIncludeEnum(a,t))throw new Error("Please insert a vaild align. (top, center, bottom)");I.__getColInfo(o).cVerticalAlign=t;for(let e=1;e<=I.getRowCount();e++){const l=I._getCell(e,o);l.cVerticalAlign=t,I.__gridCellReConnectedWithControlSpan(l)}return!0},I.getColVerticalAlign=e=>I.__getColInfo(e,!0).cVerticalAlign,I.setColOverflowWrap=(e,t)=>{const o=I.__getColIndex(e,!0);I.__getColInfo(o).cOverflowWrap=t;for(let e=1;e<=I.getRowCount();e++){const l=I._getCell(e,o);l.cOverflowWrap=t,I.__gridCellReConnectedWithControlSpan(l)}return!0},I.getColOverflowWrap=e=>I.__getColInfo(e,!0).cOverflowWrap,I.setColWordBreak=(e,t)=>{const o=I.__getColIndex(e,!0);I.__getColInfo(o).cWordBreak=t;for(let e=1;e<=I.getRowCount();e++){const l=I._getCell(e,o);l.cWordBreak=t,I.__gridCellReConnectedWithControlSpan(l)}return!0},I.getColWordBreak=e=>I.__getColInfo(e,!0).cWordBreak,I.setColWhiteSpace=(e,t)=>{const o=I.__getColIndex(e,!0);I.__getColInfo(o).cWhiteSpace=t;for(let e=1;e<=I.getRowCount();e++){const l=I._getCell(e,o);l.cWhiteSpace=t,I.__gridCellReConnectedWithControlSpan(l)}return!0},I.getColWhiteSpace=e=>I.__getColInfo(e,!0).cWhiteSpace,I.setColBackColor=(e,t)=>{const o=I.__getColIndex(e,!0);if("#000"!==t&&"#000000"!==t&&"#000000"===l.getHexColorFromColorName(t))throw new Error("Please enter the correct hexadecimal color. (#ffffff)");I.__getColInfo(o).cBackColor=t;for(let e=1;e<=I.getRowCount();e++){const l=I._getCell(e,o);l.cBackColor=t,I.__gridCellReConnectedWithControlSpan(l)}return!0},I.getColBackColor=e=>I.__getColInfo(e,!0).cBackColor,I.setColFontColor=(e,t)=>{const o=I.__getColIndex(e,!0);if("#000"!==t&&"#000000"!==t&&"#000000"===l.getHexColorFromColorName(t))throw new Error("Please enter the correct hexadecimal color. (#ffffff)");I.__getColInfo(o).cFontColor=t;for(let e=1;e<=I.getRowCount();e++){const l=I._getCell(e,o);l.cFontColor=t,I.__gridCellReConnectedWithControlSpan(l)}return!0},I.getColFontColor=e=>I.__getColInfo(e,!0).cFontColor,I.setColFontBold=(e,t)=>{const o=I.__getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");I.__getColInfo(o).cFontBold=t;for(let e=1;e<=I.getRowCount();e++){const l=I._getCell(e,o);l.cFontBold=t,I.__gridCellReConnectedWithControlSpan(l)}return!0},I.isColFontBold=e=>I.__getColInfo(e,!0).cFontBold,I.setColFontItalic=(e,t)=>{const o=I.__getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");I.__getColInfo(o).cFontItalic=t;for(let e=1;e<=I.getRowCount();e++){const l=I._getCell(e,o);l.cFontItalic=t,I.__gridCellReConnectedWithControlSpan(l)}return!0},I.isColFontItalic=e=>I.__getColInfo(e,!0).cFontItalic,I.setColFontThruline=(e,t)=>{const o=I.__getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");I.__getColInfo(o).cFontThruline=t;for(let e=1;e<=I.getRowCount();e++){const l=I._getCell(e,o);l.cFontThruline=t,I.__gridCellReConnectedWithControlSpan(l)}return!0},I.isColFontThruline=e=>I.__getColInfo(e,!0).cFontThruline,I.setColFontUnderline=(e,t)=>{const o=I.__getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");I.__getColInfo(o).cFontUnderline=t;for(let e=1;e<=I.getRowCount();e++){const l=I._getCell(e,o);l.cFontUnderline=t,I.__gridCellReConnectedWithControlSpan(l)}return!0},I.isColFontUnderline=e=>I.__getColInfo(e,!0).cFontUnderline,I.addRow=(e,t)=>{let o,r;if(0===e&&(e=1),e?"number"==typeof e?(o=e-1,r=t):r=e:r=t,(null==o||o>I.getRowCount())&&(o=I.getRowCount()),r=r?[r]:[[{}]],null===r||!Array.isArray(r))throw new Error("Please insert valid datas.");const n=l.checkIsValueOrData(r),i=I.getDatas();let a=0;for(const e of r){if(n){const t=[];let l;for(const o in e)l={},l.id=o,l.value=e[o],t.push(l);i.splice(o+a,0,t)}else i.splice(o+a,0,e);a++}I.load(i);for(let e=o;e<o+a;e++)I.setRowStatus(e+1,"C");return l.focusCell(I._getCell(o+1,"v-g-status")),!0},I.removeRow=e=>{I.__checkRowIndex(e);const t=I.getRowValues(e);t["v-g-status"]="D";const o=I.getDatas();return o.splice(e-1,1),I.load(o),t},I.setRowStatus=(e,t)=>{if(I.__checkRowIndex(e),!l.isIncludeEnum(c,t))throw new Error("Please insert the correct status code. (C, U, D)");const o=I._getCell(e,"v-g-status");return o.cValue=t,l.reConnectedCallbackElement(o),!0},I.getRowStatus=e=>(I.__checkRowIndex(e),I._getCell(e,"v-g-status").cValue),I.setRowDatas=(e,t)=>{for(const o of t)I.__setCellData(e,o.id,o,!1);return!0},I.getRowDatas=e=>{I.__checkRowIndex(e);const t=[];for(const o of _)t.push(I.getCellData(e,o.cIndex));return t},I.setRowValues=(e,t,o=!1)=>{if(2,I.__checkRowIndex(2),!t||t.constructor!==Object)throw new Error("Please insert a valid value.");let r=null,n=null;if(o){const e=[];let o;for(const i of _)if("v-g-rownum"!==i.cId&&"v-g-status"!==i.cId){for(const e in t)i.cId===e&&(r=t[e]);n=I._getCell(2,i.cIndex),o=l.getRecodesWithModifyValue(n,r,!0),Array.isArray(o)&&o.length>0&&e.push(o[0])}l.recodeGridModify(I.gId,e)}else for(const e of _)if("v-g-rownum"!==e.cId&&"v-g-status"!==e.cId){for(const o in t)e.cId===o&&(r=t[o]);n=I._getCell(2,e.cIndex),n.cValue=l.getValidValue(n,r),l.reConnectedCallbackElement(n),l.reloadGridWithModifyCell(n.gId,n.cIndex)}return!0},I.getRowValues=e=>{I.__checkRowIndex(e);const t={};for(const o of f[e-1])t[o.cId]=l.deepCopy(o.cValue);return t},I.getRowTexts=e=>{I.__checkRowIndex(e);const t={};for(const o of f[e-1])t[o.cId]=l.getCellText(o);return t},I.setRowVisible=(e,t)=>{if(I.__checkRowIndex(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");for(let o=1;o<=I.getColCount();o++){const l=I._getCell(e,o);l.cRowVisible=t,I.__gridCellReConnectedWithControlSpan(l)}return!0},I.isRowVisible=e=>{I.__checkRowIndex(e);return I._getCell(e,1).cRowVisible},I.setRowDataType=(e,t)=>{if(I.__checkRowIndex(e),!l.isIncludeEnum(n,t))throw new Error("Please insert a valid dataType.");for(const o of f[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cDataType=t,l.reConnectedCallbackElement(o));return l.reloadGridForMerge(w),I.reloadFilterValue(),I.reloadFooterValue(),!0},I.setRowLocked=(e,t)=>{if(I.__checkRowIndex(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");for(const o of f[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cLocked=t,I.__gridCellReConnectedWithControlSpan(o));return!0},I.setRowLockedColor=(e,t)=>{if(I.__checkRowIndex(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");for(const o of f[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cLockedColor=t,I.__gridCellReConnectedWithControlSpan(o));return!0},I.setRowAlign=(e,t)=>{if(I.__checkRowIndex(e),!l.isIncludeEnum(i,t))throw new Error("Please insert a vaild align. (left, center, right)");for(const o of f[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cAlign=t,I.__gridCellReConnectedWithControlSpan(o));return!0},I.setRowVerticalAlign=(e,t)=>{if(I.__checkRowIndex(e),!l.isIncludeEnum(a,t))throw new Error("Please insert valid vertical align. (top, center, bottom)");for(const o of f[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cVerticalAlign=t,I.__gridCellReConnectedWithControlSpan(o));return!0},I.setRowBackColor=(e,t)=>{if(I.__checkRowIndex(e),"#000"!==t&&"#000000"!==t&&"#000000"===l.getHexColorFromColorName(t))throw new Error("Please enter the correct hexadecimal color. (#ffffff)");for(const o of f[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cBackColor=t,I.__gridCellReConnectedWithControlSpan(o));return!0},I.setRowFontColor=(e,t)=>{if(I.__checkRowIndex(e),"#000"!==t&&"#000000"!==t&&"#000000"===l.getHexColorFromColorName(t))throw new Error("Please enter the correct hexadecimal color. (#ffffff)");for(const o of f[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cFontColor=t,I.__gridCellReConnectedWithControlSpan(o));return!0},I.setRowFontBold=(e,t)=>{if(I.__checkRowIndex(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");for(const o of f[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cFontBold=t,I.__gridCellReConnectedWithControlSpan(o));return!0},I.setRowFontItalic=(e,t)=>{if(I.__checkRowIndex(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");for(const o of f[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cFontItalic=t,I.__gridCellReConnectedWithControlSpan(o));return!0},I.setRowFontThruline=(e,t)=>{if(I.__checkRowIndex(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");for(const o of f[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cFontThruline=t,I.__gridCellReConnectedWithControlSpan(o));return!0},I.setRowFontUnderline=(e,t)=>{if(I.__checkRowIndex(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");for(const o of f[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cFontUnderline=t,I.__gridCellReConnectedWithControlSpan(o));return!0},I.searchRowsWithMatched=e=>{if(e.constructor!==Object)throw new Error("Please insert a valid matches. (Object)");const t=[];let o;return f.forEach(((l,r)=>{o=!0;for(const t of l)for(const l of Object.keys(e))if(t.cId===l&&t.cValue!==e[l]){o=!1;break}o&&t.push(r+1)})),t},I.searchRowDatasWithMatched=e=>{const t=I.searchRowsWithMatched(e),o=[];return t.forEach((e=>{o.push(I.getRowDatas(e))})),o},I.searchRowValuesWithMatched=e=>{const t=I.searchRowsWithMatched(e),o=[];return t.forEach((e=>{o.push(I.getRowValues(e))})),o},I.searchRowsWithFunction=e=>{if("function"!=typeof e)throw new Error("Please insert a valid function.");const t=[];let o;for(let l=1;l<=I.getRowCount();l++)o=e(I.getRowDatas(l)),o&&t.push(l);return t},I.searchRowDatasWithFunction=e=>{const t=I.searchRowsWithFunction(e),o=[];return t.forEach((e=>{o.push(I.getRowDatas(e))})),o},I.searchRowValuesWithFunction=e=>{const t=I.searchRowsWithFunction(e),o=[];return t.forEach((e=>{o.push(I.getRowValues(e))})),o},I.__gridCellReConnectedWithControlSpan=e=>{if(l.reConnectedCallbackElement(e),e.rowSpan)for(let t=e.row+1;t<e.row+e.rowSpan;t++)I.__gridCellReConnectedWithControlSpan(I._getCell(t,e.col));if(e.colSpan)for(let t=e.col+1;t<e.col+e.colSpan;t++)I.__gridCellReConnectedWithControlSpan(I._getCell(e.row,t))},I.__getData=(e,t=[])=>{const o={};return o.gridId=w,o.gridName=I.info.gName,o.id=e.cId,o.index=e.cIndex,o.name=e.cName,o.row=e.row,o.col=e.col,o.untarget=e.cUntarget,o.colVisible=e.cColVisible,o.rowVisible=e.cRowVisible,o.required=e.cRequired,o.resizable=e.cResizable,o.originWidth=e.cOriginWidth,o.dataType=e.cDataType,o.selectSize=e.cSelectSize,o.locked=e.cLocked,o.lockedColor=e.cLockedColor,o.format=e.cFormat,o.codes=l.deepCopy(e.cCodes),o.defaultCode=e.cDefaultCode,o.maxLength=e.cMaxLength,o.maxByte=e.cMaxByte,o.maxNumber=e.cMaxNumber,o.minNumber=e.cMinNumber,o.roundNumber=e.cRoundNumber,o.align=e.cAlign,o.verticalAlign=e.cVerticalAlign,o.overflowWrap=e.cOverflowWrap,o.wordBreak=e.cWordBreak,o.whiteSpace=e.cWhiteSpace,o.backColor=e.cBackColor,o.fontColor=e.cFontColor,o.fontBold=e.cFontBold,o.fontItalic=e.cFontItalic,o.fontThruline=e.cFontThruline,o.fontUnderline=e.cFontUnderline,o.value=l.deepCopy(e.cValue),o.filter=l.deepCopy(e.cFilter),t&&(t.indexOf("untarget")>=0&&delete o.untarget,t.indexOf("colVisible")>=0&&delete o.colVisible,t.indexOf("rowVisible")>=0&&delete o.rowVisible,t.indexOf("required")>=0&&delete o.required,t.indexOf("resizable")>=0&&delete o.resizable,t.indexOf("originWidth")>=0&&delete o.originWidth,t.indexOf("dataType")>=0&&delete o.dataType,t.indexOf("selectSize")>=0&&delete o.selectSize,t.indexOf("locked")>=0&&delete o.locked,t.indexOf("lockedColor")>=0&&delete o.lockedColor,t.indexOf("format")>=0&&delete o.format,t.indexOf("codes")>=0&&delete o.codes,t.indexOf("defaultCode")>=0&&delete o.defaultCode,t.indexOf("maxLength")>=0&&delete o.maxLength,t.indexOf("maxByte")>=0&&delete o.maxByte,t.indexOf("maxNumber")>=0&&delete o.maxNumber,t.indexOf("minNumber")>=0&&delete o.minNumber,t.indexOf("roundNumber")>=0&&delete o.roundNumber,t.indexOf("align")>=0&&delete o.align,t.indexOf("verticalAlign")>=0&&delete o.verticalAlign,t.indexOf("backColor")>=0&&delete o.backColor,t.indexOf("fontColor")>=0&&delete o.fontColor,t.indexOf("fontBold")>=0&&delete o.fontBold,t.indexOf("fontItalic")>=0&&delete o.fontItalic,t.indexOf("fontThruline")>=0&&delete o.fontThruline,t.indexOf("fontUnderline")>=0&&delete o.fontUnderline,t.indexOf("value")>=0&&delete o.value,t.indexOf("filter")>=0&&delete o.filter),o.text=l.getCellText(e),o},I.__setCellData=(e,t,o,r=!0)=>{I.__checkRowIndex(e);const n=I.__getColIndex(t,!0);if(n<=2){if(r)throw new Error("The row number or status columns are immutable.");return!1}const i=I._getCell(e,n);return o.untarget&&(i.cUntarget=o.untarget),o.dataType&&(i.cDataType=o.dataType),o.selectSize&&(i.cSelectSize=o.selectSize),o.locked&&(i.cLocked=o.locked),o.lockedColor&&(i.cLockedColor=o.lockedColor),o.format&&(i.cFormat=o.format),o.codes&&(i.cCodes=o.codes),o.defaultCode&&(i.cDefaultCode=o.defaultCode),o.maxLength&&(i.cMaxLength=o.maxLength),o.maxByte&&(i.cMaxByte=o.maxByte),o.maxNumber&&(i.cMaxNumber=o.maxNumber),o.minNumber&&(i.cMinNumber=o.minNumber),o.roundNumber&&(i.cRoundNumber=o.roundNumber),o.value&&(i.cValue=o.value),o.align&&(i.cAlign=o.align),o.verticalAlign&&(i.cVerticalAlign=o.verticalAlign),o.overflowWrap&&(i.cOverflowWrap=o.overflowWrap),o.wordBreak&&(i.cWordBreak=o.wordBreak),o.whiteSpace&&(i.cWhiteSpace=o.whiteSpace),o.backColor&&(i.cBackColor=o.backColor),o.fontColor&&(i.cFontColor=o.fontColor),o.fontBold&&(i.cFontBold=o.fontBold),o.fontItalic&&(i.cFontItalic=o.fontItalic),o.fontThruline&&(i.cFontThruline=o.fontThruline),o.fontUnderline&&(i.cFontUnderline=o.fontUnderline),l.reConnectedCallbackElement(i),l.reloadGridWithModifyCell(i.gId,i.cIndex),!0},I.setCellData=(e,t,o)=>I.__setCellData(e,t,o),I.getCellData=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);I.__checkColIndex(o);const l=I._getCell(e,o);return I.__getData(l)},I.setCellValue=(e,t,o,r=!1)=>{I.__checkRowIndex(e);const n=I.__getColIndex(t,!0);I.__checkColIndex(n);const i=I._getCell(e,n);return r?l.recodeGridModify(i.gId,l.getRecodesWithModifyValue(i,o,!0)):(i.cValue=l.getValidValue(i,o),l.reConnectedCallbackElement(i),l.reloadGridWithModifyCell(i.gId,i.cIndex)),!0},I.getCellValue=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),l.deepCopy(I._getCell(e,o).cValue)},I.getCellText=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),l.getCellText(I._getCell(e,o))},I.setCellRequired=(e,t,o)=>{I.__checkRowIndex(e);const l=I.__getColIndex(t,!0);if(I.__checkColIndex(l),I.__checkColRownumOrStatus(l),"boolean"!=typeof o)throw new Error("Please insert a boolean type.");const r=I._getCell(e,l);return r.cRequired=o,I.__gridCellReConnectedWithControlSpan(r),!0},I.getCellRequired=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cRequired},I.setCellDataType=(e,t,o)=>{I.__checkRowIndex(e);const r=I.__getColIndex(t,!0);if(I.__checkColIndex(r),I.__checkColRownumOrStatus(r),!l.isIncludeEnum(n,o))throw new Error("Please insert a valid dataType.");const i=I._getCell(e,r);return i.cDataType=o,l.reConnectedCallbackElement(i),l.reloadGridWithModifyCell(w,r),!0},I.getCellDataType=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I.__checkColRownumOrStatus(o),I._getCell(e,o).cDataType},I.setCellLocked=(e,t,o)=>{I.__checkRowIndex(e);const l=I.__getColIndex(t,!0);if(I.__checkColIndex(l),I.__checkColRownumOrStatus(l),"boolean"!=typeof o)throw new Error("Please insert a boolean type.");const r=I._getCell(e,l);return r.cLocked=o,I.__gridCellReConnectedWithControlSpan(r),!0},I.isCellLocked=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cLocked},I.setCellLockedColor=(e,t,o)=>{I.__checkRowIndex(e);const l=I.__getColIndex(t,!0);if(I.__checkColIndex(l),I.__checkColRownumOrStatus(l),"boolean"!=typeof o)throw new Error("Please insert a boolean type.");const r=I._getCell(e,l);return r.cLockedColor=o,I.__gridCellReConnectedWithControlSpan(r),!0},I.isCellLockedColor=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cLockedColor},I.setCellFormat=(e,t,o)=>{I.__checkRowIndex(e);const r=I.__getColIndex(t,!0);if(I.__checkColIndex(r),I.__checkColRownumOrStatus(r),"string"!=typeof o)throw new Error("Please insert a string type.");const n=I._getCell(e,r);return n.cFormat=o,"mask"===n.cDataType&&(n.cValue=l.getValidValue(n,n.cValue)),I.__gridCellReConnectedWithControlSpan(n),l.reloadGridWithModifyCell(w,r),!0},I.getCellFormat=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cFormat},I.setCellCodes=(e,t,o)=>{I.__checkRowIndex(e);const r=I.__getColIndex(t,!0);if(I.__checkColIndex(r),I.__checkColRownumOrStatus(r),!Array.isArray(o))throw new Error("Please insert a vaild codes. (Array)");const n=I._getCell(e,r);return n.cCodes=o,"code"===n.cDataType&&(n.cValue=l.getValidValue(n,n.cValue)),I.__gridCellReConnectedWithControlSpan(n),l.reloadGridWithModifyCell(w,r),!0},I.getCellCodes=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cCodes},I.setCellDefaultCode=(e,t,o)=>{I.__checkRowIndex(e);const r=I.__getColIndex(t,!0);I.__checkColIndex(r),I.__checkColRownumOrStatus(r);const n=I._getCell(e,r);return n.cDefaultCode=o,"code"===n.cDataType&&(n.cValue=l.getValidValue(n,n.cValue)),I.__gridCellReConnectedWithControlSpan(n),l.reloadGridWithModifyCell(w,r),!0},I.getCellDefaultCode=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cDefaultCode},I.setCellMaxLength=(e,t,o)=>{I.__checkRowIndex(e);const r=I.__getColIndex(t,!0);I.__checkColIndex(r),I.__checkColRownumOrStatus(r),o=l.validatePositiveIntegerAndZero(o);const n=I._getCell(e,r);return n.cMaxLength=o,"text"===n.cDataType&&(n.cValue=l.getValidValue(n,n.cValue)),I.__gridCellReConnectedWithControlSpan(n),l.reloadGridWithModifyCell(w,r),!0},I.getCellMaxLength=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cMaxLength},I.setCellMaxByte=(e,t,o)=>{I.__checkRowIndex(e);const r=I.__getColIndex(t,!0);I.__checkColIndex(r),I.__checkColRownumOrStatus(r),o=l.validatePositiveIntegerAndZero(o);const n=I._getCell(e,r);return n.cMaxByte=o,"text"===n.cDataType&&(n.cValue=l.getValidValue(n,n.cValue)),I.__gridCellReConnectedWithControlSpan(n),l.reloadGridWithModifyCell(w,r),!0},I.getCellMaxByte=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cMaxByte},I.setCellMaxNumber=(e,t,o)=>{I.__checkRowIndex(e);const r=I.__getColIndex(t,!0);I.__checkColIndex(r),I.__checkColRownumOrStatus(r),o=l.validateNumber(o);const n=I._getCell(e,r);return n.cMaxNumber=o,"number"===n.cDataType&&(n.cValue=l.getValidValue(n,n.cValue)),I.__gridCellReConnectedWithControlSpan(n),l.reloadGridWithModifyCell(w,r),!0},I.getCellMaxNumber=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cMaxNumber},I.setCellMinNumber=(e,t,o)=>{I.__checkRowIndex(e);const r=I.__getColIndex(t,!0);I.__checkColIndex(r),I.__checkColRownumOrStatus(r),o=l.validateNumber(o);const n=I._getCell(e,r);return n.cMinNumber=o,"number"===n.cDataType&&(n.cValue=l.getValidValue(n,n.cValue)),I.__gridCellReConnectedWithControlSpan(n),l.reloadGridWithModifyCell(w,r),!0},I.getCellMinNumber=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cMinNumber},I.setCellRoundNumber=(e,t,o)=>{I.__checkRowIndex(e);const r=I.__getColIndex(t,!0);I.__checkColIndex(r),I.__checkColRownumOrStatus(r),o=l.validateIntegerAndZero(o);const n=I._getCell(e,r);return n.cRoundNumber=o,"number"===n.cDataType&&(n.cValue=l.getValidValue(n,n.cValue)),I.__gridCellReConnectedWithControlSpan(n),l.reloadGridWithModifyCell(w,r),!0},I.getCellRoundNumber=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cRoundNumber},I.setCellAlign=(e,t,o)=>{I.__checkRowIndex(e);const r=I.__getColIndex(t,!0);if(I.__checkColIndex(r),!l.isIncludeEnum(i,o))throw new Error("Please insert a vaild align. (left, center, right)");const n=I._getCell(e,r);return n.cAlign=o,I.__gridCellReConnectedWithControlSpan(n),!0},I.getCellAlign=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cAlign},I.setCellVerticalAlign=(e,t,o)=>{I.__checkRowIndex(e);const r=I.__getColIndex(t,!0);if(I.__checkColIndex(r),!l.isIncludeEnum(a,o))throw new Error("Please insert a vaild align. (top, center, bottom)");const n=I._getCell(e,r);return n.cVerticalAlign=o,I.__gridCellReConnectedWithControlSpan(n),!0},I.getCellVerticalAlign=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cVerticalAlign},I.setCellOverflowWrap=(e,t,o)=>{I.__checkRowIndex(e);const l=I.__getColIndex(t,!0);I.__checkColIndex(l);const r=I._getCell(e,l);return r.cOverflowWrap=o,I.__gridCellReConnectedWithControlSpan(r),!0},I.getCellOverflowWrap=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cOverflowWrap},I.setCellWordBreak=(e,t,o)=>{I.__checkRowIndex(e);const l=I.__getColIndex(t,!0);I.__checkColIndex(l);const r=I._getCell(e,l);return r.cWordBreak=o,I.__gridCellReConnectedWithControlSpan(r),!0},I.getCellWordBreak=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cWordBreak},I.setCellWhiteSpace=(e,t,o)=>{I.__checkRowIndex(e);const l=I.__getColIndex(t,!0);I.__checkColIndex(l);const r=I._getCell(e,l);return r.cWhiteSpace=o,I.__gridCellReConnectedWithControlSpan(r),!0},I.getCellWhiteSpace=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cWhiteSpace},I.setCellVisible=(e,t,o)=>{I.__checkRowIndex(e);const l=I.__getColIndex(t,!0);if(I.__checkColIndex(l),"boolean"!=typeof o)throw new Error("Please insert a boolean type.");const r=I._getCell(e,l);return o?r.firstChild&&r.firstChild.style.removeProperty("display"):r.firstChild&&(r.firstChild.style.display="none"),I.__gridCellReConnectedWithControlSpan(r),!0},I.isCellVisible=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);I.__checkColIndex(o);const l=I._getCell(e,o);return l.firstChild&&l.firstChild.style.display,!1},I.setCellBackColor=(e,t,o)=>{I.__checkRowIndex(e);const r=I.__getColIndex(t,!0);if(I.__checkColIndex(r),"#000"!==o&&"#000000"!==o&&"#000000"===l.getHexColorFromColorName(o))throw new Error("Please enter the correct hexadecimal color. (#ffffff)");const n=I._getCell(e,r);return n.cBackColor=o,I.__gridCellReConnectedWithControlSpan(n),!0},I.getCellBackColor=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cBackColor},I.setCellFontColor=(e,t,o)=>{I.__checkRowIndex(e);const r=I.__getColIndex(t,!0);if(I.__checkColIndex(r),"#000"!==o&&"#000000"!==o&&"#000000"===l.getHexColorFromColorName(o))throw new Error("Please enter the correct hexadecimal color. (#ffffff)");const n=I._getCell(e,r);return n.cFontColor=o,I.__gridCellReConnectedWithControlSpan(n),!0},I.getCellFontColor=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cFontColor},I.setCellFontBold=(e,t,o)=>{I.__checkRowIndex(e);const l=I.__getColIndex(t,!0);if(I.__checkColIndex(l),"boolean"!=typeof o)throw new Error("Please insert a boolean type.");const r=I._getCell(e,l);return r.cFontBold=o,I.__gridCellReConnectedWithControlSpan(r),!0},I.isCellFontBold=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cFontBold},I.setCellFontItalic=(e,t,o)=>{I.__checkRowIndex(e);const l=I.__getColIndex(t,!0);if(I.__checkColIndex(l),"boolean"!=typeof o)throw new Error("Please insert a boolean type.");const r=I._getCell(e,l);return r.cFontItalic=o,I.__gridCellReConnectedWithControlSpan(r),!0},I.isCellFontItalic=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cFontItalic},I.setCellFontThruline=(e,t,o)=>{I.__checkRowIndex(e);const l=I.__getColIndex(t,!0);if(I.__checkColIndex(l),"boolean"!=typeof o)throw new Error("Please insert a boolean type.");const r=I._getCell(e,l);return r.cFontThruline=o,I.__gridCellReConnectedWithControlSpan(r),!0},I.isCellFontThruline=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cFontThruline},I.setCellFontUnderline=(e,t,o)=>{I.__checkRowIndex(e);const l=I.__getColIndex(t,!0);if(I.__checkColIndex(l),"boolean"!=typeof o)throw new Error("Please insert a boolean type.");const r=I._getCell(e,l);return r.cFontUnderline=o,I.__gridCellReConnectedWithControlSpan(r),!0},I.isCellFontUnderline=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);return I.__checkColIndex(o),I._getCell(e,o).cFontUnderline},I.setTargetCell=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);I.__checkColIndex(o);const r=I._getCell(e,o);return!!l.isCellVisible(r)&&(l.activeGrid=I,l.selectCell(r))},I.getTargetRow=()=>I.variables._targetCell?I.variables._targetCell.row:null,I.getTargetCol=()=>I.variables._targetCell?I.variables._targetCell.cId:null,I.setActiveCells=(e,t,o,r)=>{I.__checkRowIndex(e),I.__checkRowIndex(o);const n=I.__getColIndex(t,!0),i=I.__getColIndex(r,!0);I.__checkColIndex(n),I.__checkColIndex(i);const a=I._getCell(e,n),s=I._getCell(o,i);return!!l.isCellVisible(a)&&(!!l.isCellVisible(s)&&(l.activeGrid=I,I.variables._targetCell=a,l.unselectCells(I.gId),l.selectCells(a,s,a)))},I.getActiveRows=()=>I.variables._activeRows,I.getActiveCols=()=>{const e=[];return I.variables._activeCols.forEach((t=>{e.push(I.__getColInfo(t).cId)})),e},I.getActiveRange=()=>{const e={startRow:null,startColId:null,endRow:null,endColId:null},t=I.variables._activeCells;return t.length>0&&(e.startRow=t[0].row,e.startColId=t[0].cId,e.endRow=t[t.length-1].row,e.endColId=t[t.length-1].cId),e},I.editCell=(e,t)=>{I.__checkRowIndex(e);const o=I.__getColIndex(t,!0);I.__checkColIndex(o),I.__checkColRownumOrStatus(o);const r=I._getCell(e,t);if(!(["select","checkbox","button","link"].indexOf(r.cDataType)>=0)&&I.setTargetCell(e,t))return l.createGridEditor(r),!0},I.redo=()=>l.redoundo(w),I.undo=()=>l.redoundo(w,!1),I._getDataTypeStyle=()=>{const e={};return Object.keys(t.dataType).forEach((o=>{t.dataType[o].cellStyle&&(e[o]=t.dataType[o].cellStyle)})),e},I._getFilterSpan=()=>t.filterSpan,I._getFooterFormula=()=>l.deepCopy(t.footerFormula),I.removeGridMethod=()=>{delete window[w]},I._getHeader=()=>v,I._getBody=()=>p,I._getFooter=()=>y,I.__loadHeader(),I.__loadFooter();const A={};Object.keys(I).forEach((e=>{"function"!=typeof I[e]||e.startsWith("__")||(A[e]=(...t)=>I[e](...t))})),l.deepFreeze(A),window[w]=A,e[w]=A,I.variables={},I.variables._activeRows=[],I.variables._activeCols=[],I.variables._activeCells=[],I.variables._targetCell=null,I.variables._recodes=[],I.variables._recodeseq=0,I.variables._sortToggle={},I.variables._filters=[],I.variables._isDrawable=!0,v.addEventListener("dblclick",(function(e){if(l.onHeaderDragging)return;let o;if("ghd"===e.target.gType)o=e.target;else{if("sort"!==e.target.gType)return;o=e.target.parentNode}if(!1===l.doEventWithCheckChanged(o.gId,"_onBeforeDblClickHeader",o.row,o.cId))return e.stopPropagation(),void e.preventDefault();if("checkbox"===e.target.cDataType&&I.info.gAllCheckable&&o.isLastCell)return void I.setColSameValue(e.target.cIndex,!l.getCheckboxCellTrueOrFalse(I._getCell(1,e.target.cIndex)),!0);if(!I.info.gSortable)return;if(!I.__getColInfo(o.cId).cSortable)return;if(!o.isLastCell)return;I.sort(o.cId,!I.variables._sortToggle[o.cId]);let r;o.parentNode.querySelectorAll("."+o.gId+"_sortSpan").forEach((e=>{e.parentNode.removeChild(e)})),I.variables._sortToggle[o.cId]?t.sortAscSpan&&t.sortAscSpan instanceof HTMLElement&&1===t.sortAscSpan.nodeType?r=t.sortAscSpan.cloneNode(!0):(r=document.createElement("span"),r.style.fontSize="0.5em",r.style.paddingLeft="5px",r.innerText="▲"):t.sortDescSpan&&t.sortDescSpan instanceof HTMLElement&&1===t.sortDescSpan.nodeType?r=t.sortDescSpan.cloneNode(!0):(r=document.createElement("span"),r.style.fontSize="0.5em",r.style.paddingLeft="5px",r.innerText="▼"),r.gId=o.gId,r.isChild=!0,r.gType="sort",r.classList.add(o.gId+"_sortSpan"),r.classList.add(I.variables._sortToggle[o.cId]?o.gId+"_ascSpan":o.gId+"_descSpan"),o.append(r),l.doEventWithCheckChanged(o.gId,"_onAfterDblClickHeader",o.row,o.cId)})),v.addEventListener("click",(function(e){let t;if("ghd"===e.target.gType){if(t=e.target,!1===l.doEventWithCheckChanged(t.gId,"_onBeforeClickHeader",t.row,t.cId))return e.stopPropagation(),void e.preventDefault();l.doEventWithCheckChanged(t.gId,"_onAfterClickHeader",t.row,t.cId)}else if("filter"===e.target.gType){if(t=e.target.parentNode,!1===l.doEventWithCheckChanged(t.gId,"_onClickFilter",t.row,t.cId,e.target))return e.stopPropagation(),void e.preventDefault();const o=t.parentNode.querySelectorAll("."+t.gId+"_filterSelect"),r=e.target.querySelectorAll("."+t.gId+"_filterSelect")[0];o.forEach((e=>{r!==e&&"ALL"===e.value&&(e.style.display="none")})),"none"===r.style.display?r.style.display="block":r.style.display="none"}})),p.addEventListener("mousemove",(function(e){l.isDragging&&(l.mouseX=e.clientX,l.mouseY=e.clientY)})),p.addEventListener("mouseleave",(function(e){if(l.isDragging){const t=e.clientX,o=e.clientY,r=t-l.mouseX,n=o-l.mouseY;let i="";i=Math.abs(r)>Math.abs(n)?r>0?"right":"left":n>0?"down":"up",l.startScrolling(e.target.gId,i)}})),p.addEventListener("mouseenter",(function(e){l.scrollInterval&&l.stopScrolling()})),p.addEventListener("dblclick",(function(e){let t;t="gbdv"===e.target.gType?e.target.parentNode:e.target,"gbd"===t.gType&&!1!==l.doEventWithCheckChanged(t.gId,"_onBeforeDblClickCell",t.row,t.cId)&&(["select","checkbox","button","link"].indexOf(t.cDataType)>=0||(l.createGridEditor(t),l.doEventWithCheckChanged(t.gId,"_onAfterDblClickCell",t.row,t.cId)))})),I.addEventListener("click",(function(e){if(!e.target.gType)return;let o;if(o="gbdv"===e.target.gType?e.target.parentNode:e.target,o&&!o.cUntarget&&"gbd"===o.gType){if(o.firstChild&&"select"!==o.firstChild.nType&&!1===l.doEventWithCheckChanged(o.gId,"_onBeforeClickCell",o.row,o.cId))return e.stopPropagation(),void e.preventDefault();if(e.target.nType)switch(e.target.nType){case"checkbox":if(!1===l.doEventWithCheckChanged(o.gId,"_onClickCheckbox",o.row,o.cId,e.target))return e.stopPropagation(),void e.preventDefault();l.editOldValue=e.target.parentNode.cValue;break;case"button":if(!1===l.doEventWithCheckChanged(o.gId,"_onClickButton",o.row,o.cId,e.target))return e.stopPropagation(),void e.preventDefault();break;case"link":if(!1===l.doEventWithCheckChanged(o.gId,"_onClickLink",o.row,o.cId,e.target))return e.stopPropagation(),void e.preventDefault()}Object.keys(t.dataType).forEach((l=>{if(o.cDataType===l&&t.dataType[l].onClick){if("function"!=typeof t.dataType[l].onClick)throw new Error("onClick must be a function.");if(!1===t.dataType[l].onClick(e,I.__getData(o)))return}})),l.doEventWithCheckChanged(o.gId,"_onAfterClickCell",o.row,o.cId)}})),I.addEventListener("mousedown",(function(e){if(!e.target.gType)return;let o;if(o="gbdv"===e.target.gType?e.target.parentNode:e.target,!o.cUntarget&&"gbd"===o.gType){if(e.target.nType&&"select"===e.target.nType){if(!1===l.doEventWithCheckChanged(o.gId,"_onBeforeClickCell",o.row,o.cId))return e.stopPropagation(),void e.preventDefault();if(!1===l.doEventWithCheckChanged(o.gId,"_onClickSelect",o.row,o.cId,e.target))return e.stopPropagation(),void e.preventDefault();l.editOldValue=e.target.value}Object.keys(t.dataType).forEach((l=>{if(o.cDataType===l&&t.dataType[l].onMousedown){if("function"!=typeof t.dataType[l].onMousedown)throw new Error("onMousedown must be a function.");if(!1===t.dataType[l].onMousedown(e,I.__getData(o)))return}})),l.activeGrid=this,l.isDragging=!0,"range"===this.info.gSelectionPolicy&&e.shiftKey&&this.variables._targetCell?(l.unselectCells(this.gId),l.selectCells(this.variables._targetCell,o)):l.selectCell(o)}})),I.addEventListener("mousemove",(function(e){let t;"gbdv"===e.target.gType?t=e.target.parentNode:"gbd"===e.target.gType&&(t=e.target),t&&"range"===this.info.gSelectionPolicy&&l.mouseoverCell!==t&&(l.mouseoverCell=t,l.isDragging&&this.variables._targetCell&&(l.unselectCells(this.gId),l.selectCells(this.variables._targetCell,t)))})),I.addEventListener("mouseleave",(function(e){"range"===this.info.gSelectionPolicy&&(l.mouseoverCell=null,l.isDragging&&(l.isDragging=!1))})),l[w]=I,I.append(v),I.append(p),I.append(y),s.append(I),I.events={},window[w+"_onActiveCell"]||(window[w+"_onActiveCell"]=(e,t)=>!0),I.events[w+"_onActiveCell"]=window[w+"_onActiveCell"],window[w+"_onActiveCells"]||(window[w+"_onActiveCells"]=(e,t,o,l)=>!0),I.events[w+"_onActiveCells"]=window[w+"_onActiveCells"],window[w+"_onActiveRow"]||(window[w+"_onActiveRow"]=e=>!0),I.events[w+"_onActiveRow"]=window[w+"_onActiveRow"],window[w+"_onActiveRows"]||(window[w+"_onActiveRows"]=(e,t)=>!0),I.events[w+"_onActiveRows"]=window[w+"_onActiveRows"],window[w+"_onActiveCol"]||(window[w+"_onActiveCol"]=e=>!0),I.events[w+"_onActiveCol"]=window[w+"_onActiveCol"],window[w+"_onActiveCols"]||(window[w+"_onActiveCols"]=(e,t)=>!0),I.events[w+"_onActiveCols"]=window[w+"_onActiveCols"],window[w+"_onBeforeChange"]||(window[w+"_onBeforeChange"]=(e,t,o,l)=>!0),I.events[w+"_onBeforeChange"]=window[w+"_onBeforeChange"],window[w+"_onAfterChange"]||(window[w+"_onAfterChange"]=(e,t,o,l)=>!0),I.events[w+"_onAfterChange"]=window[w+"_onAfterChange"],window[w+"_onBeforeClickCell"]||(window[w+"_onBeforeClickCell"]=(e,t)=>!0),I.events[w+"_onBeforeClickCell"]=window[w+"_onBeforeClickCell"],window[w+"_onAfterClickCell"]||(window[w+"_onAfterClickCell"]=(e,t)=>!0),I.events[w+"_onAfterClickCell"]=window[w+"_onAfterClickCell"],window[w+"_onClickSelect"]||(window[w+"_onClickSelect"]=(e,t,o)=>!0),I.events[w+"_onClickSelect"]=window[w+"_onClickSelect"],window[w+"_onClickCheckbox"]||(window[w+"_onClickCheckbox"]=(e,t,o)=>!0),I.events[w+"_onClickCheckbox"]=window[w+"_onClickCheckbox"],window[w+"_onClickButton"]||(window[w+"_onClickButton"]=(e,t,o)=>!0),I.events[w+"_onClickButton"]=window[w+"_onClickButton"],window[w+"_onClickLink"]||(window[w+"_onClickLink"]=(e,t,o)=>!0),I.events[w+"_onClickLink"]=window[w+"_onClickLink"],window[w+"_onBeforeDblClickCell"]||(window[w+"_onBeforeDblClickCell"]=(e,t)=>!0),I.events[w+"_onBeforeDblClickCell"]=window[w+"_onBeforeDblClickCell"],window[w+"_onAfterDblClickCell"]||(window[w+"_onAfterDblClickCell"]=(e,t)=>!0),I.events[w+"_onAfterDblClickCell"]=window[w+"_onAfterDblClickCell"],window[w+"_onBeforeClickHeader"]||(window[w+"_onBeforeClickHeader"]=(e,t)=>!0),I.events[w+"_onBeforeClickHeader"]=window[w+"_onBeforeClickHeader"],window[w+"_onAfterClickHeader"]||(window[w+"_onAfterClickHeader"]=(e,t)=>!0),I.events[w+"_onAfterClickHeader"]=window[w+"_onAfterClickHeader"],window[w+"_onBeforeDblClickHeader"]||(window[w+"_onBeforeDblClickHeader"]=(e,t)=>!0),I.events[w+"_onBeforeDblClickHeader"]=window[w+"_onBeforeDblClickHeader"],window[w+"_onAfterDblClickHeader"]||(window[w+"_onAfterDblClickHeader"]=(e,t)=>!0),I.events[w+"_onAfterDblClickHeader"]=window[w+"_onAfterDblClickHeader"],window[w+"_onEditEnter"]||(window[w+"_onEditEnter"]=(e,t,o)=>!0),I.events[w+"_onEditEnter"]=window[w+"_onEditEnter"],window[w+"_onEditEnding"]||(window[w+"_onEditEnding"]=(e,t,o,l)=>!0),I.events[w+"_onEditEnding"]=window[w+"_onEditEnding"],window[w+"_onClickFilter"]||(window[w+"_onClickFilter"]=(e,t,o)=>!0),I.events[w+"_onClickFilter"]=window[w+"_onClickFilter"],window[w+"_onChooseFilter"]||(window[w+"_onChooseFilter"]=(e,t,o,l)=>!0),I.events[w+"_onChooseFilter"]=window[w+"_onChooseFilter"],window[w+"_onPaste"]||(window[w+"_onPaste"]=(e,t,o)=>!0),I.events[w+"_onPaste"]=window[w+"_onPaste"],window[w+"_onCopy"]||(window[w+"_onCopy"]=(e,t,o,l)=>!0),I.events[w+"_onCopy"]=window[w+"_onCopy"],window[w+"_onResize"]||(window[w+"_onResize"]=e=>!0),I.events[w+"_onResize"]=window[w+"_onResize"],window[w+"_onKeydownEditor"]||(window[w+"_onKeydownEditor"]=e=>!0),I.events[w+"_onKeydownEditor"]=window[w+"_onKeydownEditor"],window[w+"_onInputEditor"]||(window[w+"_onInputEditor"]=e=>!0),I.events[w+"_onInputEditor"]=window[w+"_onInputEditor"],window[w+"_onKeydownGrid"]||(window[w+"_onKeydownGrid"]=e=>!0),I.events[w+"_onKeydownGrid"]=window[w+"_onKeydownGrid"],Object.freeze(I.events),I._getGridCssStyle=()=>{const e={};return e["."+w+"_vanillagrid"]={width:I.cssInfo.width,height:I.cssInfo.height,display:I.info.gVisible?"block":"none",border:"1px solid "+I.cssInfo.gridBorderColor,overflow:"auto","background-color":"#fff",margin:I.cssInfo.margin,padding:I.cssInfo.padding,"font-family":I.cssInfo.gridFontFamily},e["."+w+"_v-g"]={"background-color":I.cssInfo.bodyBackColor,display:"flex",position:"relative","flex-direction":"column",height:"100%","overflow-x":"auto","overflow-y":"auto","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"},e["."+w+"_v-g-h"]={position:"-webkit-sticky",position:"sticky",top:"0","z-index":"250",display:I.info.gHeaderVisible?"grid":"none"},e["."+w+"_v-g-b"]={"margin-bottom":"22px",display:"grid",position:"relative"},e["."+w+"_v-g-f"]={position:"-webkit-sticky",position:"sticky",bottom:"0","z-index":"250",display:"grid","margin-top":"auto"},e["."+w+"_h-v-g-d"]={"background-color":I.cssInfo.headerCellBackColor,"justify-content":"center","text-align":"center","align-items":I.cssInfo.verticalAlign,"border-bottom":I.cssInfo.horizenBorderSize+"px solid "+I.cssInfo.headerCellBorderColor,"border-right":I.cssInfo.verticalBorderSize+"px solid "+I.cssInfo.headerCellBorderColor,color:I.cssInfo.headerCellFontColor},e["."+w+"_h-v-g-d select"]={color:"#333"},e["."+w+"_h-v-g-d option"]={color:"#333"},e["."+w+"_b-v-g-d"]={"align-items":I.cssInfo.verticalAlign,"background-color":I.cssInfo.bodyCellBackColor,"border-bottom":I.cssInfo.horizenBorderSize+"px solid "+I.cssInfo.bodyCellBorderColor,"border-right":I.cssInfo.verticalBorderSize+"px solid "+I.cssInfo.bodyCellBorderColor,color:I.cssInfo.bodyCellFontColor},e["."+w+"_f-v-g-d"]={"justify-content":"center","text-align":"center","align-items":I.cssInfo.verticalAlign,"background-color":I.cssInfo.footerCellBackColor,"border-top":I.cssInfo.horizenBorderSize+"px solid "+I.cssInfo.footerCellBorderColor,color:I.cssInfo.footerCellFontColor},e["."+w+"_f-v-g-d-value"]={"border-right":I.cssInfo.verticalBorderSize+"px solid "+I.cssInfo.bodyCellBorderColor},e["."+w+"_b-v-g-d-alter"]={"align-items":I.cssInfo.verticalAlign,"background-color":I.cssInfo.alterRowBackColor,"border-bottom":I.cssInfo.horizenBorderSize+"px solid "+I.cssInfo.bodyCellBorderColor,"border-right":I.cssInfo.verticalBorderSize+"px solid "+I.cssInfo.bodyCellBorderColor,color:I.cssInfo.alterRowFontColor},e["."+w+"_b-v-g-d-locked"]={"background-color":I.cssInfo.lockCellBackColor,"border-bottom":I.cssInfo.horizenBorderSize+"px solid "+I.cssInfo.bodyCellBorderColor,"border-right":I.cssInfo.verticalBorderSize+"px solid "+I.cssInfo.bodyCellBorderColor,color:I.cssInfo.lockCellFontColor},e["."+w+"_v-g-d"]={"font-size":I.cssInfo.cellFontSize,display:"flex","min-height":I.cssInfo.cellMinHeight,overflow:"hidden","white-space":"nowrap","padding-left":"5px","padding-right":"5px"},I.cssInfo.overflowWrap&&(e["."+w+"_v-g-d"]["overflow-wrap"]=I.cssInfo.overflowWrap),I.cssInfo.wordBreak&&(e["."+w+"_v-g-d"]["word-break"]=I.cssInfo.wordBreak),I.cssInfo.whiteSpace&&(e["."+w+"_v-g-d"]["white-space"]=I.cssInfo.whiteSpace),e["."+w+"_editor"]={"font-size":I.cssInfo.cellFontSize,"background-color":I.cssInfo.editorBackColor,border:"none",color:I.cssInfo.editorFontColor,overflow:"hidden",resize:"none","box-sizing":"border-box","font-family":I.cssInfo.gridFontFamily,"text-align":"inherit"},e["."+w+"_editor:focus"]={outline:"none"},e["."+w+"_mouseover-cell"]={"background-color":I.cssInfo.mouseoverCellBackColor+" !important",color:I.cssInfo.mouseoverCellFontColor+" !important"},e["."+w+"_selected-cell"]={"background-color":I.cssInfo.selectCellBackColor+" !important",color:I.cssInfo.selectCellFontColor+" !important"},e["."+w+"_selected-col"]={"background-color":I.cssInfo.selectColBackColor,color:I.cssInfo.selectColFontColor},e["."+w+"_selected-row"]={"background-color":I.cssInfo.selectRowBackColor,color:I.cssInfo.selectRowFontColor},e["."+w+"_filterSpan"]={display:"block","font-size":"0.8em","padding-right":"8px",cursor:"pointer"},e["."+w+"_filterSelect"]={position:"absolute","z-index":"300",margin:"5px"},e["."+w+"_data-value-select"]={"font-size":I.cssInfo.cellFontSize,cursor:"pointer",border:"none",background:"none",color:"inherit"},e["."+w+"_data-value-select:focus"]={outline:"none"},e["."+w+"_data-value-checkbox"]={cursor:"pointer"},e["."+w+"_data-value-button"]={"min-width":"95%",height:.85*l.extractNumberAndUnit(I.cssInfo.cellMinHeight).number+"px","line-height":.85*l.extractNumberAndUnit(I.cssInfo.cellMinHeight).number+"px","font-size":I.cssInfo.cellFontSize,cursor:"pointer",border:"none",color:I.cssInfo.buttonFontColor,"background-color":I.cssInfo.buttonBackColor,"box-shadow":"0.75px 0.75px 1px 0.25px "+I.cssInfo.buttonBorderColor},e["."+w+"_data-value-button:hover"]={color:I.cssInfo.buttonHoverFontColor,"background-color":I.cssInfo.buttonHoverBackColor},e["."+w+"_data-value-button:active"]={color:I.cssInfo.buttonActiveFontColor,"background-color":I.cssInfo.buttonActiveBackColor,"box-shadow":"0px 0px 0.5px 0.25px "+I.cssInfo.buttonBorderColor},e["."+w+"_data-value-button:focus"]={outline:"none"},e["."+w+"_data-value-button:disabled"]={opacity:"0.7"},e["."+w+"_data-value-link"]={color:I.cssInfo.linkFontColor,"text-decoration":I.cssInfo.linkHasUnderLine?"underline":"none"},e["."+w+"_data-value-link:visited"]={color:I.cssInfo.linkVisitedFontColor},e["."+w+"_data-value-link:hover"]={color:I.cssInfo.linkHoverFontColor+" !important"},e["."+w+"_data-value-link:active"]={color:I.cssInfo.linkActiveFontColor+" !important"},e["."+w+"_data-value-link:focus"]={color:I.cssInfo.linkFocusFontColor+" !important"},e},I._setGridCssStyle=()=>{let e="";const t=I._getGridCssStyle(),o=Object.keys(t);for(let r=0;r<o.length;r++)e=e+o[r]+" {"+l.getCssTextFromObject(t[o[r]])+"}\n";let r=document.getElementById(w+"_styles-sheet");r?(l.removeAllChild(r),r.appendChild(document.createTextNode(e))):(r=document.createElement("style"),r.setAttribute("id",w+"_styles-sheet"),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(r))},I._setGridCssStyle()}t._docEvent_mousedown=function(e){l.activeGridEditor&&l.activeGridEditor!==e.target&&l.modifyCell(),l.activeGrid&&!l.activeGrid.contains(e.target)&&(l.activeGrid=null)},document.removeEventListener("mousedown",t._docEvent_mousedown),document.addEventListener("mousedown",t._docEvent_mousedown),t._docEvent_mouseup=function(e){l.mouseX=0,l.mouseY=0,l.stopScrolling(),l.isDragging&&(l.isDragging=!1),l.isHeaderDragging&&(l.isHeaderDragging=!1)},document.removeEventListener("mouseup",t._docEvent_mouseup),document.addEventListener("mouseup",t._docEvent_mouseup),t._docEvent_keydown=function(e){if(l.activeGrid&&!l.activeGridEditor){const o=l.activeGrid,r=o.gId;if(!1===l.doEventWithCheckChanged(r,"_onKeydownGrid",e))return e.stopPropagation(),void e.preventDefault();if(e.ctrlKey||e.metaKey)switch(e.key){case"z":case"Z":l.redoundo(r),e.preventDefault();break;case"y":case"Y":l.redoundo(r,!1),e.preventDefault();break;case"a":case"A":o.variables._targetCell=o._getCell(1,3),l.selectCells(o._getCell(1,1),o._getCell(o.getRowCount(),o.getColCount())),e.preventDefault()}if("none"===o.info.gSelectionPolicy||o.variables._activeCells.length<=0)return;const n=o.variables._activeCells[0],i=o.variables._activeCells[o.variables._activeCells.length-1];let a;switch(Object.keys(t.dataType).forEach((l=>{if(o.variables._targetCell.cDataType===l&&t.dataType[l].onSelectedAndKeyDown){if("function"!=typeof t.dataType[l].onSelectedAndKeyDown)throw new Error("onSelectedAndKeyDown must be a function.");if(!1===t.dataType[l].onSelectedAndKeyDown(e,o.__getData(o.variables._targetCell)))return}})),e.key){case"Tab":a=l.getTabCell(o.variables._targetCell,e.shiftKey),l.selectCell(a),e.preventDefault();break;case"F2":l.createGridEditor(o.variables._targetCell),e.preventDefault();break;case"Enter":"select"===o.variables._targetCell.cDataType?(l.editOldValue=o.variables._targetCell.firstChild.value,o.variables._targetCell.firstChild.focus()):"checkbox"===o.variables._targetCell.cDataType?(l.editOldValue=o.variables._targetCell.cValue,o.variables._targetCell.firstChild.checked=!o.variables._targetCell.firstChild.checked,l.selectAndCheckboxOnChange(o.variables._targetCell.firstChild),a=l.getMoveRowCell(o.variables._targetCell,1),l.selectCell(a),e.preventDefault()):["text","number","date","month","mask","code"].indexOf(o.variables._targetCell.cDataType)>=0&&(l.createGridEditor(o.variables._targetCell,!0),e.preventDefault());break;case" ":if("select"===o.variables._targetCell.cDataType){if(o.variables._targetCell.cUntarget||o.variables._targetCell.cLocked)return void e.preventDefault();l.editOldValue=o.variables._targetCell.firstChild.value,o.variables._targetCell.firstChild.focus()}else if("button"===o.variables._targetCell.cDataType)o.variables._targetCell.firstChild.focus();else if("checkbox"===o.variables._targetCell.cDataType){if(o.variables._targetCell.cUntarget||o.variables._targetCell.cLocked)return void e.preventDefault();l.editOldValue=o.variables._targetCell.cValue,o.variables._targetCell.firstChild.checked=!o.variables._targetCell.firstChild.checked,l.selectAndCheckboxOnChange(o.variables._targetCell.firstChild),e.preventDefault()}else["text","number","date","month","mask","code"].indexOf(o.variables._targetCell.cDataType)>=0&&(l.createGridEditor(o.variables._targetCell),e.preventDefault());break;case"ArrowUp":"range"===o.info.gSelectionPolicy&&e.shiftKey?(l.unselectCells(r),o.variables._targetCell.row>=i.row?(a=l.getMoveRowCell(n,-1),l.selectCells(a,i,a)):(a=l.getMoveRowCell(i,-1),l.selectCells(n,a))):(a=l.getMoveRowCell(o.variables._targetCell,-1),l.selectCell(a)),e.preventDefault();break;case"ArrowDown":"range"===o.info.gSelectionPolicy&&e.shiftKey?(l.unselectCells(r),o.variables._targetCell.row<=n.row?(a=l.getMoveRowCell(i,1),l.selectCells(n,a)):(a=l.getMoveRowCell(n,1),l.selectCells(a,i,a))):(a=l.getMoveRowCell(o.variables._targetCell,1),l.selectCell(a)),e.preventDefault();break;case"ArrowLeft":"range"===o.info.gSelectionPolicy&&e.shiftKey?(l.unselectCells(r),o.variables._targetCell.col>=i.col?(a=l.getMoveColCell(n,-1),l.selectCells(a,i,a)):(a=l.getMoveColCell(i,-1),l.selectCells(n,a))):(a=l.getMoveColCell(o.variables._targetCell,-1),l.selectCell(a)),e.preventDefault();break;case"ArrowRight":"range"===o.info.gSelectionPolicy&&e.shiftKey?(l.unselectCells(r),o.variables._targetCell.col<=n.col?(a=l.getMoveColCell(i,1),l.selectCells(n,a)):(a=l.getMoveColCell(n,1),l.selectCells(a,i,a))):(a=l.getMoveColCell(o.variables._targetCell,1),l.selectCell(a)),e.preventDefault()}}},document.removeEventListener("keydown",t._docEvent_keydown),document.addEventListener("keydown",t._docEvent_keydown),t._docEvent_copy=function(e){if(l.activeGrid&&!l.activeGridEditor){const t=l[l.activeGrid.gId].variables._activeCells;t.length>0&&(e.preventDefault(),l.copyGrid(t))}},document.removeEventListener("copy",t._docEvent_copy),document.addEventListener("copy",t._docEvent_copy),t._docEvent_paste=function(e){l.activeGrid&&!l.activeGridEditor&&l[l.activeGrid.gId].variables._activeCells.length>0&&(e.preventDefault(),l.pasteGrid(e,l.activeGrid))},document.removeEventListener("paste",t._docEvent_paste),document.addEventListener("paste",t._docEvent_paste),t._VanillaGrid=class extends HTMLElement{constructor(){super()}connectedCallback(){}},customElements.get("v-g")||customElements.define("v-g",t._VanillaGrid),t._GridHeader=class extends HTMLElement{constructor(){super()}connectedCallback(){if(!this.style.gridTemplateColumns.includes("%")){const e=window[this.gId];let t=0;for(let o=1;o<e.getColCount();o++)t+=l.extractNumberAndUnit(e.getColOriginWidth(o)).number;this.style.width=t+"px"}}},customElements.get("v-g-h")||customElements.define("v-g-h",t._GridHeader),t._GridBody=class extends HTMLElement{constructor(){super()}connectedCallback(){if(!this.style.gridTemplateColumns.includes("%")){const e=window[this.gId];let t=0;for(let o=1;o<e.getColCount();o++)t+=l.extractNumberAndUnit(e.getColOriginWidth(o)).number;this.style.width=t+"px"}}},customElements.get("v-g-b")||customElements.define("v-g-b",t._GridBody),t._GridFooter=class extends HTMLElement{constructor(){super()}connectedCallback(){if(!this.style.gridTemplateColumns.includes("%")){const e=window[this.gId];let t=0;if(!e._getFooterCells()||e._getFooterCells().length<=0)return;for(let o=1;o<e.getColCount();o++)t+=l.extractNumberAndUnit(e.getColOriginWidth(o)).number;this.style.width=t+"px"}}},customElements.get("v-g-f")||customElements.define("v-g-f",t._GridFooter),t._GridData=class extends HTMLElement{constructor(){super()}connectedCallback(){const e=window[this.gId],t=e.getGridInfo();function o(e){if(null==e)return"";const t=(e=""+e.trim()).match(/^(\d+)(\D*)$/);if(t){const e=""===t[2]?"px":t[2];return{number:parseInt(t[1],10),unit:e}}return""}function r(e){if(e)return!(!1===e.cColVisible||!1===e.cRowVisible||!0===e.cFilter)}function n(e){const t=Number(e);return isNaN(t)?null:t}function i(e){const t=Number(e);return isNaN(t)?0:t}function a(e,t){let o,l;for(let i=1;i<e.getRowCount();i++)if(l=e._getCell(i,t.col),r(l)&&(o=n(l.cValue),o))return o;return null}switch(this.style.removeProperty("display"),this.style.removeProperty("align-items"),this.style.removeProperty("justify-content"),this.style.removeProperty("text-align"),this.style.removeProperty("z-index"),this.gType){case"ghd":if(this.innerText=this.cValue,t.frozenRowCount<=0&&this.col<=t.frozenColCount){let t,o=0;for(let l=this.col-1;l>0;l--)if(t=e._getHeaderCell(this.row,l),t)if(t.rowMerge){let t=this.row-1,r=e._getHeaderCell(t,l);for(;r&&!(t<0)&&r.rowMerge;)t--,r=e._getHeaderCell(t,l);o+=r.offsetWidth}else o+=e._getHeaderCell(this.row,l).offsetWidth;else o+=0;this.style.position="sticky",this.style.zIndex=String(300+e.getColCount()-this.col),this.style.left=o+"px",this.frozenCol=!0}if(this.rowMerge){let t=this.row-1,o=e._getHeaderCell(t,this.col);for(;o&&!(t<0);){if(!o.rowMerge){o.style.gridRowEnd=this.style.gridRowEnd,o.rowSpan=o.rowSpan?o.rowSpan+1:1,o.style.zIndex=o.style.zIndex?o.style.zIndex:"250";break}t--,o=e._getHeaderCell(t,this.col)}this.style.display="none"}if(this.colMerge){let t=this.col-1,l=e._getHeaderCell(this.row,t);for(;l&&!(t<0);){if(!l.colMerge){if("v-g-rownum"===l.cId||"v-g-status"===l.cId)break;l.style.gridColumnEnd=this.style.gridColumnEnd,l.style.width=o(l.style.width).number+this.offsetWidth+"px",l.colSpan=l.colSpan?l.colSpan+1:1,l.style.zIndex=l.style.zIndex?l.style.zIndex:"250";break}t--,l=e._getHeaderCell(this.row,t)}this.style.display="none"}if(this.cColVisible&&this.cRowVisible||(this.style.display="none"),e.getHeaderRowCount()===this.row){let t=this;if(this.rowMerge)for(let o=this.row-1;o>0&&(t=e._getHeaderCell(o,this.col),!t.rowSpan);o--);t&&(t.isLastCell=!0)}if(!0===t.filterable&&e.getColInfo(this.cId).filterable&&e.getHeaderRowCount()===this.row&&"v-g-rownum"!==this.cId&&"v-g-status"!==this.cId){let t;const o=e._getFilterSpan();o&&o instanceof HTMLElement&&1===o.nodeType?t=o.cloneNode(!0):(t=document.createElement("span"),t.innerText="σ"),t.gId=this.gId,t.isChild=!0,t.gType="filter",t.classList.add(this.gId+"_filterSpan");const l=document.createElement("select");l.classList.add(this.gId+"_filterSelect"),l.style.display="none",l.gId=this.gId,l.cId=this.cId,l.addEventListener("mousedown",(function(e){this.filterOldValue=e.target.value})),l.addEventListener("change",(function(t){const o=t.target.value;if(!1===window[t.target.parentNode.parentNode.gId+"_onChooseFilter"](t.target.parentNode.parentNode.row,t.target.parentNode.parentNode.cId,this.filterOldValue,o))return t.stopPropagation(),void t.preventDefault();e._doFilter(),"$$ALL"===o&&(this.style.display="none")})),t.append(l);let r=this;if(this.rowMerge)for(let t=this.row-1;t>0&&(r=e._getHeaderCell(t,this.col),!r.rowSpan);t--);r&&r.insertBefore(t,r.firstChild)}this.classList.add(this.gId+"_h-v-g-d");break;case"gfd":if(t.frozenRowCount<=0&&this.col<=t.frozenColCount){let t,o=0;for(let l=this.col-1;l>0;l--)if(t=e._getFooterCell(this.row,l),t)if(t.rowMerge){let t=this.row-1,r=e._getFooterCell(t,l);for(;r&&!(t<0)&&r.rowMerge;)t--,r=e._getFooterCell(t,l);o+=r.offsetWidth}else o+=e._getFooterCell(this.row,l).offsetWidth;else o+=0;this.style.position="-webkit-sticky",this.style.zIndex="300",this.style.left=o+"px",this.frozenCol=!0}if(this.cFooter){let t;this.classList.add(this.gId+"_f-v-g-d-value");try{t=e._getFooterCell(this.row,this.col-1)}catch(e){t=null}if(t&&t.classList.add(this.gId+"_f-v-g-d-value"),Object.values(s).includes(this.cFooter)){let t,o,s;switch(this.cFooter){case"$$MAX":if(this.style.justifyContent="right",this.style.textAlign="right",e.getRowCount()>0){o=a(e,this),t=o;for(let l=2;l<=e.getRowCount();l++)s=e._getCell(l,this.col),r(s)&&(o=n(s.cValue),null!==o&&o>t&&(t=o))}break;case"$$MIN":if(this.style.justifyContent="right",this.style.textAlign="right",e.getRowCount()>0){o=a(e,this),t=o;for(let l=2;l<=e.getRowCount();l++)s=e._getCell(l,this.col),r(s)&&(o=n(s.cValue),null!==o&&o<t&&(t=o))}break;case"$$SUM":if(this.style.justifyContent="right",this.style.textAlign="right",e.getRowCount()>0){t=0;for(let o=1;o<=e.getRowCount();o++)s=e._getCell(o,this.col),r(s)&&(t=Math.round(1e5*(t+i(s.cValue)))/1e5)}break;case"$$AVG":if(this.style.justifyContent="right",this.style.textAlign="right",e.getRowCount()>0){t=0,o=0;let l=0;for(let o=1;o<=e.getRowCount();o++)s=e._getCell(o,this.col),r(s)&&(t=Math.round(1e5*(t+i(s.cValue)))/1e5,null===s.cValue||void 0===s.cValue||isNaN(s.cValue)||l++);t=0===l?null:(t/l).toFixed(2)}}t=null==t?"-":l.getFormatNumber(e.getColFormat(this.col),t),this.innerText=t,this.cValue=t}else if("function"==typeof this.cFooter){const t=this.cFooter(e.getValues());this.innerText=t,this.cValue=t}else{this.innerText=this.cFooter,this.cValue=this.cFooter;const t=e._getFooterFormula();t.constructor===Object&&Object.keys(t).forEach((o=>{if(this.cFooter===o){const l=t[o](e.getColValues(this.cIndex));this.innerText=l,this.cValue=l}}))}}this.cAlign&&(this.style.justifyContent=this.cAlign,this.style.textAlign=this.cAlign),this.col===e.getColCount()&&this.classList.add(this.gId+"_f-v-g-d-value"),this.cColVisible&&this.cRowVisible||(this.style.display="none"),this.classList.add(this.gId+"_f-v-g-d");break;case"gbd":switch(this.cDataType){case"text":case"mask":this.style.justifyContent="left",this.style.textAlign="left";break;case"number":this.style.justifyContent="right",this.style.textAlign="right";break;case"date":case"month":case"code":case"select":case"checkbox":case"button":case"link":this.style.justifyContent="center",this.style.textAlign="center";break;default:this.style.justifyContent="center",this.style.textAlign="center";const t=e._getDataTypeStyle();Object.keys(t).forEach((e=>{if(this.cDataType===e){if(t[e].constructor!==Object)throw new Error("Cellstyle can only be inserted in object type.");Object.keys(t[e]).forEach((o=>{this.style[o]=t[e][o]}))}}))}for(;this.firstChild;)this.removeChild(this.firstChild);if(this.append(e._getCellChildNode(this)),this.row<=t.frozenRowCount){let o,l=e._getHeader().offsetHeight,r=0;for(let t=this.row-1;t>0;t--)if(o=e._getCell(t,this.col),o)if(o.colMerge){let o=this.col-1,l=e._getCell(t,o);for(;l&&!(o<0)&&l.colMerge;)o--,l=e._getCell(t,o);r+=l.offsetHeight}else r+=e._getCell(t,this.col).offsetHeight;else r+=0;this.style.position="sticky",this.style.zIndex="200",this.style.top=l+r+"px",this.row===t.frozenRowCount&&(this.style.borderBottom=t.cssInfo.verticalBorderSize+"px solid "+t.cssInfo.headerCellBorderColor),this.frozenCol=!0}if(t.frozenRowCount<=0&&this.col<=t.frozenColCount){let o,l=0;for(let t=this.col-1;t>0;t--)if(o=e._getCell(this.row,t),o)if(o.rowMerge){let o=this.row-1,r=e._getCell(o,t);for(;r&&!(o<0)&&r.rowMerge;)o--,r=e._getCell(o,t);l+=r.offsetWidth}else l+=e._getCell(this.row,t).offsetWidth;else l+=0;this.style.position="sticky",this.style.zIndex="200",this.col===t.frozenColCount&&(this.style.borderRight=t.cssInfo.verticalBorderSize+"px solid "+t.cssInfo.headerCellBorderColor),this.style.left=l+"px",this.frozenRow=!0}if(this.rowMerge){let t=this.row-1,o=e._getCell(t,this.col);for(;o&&!(t<0);){if(!o.rowMerge){o.style.gridRowEnd=this.style.gridRowEnd,o.cVerticalAlign||(o.style.alignItems="center"),o.style.zIndex=o.style.zIndex?o.style.zIndex:"50";break}t--,o=e._getCell(t,this.col)}r(o)&&(this.style.display="none")}if(this.colMerge){let t=this.col-1,o=e._getCell(this.row,t);for(;o&&!(t<0);){if(!o.colMerge){o.style.gridColumnEnd=this.style.gridColumnEnd,o.cAlign||(o.style.justifyContent="center"),o.cAlign||(o.style.textAlign="center"),o.cVerticalAlign||(o.style.alignItems="center"),o.style.zIndex=o.style.zIndex?o.style.zIndex:"50";break}t--,o=e._getCell(this.row,t)}this.style.display="none"}if(this.cAlign&&(this.style.justifyContent=this.cAlign,this.style.textAlign=this.cAlign),this.cVerticalAlign)switch(this.cVerticalAlign.toLowerCase()){case"top":this.style.alignItems="flex-start";break;case"bottom":this.style.alignItems="flex-end";break;default:this.style.alignItems="center"}this.cOverflowWrap&&(this.style.overflowWrap=this.cOverflowWrap),this.cWordBreak&&(this.style.wordBreak=this.cWordBreak),this.cWhiteSpace&&(this.style.whiteSpace=this.cWhiteSpace),this.cBackColor&&(this.style.backgroundColor=this.cBackColor),this.cFontColor&&(this.firstChild.style.color=this.cFontColor),this.cFontBold&&(this.firstChild.style.fontWeight="bold"),this.cFontItalic&&(this.firstChild.style.fontStyle="italic"),this.cFontThruline&&(this.firstChild.style.textDecoration="line-through"),this.cFontUnderline&&(this.firstChild.style.textDecoration="underline"),this.cColVisible&&this.cRowVisible||(this.style.display="none"),this.cFilter&&(this.style.display="none"),t.alterRow&&this.row%2==0?(this.classList.add(this.gId+"_b-v-g-d-alter"),this.classList.remove(this.gId+"_b-v-g-d")):(this.classList.add(this.gId+"_b-v-g-d"),this.classList.remove(this.gId+"_b-v-g-d-alter")),this.cLocked&&this.cLockedColor?this.classList.add(this.gId+"_b-v-g-d-locked"):this.classList.remove(this.gId+"_b-v-g-d-locked"),this.cLocked&&("select"===this.cDataType&&this.firstChild&&"select"==this.firstChild.nType||"checkbox"===this.cDataType&&this.firstChild&&"checkbox"==this.firstChild.nType)&&(this.firstChild.disabled=!0,this.firstChild.style.pointerEvents="none"),this.cUntarget&&("button"===this.cDataType&&this.firstChild&&"button"==this.firstChild.nType?(this.firstChild.disabled=!0,this.firstChild.style.pointerEvents="none"):"link"===this.cDataType&&this.firstChild&&"link"==this.firstChild.nType&&(this.firstChild.style.opacity="0.8",this.firstChild.style.pointerEvents="none"))}this.classList.add(this.gId+"_v-g-d"),this.addEventListener("mouseover",(function(e){if(!this.cUntarget&&"gbd"===this.gType&&(this.classList.add(this.gId+"_mouseover-cell"),"link"===this.cDataType)){this.querySelectorAll("*").forEach((e=>{e.classList.add(this.gId+"_mouseover-cell")}))}})),this.addEventListener("mouseout",(function(e){if(!this.cUntarget&&"gbd"===this.gType&&(this.classList.remove(this.gId+"_mouseover-cell"),"link"===this.cDataType)){this.querySelectorAll("*").forEach((e=>{e.classList.remove(this.gId+"_mouseover-cell")}))}}))}},customElements.get("v-g-d")||customElements.define("v-g-d",t._GridData)},this.destroy=function(){this.gridIds.forEach((e=>{const t=document.getElementById(e),o=document.getElementById(e+"_styles-sheet");t&&t.parentNode.removeChild(t),o&&o.parentNode.removeChild(o),delete window[e]})),document.removeEventListener("mousedown",this._docEvent_mousedown),document.removeEventListener("mouseup",this._docEvent_mouseup),document.removeEventListener("keydown",this._docEvent_keydown),document.removeEventListener("copy",this._docEvent_copy),document.removeEventListener("paste",this._docEvent_paste),e={},this.gridIds=[]}}}function vanillagrid_onBeforeCreate(e,t){return!0}function vanillagrid_onAfterCreate(e,t){}window.addEventListener("load",(function(e){const t=getVanillagrid();!1!==vanillagrid_onBeforeCreate(e,t)&&(t.create(),vanillagrid_onAfterCreate(e,t))}));