function getVanillagrid(){return new function(){this.sortAscSpan,this.sortDescSpan,this.filterSpan,this.footerFormula={},this.dataType={},this.lessoreq0x7ffByte=2,this.lessoreq0xffffByte=3,this.greater0xffffByte=4,this.defaultGridInfo={},this.defaultGridInfo.locked=!1,this.defaultGridInfo.lockedColor=!0,this.defaultGridInfo.resizable=!0,this.defaultGridInfo.redoable=!0,this.defaultGridInfo.redoCount=30,this.defaultGridInfo.visible=!0,this.defaultGridInfo.rownumVisible=!0,this.defaultGridInfo.rownumSize="60px",this.defaultGridInfo.statusVisible=!0,this.defaultGridInfo.selectionPolicy="range",this.defaultGridInfo.nullValue=null,this.defaultGridInfo.dateFormat="yyyy-mm-dd",this.defaultGridInfo.monthFormat="yyyy-mm",this.defaultGridInfo.alterRow=!0,this.defaultGridInfo.frozenColCount=0,this.defaultGridInfo.frozenRowCount=0,this.defaultGridInfo.sortable=!0,this.defaultGridInfo.filterable=!0,this.defaultGridInfo.allCheckable=!0,this.defaultGridInfo.checkedValue="Y",this.defaultGridInfo.uncheckedValue="N",this.defaultGridCssInfo={},this.defaultGridCssInfo.width="100%",this.defaultGridCssInfo.height="600px",this.defaultGridCssInfo.margin="0 auto",this.defaultGridCssInfo.padding="0",this.defaultGridCssInfo.sizeLevel=5,this.defaultGridCssInfo.verticalAlign="center",this.defaultGridCssInfo.cellFontSize=14,this.defaultGridCssInfo.cellMinHeight=21,this.defaultGridCssInfo.horizenBorderSize=1,this.defaultGridCssInfo.verticalBorderSize=1,this.defaultGridCssInfo.gridFontFamily="Arial",this.defaultGridCssInfo.editorFontFamily="Arial",this.defaultGridCssInfo.linkHasUnderLine=!0,this.defaultGridCssInfo.invert=!1,this.defaultGridCssInfo.color=null,this.defaultGridCssInfo.colorSet=null,this.defaultGridCssInfo.gridBorderColor=null,this.defaultGridCssInfo.headerCellBackColor=null,this.defaultGridCssInfo.headerCellBorderColor=null,this.defaultGridCssInfo.headerCellFontColor=null,this.defaultGridCssInfo.footerCellBackColor=null,this.defaultGridCssInfo.footerCellBorderColor=null,this.defaultGridCssInfo.footerCellFontColor=null,this.defaultGridCssInfo.bodyBackColor=null,this.defaultGridCssInfo.bodyCellBackColor=null,this.defaultGridCssInfo.bodyCellBorderColor=null,this.defaultGridCssInfo.bodyCellFontColor=null,this.defaultGridCssInfo.editorBackColor=null,this.defaultGridCssInfo.editorFontColor=null,this.defaultGridCssInfo.selectCellBackColor=null,this.defaultGridCssInfo.selectCellFontColor=null,this.defaultGridCssInfo.selectColBackColor=null,this.defaultGridCssInfo.selectColFontColor=null,this.defaultGridCssInfo.selectRowBackColor=null,this.defaultGridCssInfo.selectRowFontColor=null,this.defaultGridCssInfo.mouseoverCellBackColor=null,this.defaultGridCssInfo.mouseoverCellFontColor=null,this.defaultGridCssInfo.lockCellBackColor=null,this.defaultGridCssInfo.lockCellFontColor=null,this.defaultGridCssInfo.alterRowBackColor=null,this.defaultGridCssInfo.alterRowFontColor=null,this.defaultGridCssInfo.buttonFontColor=null,this.defaultGridCssInfo.buttonBorderColor=null,this.defaultGridCssInfo.buttonBackColor=null,this.defaultGridCssInfo.buttonHoverFontColor=null,this.defaultGridCssInfo.buttonHoverBackColor=null,this.defaultGridCssInfo.buttonActiveFontColor=null,this.defaultGridCssInfo.buttonActiveBackColor=null,this.defaultGridCssInfo.linkFontColor=null,this.defaultGridCssInfo.linkHoverFontColor=null,this.defaultGridCssInfo.linkActiveFontColor=null,this.defaultGridCssInfo.linkVisitedFontColor=null,this.defaultGridCssInfo.linkFocusFontColor=null,this.defaultColInfo={},this.defaultColInfo.rowMerge=!1,this.defaultColInfo.colMerge=!1,this.defaultColInfo.colVisible=!0,this.defaultColInfo.required=!1,this.defaultColInfo.resizable=!0,this.defaultColInfo.sortable=!0,this.defaultColInfo.filterable=!0,this.defaultColInfo.originWidth="80px",this.defaultColInfo.dataType="text",this.defaultColInfo.selectSize="100%",this.defaultColInfo.format=null,this.defaultColInfo.codes=null,this.defaultColInfo.defaultCode=null,this.defaultColInfo.maxLength=null,this.defaultColInfo.maxByte=null,this.defaultColInfo.maxNumber=null,this.defaultColInfo.minNumber=null,this.defaultColInfo.roundNumber=null,this.defaultColInfo.align=null,this.defaultColInfo.verticalAlign=null,this.defaultColInfo.backColor=null,this.defaultColInfo.fontColor=null,this.defaultColInfo.fontBold=!1,this.defaultColInfo.fontItalic=!1,this.defaultColInfo.fontThruline=!1,this.defaultColInfo.fontUnderline=!1,this._docEvent_mousedown=null,this._docEvent_mouseup=null,this._docEvent_keydown=null,this._docEvent_copy=null,this._docEvent_paste=null,this._VanillaGrid=null,this._GridHeader=null,this._GridBody=null,this._GridHeader=null,this._GridFooter=null,this._GridData=null,this.create=function(){const e=this,t={isDragging:!1,onHeaderDragging:!1,isHeaderDragging:!1,mouseX:0,mouseY:0,activeGrid:null,activeGridEditor:null,editOldValue:null,editNewValue:null,filterOldValue:null,filterNewValue:null,mouseoverCell:null,validateNumber(e){const t=Number(e);if(isNaN(t))throw new Error("The provided parameter is not a number.");return t},validateIntegerAndZero(e){const t=Number(e);if(isNaN(t))throw new Error("The provided parameter is not a number.");if(!Number.isInteger(t))throw new Error("The provided number is not an integer.");return t},validatePositiveIntegerAndZero(e){const t=Number(e);if(isNaN(t))throw new Error("The provided parameter is not a number.");if(!Number.isInteger(t))throw new Error("The provided number is not an integer.");if(t<0)throw new Error("The provided number is not a positive integer.");return t},extractNumberAndUnit(e){if(null==e)return"";const t=(e=""+e.trim()).match(/^(\d+)(\D*)$/);if(t){const e=""===t[2]?"px":t[2];return{number:parseInt(t[1],10),unit:e}}return""},toLowerCase:e=>e&&"string"==typeof e?e.toLowerCase():"",toUpperCase:e=>e&&"string"==typeof e?e.toUpperCase():"",isIncludeEnum:(e,t)=>Object.values(e).includes(t),isValidDate(e,t,o){const l=new Date(e,t-1,o);return l.getFullYear()==e&&l.getMonth()+1==t&&l.getDate()==o},isValidEmail:e=>/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e),getCutByteLength(t,o){if(null==t)return null;let l=0,r=(t=String(t)).length;for(let n=0;n<t.length;n++){const i=t.charCodeAt(n);if(l+=i<=127?1:i<=2047?e.lessoreq0x7ffByte:i<=65535?e.lessoreq0xffffByte:e.greater0xffffByte,l>o){r=n;break}}return t.substring(0,r)},deepCopy(e,t){if(null===e||"object"!=typeof e)return e;if(e.constructor!==Object&&e.constructor!==Array)return e;t||(t=[]);for(let o=0;o<t.length;o++)if(t[o].source===e)return t[o].copy;let o;if(Array.isArray(e)){o=[],t.push({source:e,copy:o});for(let l=0;l<e.length;l++)o[l]=this.deepCopy(e[l],t)}else{o={},t.push({source:e,copy:o});for(let l in e)e.hasOwnProperty(l)&&(o[l]=this.deepCopy(e[l],t))}return o},deepFreeze(e,t){const o=Object.getOwnPropertyNames(e),l=this;return o.forEach((o=>{const r=e[o];t&&t.indexOf(o)<0&&"object"==typeof r&&null!==r&&l.deepFreeze(r,t)})),Object.freeze(e)},getArrayElementWithBoundCheck(e,t){if(null==(t=this.getOnlyNumberWithNaNToNull(t)))throw new Error("Please enter the correct index.");if(t<0||t>=e.length)throw new Error("Index is out of range. Please enter the correct index.");return e[t]},removeAllChild(e){for(;e.firstChild;)e.removeChild(e.firstChild)},getBorderWidth(e){const t=getComputedStyle(e);return this.extractNumberAndUnit(t.borderLeftWidth).number+this.extractNumberAndUnit(t.borderRightWidth).number},getBorderHeight(e){const t=getComputedStyle(e);return this.extractNumberAndUnit(t.borderTopWidth).number+this.extractNumberAndUnit(t.borderBottomWidth).number},getHexColorFromColorName(e){if(/^#[0-9a-fA-F]{6}$/.test(e))return e;const t=document.createElement("div");t.style.color=e,document.body.appendChild(t);const o=window.getComputedStyle(t).color;document.body.removeChild(t);const l=o.match(/\d+/g);return"#"+((1<<24)+(+l[0]<<16)+(+l[1]<<8)+ +l[2]).toString(16).slice(1)},getColorShade(e){let t=0;return parseInt(e.slice(1,3),16)>=160&&t++,parseInt(e.slice(3,5),16)>=160&&t++,parseInt(e.slice(5,7),16)>=160&&t++,t>=2?"light":"dark"},getAdjustHexColor(e,t){e.startsWith("#")&&(e=e.slice(1));let o=parseInt(t,16);t.startsWith("-")&&(o=-parseInt(t.slice(1),16));let l=parseInt(e.slice(0,2),16),r=parseInt(e.slice(2,4),16),n=parseInt(e.slice(4,6),16);return l=parseInt(l+o),r=parseInt(r+o),n=parseInt(n+o),l=(l<0?0:l>255?255:l).toString(16).padStart(2,"0"),r=(r<0?0:r>255?255:r).toString(16).padStart(2,"0"),n=(n<0?0:n>255?255:n).toString(16).padStart(2,"0"),"#"+l+r+n},getMostLightHexColor(e){e.startsWith("#")&&(e=e.slice(1));let t=parseInt(e.slice(0,2),16),o=parseInt(e.slice(2,4),16),l=parseInt(e.slice(4,6),16);return t=parseInt(210+t/255*50),o=parseInt(210+o/255*50),l=parseInt(210+l/255*50),t=(t<0?0:t>255?248:t).toString(16).padStart(2,"0"),o=(o<0?0:o>255?248:o).toString(16).padStart(2,"0"),l=(l<0?0:l>255?248:l).toString(16).padStart(2,"0"),"#"+t+o+l},getInvertColor(e){e.startsWith("#")&&(e=e.slice(1));let t=255-parseInt(e.slice(0,2),16),o=255-parseInt(e.slice(2,4),16),l=255-parseInt(e.slice(4,6),16);return t=t<127.5?t+16:t-16,o=o<127.5?o+16:o-16,l=l<127.5?l+16:l-16,t=(t<0?0:t>255?255:t).toString(16).padStart(2,"0"),o=(o<0?0:o>255?255:o).toString(16).padStart(2,"0"),l=(l<0?0:l>255?255:l).toString(16).padStart(2,"0"),"#"+t+o+l},getCssTextFromObject(e){let t="";if(!e||e.constructor!==Object||0===Object.keys(e).length)return t;let o=Object.entries(e);for(let e=0;e<o.length;e++)o[e].length<2||(t+=o[e][0].trim()+":"+o[e][1].trim()+";");return t},getColorFromColorSet(e){switch(e){case"skyblue":return"#91c8e4";case"blue":return"#4682a9";case"light-red":return"#fdd2bf";case"red":return"#b61919";case"light-green":return"#a4be7b";case"green":return"#217346";case"orange":return"#f79327";case"yellow":return"#ffe569";case"purple":return"#804674";case"brown":return"#675d50";case"black":return"#272829";default:throw new Error("Please enter the correct colorSet.")}},setColorSet(e){let t=e.color;if(t||(t="#f3f3f3"),"black"!==t&&"#000"!==t&&"#000000"!==t&&"#000000"===this.getHexColorFromColorName(t))throw new Error("Please enter the correct color.");t=this.getHexColorFromColorName(t);const o="light"===this.getColorShade(t),l=o?"#333333":"#ffffff",r=this.getMostLightHexColor(t);e.gridBorderColor=this.getAdjustHexColor(t,"-4f"),e.bodyBackColor="#ffffff",e.headerCellBackColor=t,e.headerCellBorderColor=this.getAdjustHexColor(t,"-4f"),e.headerCellFontColor=l,e.footerCellBackColor=t,e.footerCellBorderColor=this.getAdjustHexColor(t,"-4f"),e.footerCellFontColor=l,e.bodyCellBackColor="#ffffff",e.bodyCellBorderColor=this.getAdjustHexColor(t,"-f"),e.bodyCellFontColor="#333333",e.editorBackColor="#fefefe",e.editorFontColor="#333333",e.selectCellBackColor=this.getAdjustHexColor(t,"-2f"),e.selectCellFontColor=l,e.selectColBackColor=this.getAdjustHexColor(t,"-2f"),e.selectColFontColor=l,e.selectRowBackColor=this.getAdjustHexColor(r,o?"-f":"-2f"),e.selectRowFontColor="#333333",e.mouseoverCellBackColor=t,e.mouseoverCellFontColor=l,e.lockCellBackColor=this.getAdjustHexColor(r,o?"-6":"-1f"),e.lockCellFontColor="#666666",e.alterRowBackColor=r,e.alterRowFontColor="#333333",e.buttonFontColor=l,e.buttonBackColor=t,e.buttonBorderColor=this.getAdjustHexColor(t,o?"-cf":"-4f"),e.buttonHoverFontColor=l,e.buttonHoverBackColor=this.getAdjustHexColor(t,"-f"),e.buttonActiveFontColor=l,e.buttonActiveBackColor=this.getAdjustHexColor(t,"-2f"),e.linkFontColor=this.getAdjustHexColor(t,o?"-cf":"0"),e.linkHoverFontColor=this.getAdjustHexColor(t,o?"-4f":"af"),e.linkActiveFontColor=this.getAdjustHexColor(t,o?"-cf":"0"),e.linkVisitedFontColor=this.getAdjustHexColor(t,o?"-5f":"2f"),e.linkFocusFontColor=this.getAdjustHexColor(t,o?"-4f":"bf")},setInvertColor(e){e.gridBorderColor=this.getInvertColor(e.gridBorderColor),e.headerCellBackColor=this.getInvertColor(e.headerCellBackColor),e.headerCellBorderColor=this.getInvertColor(e.headerCellBorderColor),e.headerCellFontColor=this.getInvertColor(e.headerCellFontColor),e.footerCellBackColor=this.getInvertColor(e.footerCellBackColor),e.footerCellBorderColor=this.getInvertColor(e.footerCellBorderColor),e.footerCellFontColor=this.getInvertColor(e.footerCellFontColor),e.bodyBackColor=this.getInvertColor(e.bodyBackColor),e.bodyCellBackColor=this.getInvertColor(e.bodyCellBackColor),e.bodyCellBorderColor=this.getInvertColor(e.bodyCellBorderColor),e.bodyCellFontColor=this.getInvertColor(e.bodyCellFontColor),e.editorBackColor=this.getInvertColor(e.editorBackColor),e.editorFontColor=this.getInvertColor(e.editorFontColor),e.selectCellBackColor=this.getInvertColor(e.selectCellBackColor),e.selectCellFontColor=this.getInvertColor(e.selectCellFontColor),e.selectColBackColor=this.getInvertColor(e.selectColBackColor),e.selectColFontColor=this.getInvertColor(e.selectColFontColor),e.selectRowBackColor=this.getInvertColor(e.selectRowBackColor),e.selectRowFontColor=this.getInvertColor(e.selectRowFontColor),e.mouseoverCellBackColor=this.getInvertColor(e.mouseoverCellBackColor),e.mouseoverCellFontColor=this.getInvertColor(e.mouseoverCellFontColor),e.lockCellBackColor=this.getInvertColor(e.lockCellBackColor),e.lockCellFontColor=this.getInvertColor(e.lockCellFontColor),e.alterRowBackColor=this.getInvertColor(e.alterRowBackColor),e.alterRowFontColor=this.getInvertColor(e.alterRowFontColor),e.buttonFontColor=this.getInvertColor(e.buttonFontColor),e.buttonBorderColor=this.getInvertColor(e.buttonBorderColor),e.buttonBackColor=this.getInvertColor(e.buttonBackColor),e.buttonHoverFontColor=this.getInvertColor(e.buttonHoverFontColor),e.buttonHoverBackColor=this.getInvertColor(e.buttonHoverBackColor),e.buttonActiveFontColor=this.getInvertColor(e.buttonActiveFontColor),e.buttonActiveBackColor=this.getInvertColor(e.buttonActiveBackColor),e.linkFontColor=this.getInvertColor(e.linkFontColor),e.linkHoverFontColor=this.getInvertColor(e.linkHoverFontColor),e.linkActiveFontColor=this.getInvertColor(e.linkActiveFontColor),e.linkVisitedFontColor=this.getInvertColor(e.linkVisitedFontColor),e.linkFocusFontColor=this.getInvertColor(e.linkFocusFontColor)},getAttributeWithCheckRequired(e,t){if(t.getAttribute(e))return t.getAttribute(e);throw console.log(t),console.log("^ This element,"),new Error("'"+e+"' is required.")},getAttributeOnlyNumberIntegerOrZero(e,t){let o=t.getAttribute(e);return null==o||""===o?null:(o=Number(o),Number.isInteger(o)&&o>0?o:null)},getAttributeOnlyNumberInteger(e,t){let o=t.getAttribute(e);return null==o||""===o?null:(o=Number(o),Number.isInteger(o)?o:null)},getAttributeOnlyNumber(e,t){let o=t.getAttribute(e);return null==o||""===o?null:(o=Number(o),isNaN(o)?null:o)},getAttributeOnlyBoolean(e,t){let o=t.getAttribute(e);return null==o||""===o?null:"true"===this.toLowerCase(o)},getOnlyNumberWithNaNToZero(e){const t=Number(e);return isNaN(t)?0:t},getOnlyNumberWithNaNToNull(e){const t=Number(e);return isNaN(t)?null:t},getCheckboxCellTrueOrFalse(e){const t=e.cValue,o=this[e.gId].info.gCheckedValue,l=this[e.gId].info.gUncheckedValue;return"boolean"==typeof t?(e.cValue=t?o:l,t):t===o||(e.cValue=l,!1)},isElementVisible(e){const t=e.getBoundingClientRect();if(t.top>=0&&t.left>=0&&t.bottom<=window.innerHeight&&t.right<=window.innerWidth){const o=t.left+(t.right-t.left)/2,l=t.top+(t.bottom-t.top)/2,r=document.elementFromPoint(o,l);return e.contains(r)||e===r}return!1},getFirstChildTextNode(e){for(let t=0;t<e.childNodes.length;t++){const o=e.childNodes[t];if(o.nodeType===Node.TEXT_NODE)return o}return null},nvl:(e,t)=>null==e||""===e?t:e,getVerticalAlign(e){switch(this.toLowerCase(e)){case"top":return"flex-start";case"bottom":return"flex-end";default:return"center"}},reConnectedCallbackElement(e){if(["ghd","gbd","gfd"].indexOf(e.gType)<0)return;const t=e.parentNode;t&&(this.setGridDataPosition(e),t.removeChild(e),t.appendChild(e))},checkIsValueOrData(e){let t=null;for(const o of e)if(o.constructor===Object){if(null!==t&&!1===t)throw new Error("Please insert valid datas.");t=!0}else{if(!Array.isArray(o))throw new Error("Please insert valid datas.");if(o[0]&&o[0].constructor!==Object)throw new Error("Please insert valid datas.");if(null!==t&&!0===t)throw new Error("Please insert valid datas.");t=!1}return t},modifyColSize(e,t,o){if(!t)return;if(!t.cResizable)return;if("v-g-rownum"===t.cId||"v-g-status"===t.cId)return;if(!1===this.doEventWithCheckChanged(e,"_onResize",t.cId))return;const l=this[e]._getHeader(),r=this[e]._getBody(),n=this[e]._getFooter(),i=l.style.gridTemplateColumns.split(" "),a=i[t.col-1];"%"===this.extractNumberAndUnit(a).unit&&(o=o>0?1:o<0?-1:0);const s=this.extractNumberAndUnit(a).number+o+this.extractNumberAndUnit(a).unit;i[t.col-1]=s;const c=i.join(" ");l.style.gridTemplateColumns=c,r.style.gridTemplateColumns=c,n.style.gridTemplateColumns=c},changeColSize(e,t,o){if("number"!=typeof o||o<0)throw new Error("The format of size is only zero or positive integers.");const l=this[e];if(l._getHeaderCell(1,t).frozenCol)return;const r=0!==o;for(let o=1;o<=this[e].getHeaderRowCount();o++){const e=l._getHeaderCell(o,t);e.cColVisible=r,this.reConnectedCallbackElement(e)}for(let o=1;o<=this[e].getRowCount();o++)l._getCell(o,t).cColVisible=r;for(let o=1;o<=this[e].getFooterRowCount();o++){const e=l._getFooterCell(o,t);e.cColVisible=r,this.reConnectedCallbackElement(e)}const n=l._getHeader(),i=l._getBody(),a=l._getFooter(),s=n.style.gridTemplateColumns.split(" "),c=s[t-1],d=o+this.extractNumberAndUnit(c).unit;s[t-1]=d;const u=s.join(" ");n.style.gridTemplateColumns=u,i.style.gridTemplateColumns=u,a.style.gridTemplateColumns=u},selectCell(e){const t=e.gId;return!1!==this.doEventWithCheckChanged(t,"_onActiveCell",e.row,e.cId)&&(!1!==this.doEventWithCheckChanged(t,"_onActiveRow",e.row)&&(!1!==this.doEventWithCheckChanged(t,"_onActiveCol",e.cId)&&("none"!==this[t].info.gSelectionPolicy&&(this.resetSelection(t),this[t].variables._targetCell=e,this.selectCells(e,e),this.focusCell(e),!0))))},focusCell(e){const t=e.gId,o=this[t].getBoundingClientRect(),l=this[t]._getHeader(),r=this[t]._getFooter(),n=e.getBoundingClientRect(),i=n.top-o.top-l.clientHeight,a=n.bottom-o.top+r.clientHeight,s=n.left-o.left,c=n.right-o.left;i<0?this[t].scrollTop+=i:a>this[t].clientHeight&&(this[t].scrollTop+=a-this[t].clientHeight),s<0?this[t].scrollLeft+=s:c>this[t].clientWidth&&(this[t].scrollLeft+=c-this[t].clientWidth)},resetSelection(e){e&&(this[e].variables._activeRows&&(this[e].variables._activeRows=[]),this[e].variables._activeCols&&(this[e].variables._activeCols=[]),this[e].variables._activeCells&&(this[e].variables._activeCells=[]),this[e].variables._targetCell&&(this[e].variables._targetCell=[]),this.unselectCells(e))},unselectCells(t){const o=this[t].querySelectorAll("."+t+"_selected-cell");for(const l of o){if(l.classList.remove(t+"_selected-cell"),"link"===l.cDataType||"select"===l.cDataType){l.querySelectorAll("*").forEach((e=>{e.classList.remove(t+"_selected-cell")}))}e.dataType&&Object.keys(e.dataType).forEach((o=>{if(l.cDataType===o&&e.dataType[o].onUnselected){if("function"!=typeof e.dataType[o].onUnselected)throw new Error("onSelected must be a function.");e.dataType[o].onUnselected(l,this[t]._getData(l))}}))}const l=this[t].querySelectorAll("."+t+"_selected-col");for(const e of l)e.classList.remove(t+"_selected-col");const r=this[t].querySelectorAll("."+t+"_selected-row");for(const e of r)e.classList.remove(t+"_selected-row")},selectCells(t,o,l){const r=t.gId;if(!1===this.doEventWithCheckChanged(r,"_onActiveCells",t.row,t.cId,o.row,o.cId))return!1;if(!1===this.doEventWithCheckChanged(r,"_onActiveRows",t.row,o.row))return!1;if(!1===this.doEventWithCheckChanged(r,"_onActiveCols",t.cId,o.cId))return!1;if("range"!==this[r].info.gSelectionPolicy&&t!==o)return!1;const n=t.row<o.row?t.row:o.row,i=t.row>o.row?t.row:o.row,a=t.col<o.col?t.col:o.col,s=t.col>o.col?t.col:o.col;let c;this[r].variables._activeCells=[],this[r].variables._activeRows=[],this[r].variables._activeCols=[];for(let t=n;t<=i;t++){for(let o=a;o<=s;o++)if(t===n&&this[r].variables._activeCols.push(o),c=this[r]._getCell(t,o),!c.cUntarget&&this.isCellVisible(c)){if(this[r].variables._activeCells.push(c),c.classList.add(r+"_selected-cell"),"link"===c.cDataType||"select"===c.cDataType){c.querySelectorAll("*").forEach((e=>{e.classList.add(r+"_selected-cell")}))}e.dataType&&Object.keys(e.dataType).forEach((t=>{if(c.cDataType===t&&e.dataType[t].onSelected){if("function"!=typeof e.dataType[t].onSelected)throw new Error("onSelected must be a function.");e.dataType[t].onSelected(c,this[r]._getData(c))}}))}this[r].variables._activeRows.push(t)}return this.setActiveCol(r),this.setActiveRow(r),this.focusCell(l||o),!0},setActiveCol(e){const t=this[e];for(const o of this[e].variables._activeCols)for(let l=1;l<=t.getHeaderRowCount();l++)t._getHeaderCell(l,o).classList.add(e+"_selected-col")},setActiveRow(e){for(const t of this[e].variables._activeRows)for(const o of this[e]._getRow(t))o.classList.add(e+"_selected-row")},scrollInterval:null,startScrolling(e,t){this.scrollInterval||(this.scrollInterval=setInterval((()=>{if("range"!==this[e].info.gSelectionPolicy)return;const o=this[e];if(o.variables._activeCells.length<=0)return;const l=o.variables._activeCells[0],r=o.variables._activeCells[o.variables._activeCells.length-1];let n;switch(t){case"up":n=this.getMoveRowCell(l,-1),this.unselectCells(e),this.selectCells(n,r,n);break;case"down":n=this.getMoveRowCell(r,1),this.unselectCells(e),this.selectCells(l,n);break;case"left":n=this.getMoveColCell(l,-1),this.unselectCells(e),this.selectCells(n,r,n);break;case"right":n=this.getMoveColCell(r,1),this.unselectCells(e),this.selectCells(l,n)}}),100))},stopScrolling(){this.scrollInterval&&clearInterval(this.scrollInterval),this.scrollInterval=null},copyGrid(e){const o=this.getCopyText(e);!1!==t.doEventWithCheckChanged(e[0].gId,"_onCopy",e[0].row,e[0].cId,e[e.length-1].row,e[e.length-1].cId,o)&&navigator.clipboard.writeText(o).then((()=>{}),(e=>{}))},getCopyText(t){let o="",l=null;return t.forEach((t=>{let r=t.row,n=this.getCellText(t);Object.keys(e.dataType).forEach((o=>{if(t.cDataType===o&&e.dataType[o].getCopyValue){if("function"!=typeof e.dataType[o].getCopyValue)throw new Error("getCopyValue must be a function.");n=e.dataType[o].getCopyValue(t.cValue)}})),n.includes("\n")&&(n='"'+n+'"'),null!==l&&l!==r?o+="\n":l===r&&(o+="\t"),o+=n,l=r})),o},modifyCellValue(e,o,l,r=!1){const n=this[e.gId];if(!r){if(!this.isCellVisible(e))return;if(e.cUntarget||e.cLocked)return}if(o=this.getValidValue(e,o),e.cValue===o)return;const i=e.cValue,a=o;l&&Array.isArray(l)&&l.push({cell:e,oldValue:i,newValue:a}),n.setRowStatus(e.row,"U"),e.cValue=o,t.reConnectedCallbackElement(e),this.reloadGridWithModifyCell(e.gId,e.cIndex)},getRecodesWithModifyValue(e,t,o=!1){const l=[];return this.modifyCellValue(e,t,l,o),l},pasteGrid(o,l){const r=this,n=l.gId,i=o.clipboardData||window.clipboardData,a=r[n].variables._activeCells[0],s=i.getData("text");if(!1===t.doEventWithCheckChanged(a.gId,"_onPaste",a.row,a.cId,s))return o.stopPropagation(),void o.preventDefault();const c=[],d=[];let u="",C=!1;for(let e=0;e<s.length;e++){let t=s[e],o=s[e+1];'"'===t&&(C=!C),C||"\n"!==t&&("\r"!==t||"\n"!==o)?u+=t:(c.push(u),u="","\r"===t&&"\n"===o&&e++)}u&&c.push(u);const f=a.row,g=a.col,h=l.getRowCount(),b=l.getColCount();let v=0,I=0;for(let t=0;t<c.length;t++){const t=f+I+v;if(t>h)return;const o=l._getRow(t);if(!o[0].cRowVisible||o[0].cFilter){v++;let e=1,t=r[n]._getCell(o[0].row+e,1);for(;t&&(!t.cRowVisible||t.cFilter);)v++,e++,t=r[n]._getCell(o[0].row+e,1);continue}let i=0,a=0;const s=c[I].split("\t");for(let t=0;t<s.length;t++){const t=g+a-1+i;if(t>=b)break;const n=o[t];if(!n.cColVisible){i++;let e=1,l=o[t+e];for(;l&&!l.cColVisible;)i++,e++,l=o[t+e];continue}let c=s[a];if(["select","checkbox","button","link"].indexOf(n.cDataType)<0&&!n.cUntarget&&!n.cLocked){c=c.replaceAll('"',"");let t=!0;Object.keys(e.dataType).forEach((o=>{if(n.cDataType===o)if(e.dataType[o].getPasteValue){if("function"!=typeof e.dataType[o].getPasteValue)throw new Error("getPasteValue must be a function.");c=e.dataType[o].getPasteValue(l._getData(n),c)}else t=!1})),t&&d.push(...r.getRecodesWithModifyValue(n,c))}a++}I++}d.length>0&&r.recodeGridModify(n,d)},modifyCell(){if(!this.activeGridEditor)return;let t=this.activeGridEditor.parentNode;if(t.cUntarget||t.cLocked)return;if(this.editNewValue=this.activeGridEditor.value,Object.keys(e.dataType).forEach((o=>{if(t.cDataType===o)if(e.dataType[o].getEditedValue){if("function"!=typeof e.dataType[o].getEditedValue)throw new Error("getEditedValue must be a function.");this.editNewValue=e.dataType[o].getEditedValue(this.activeGridEditor,this[t.gId]._getData(t))}else this.editNewValue=this.editOldValue})),this.removeGridEditor(),!1===this.doEventWithCheckChanged(t.gId,"_onBeforeChange",t.row,t.cId,this.editOldValue,this.editNewValue))return!1;const o=this.editNewValue,l=this.getRecodesWithModifyValue(t,o);this.recodeGridModify(t.gId,l),this.doEventWithCheckChanged(t.gId,"_onAfterChange",t.row,t.cId,this.editOldValue,this.editNewValue)},getTabCell(e,t){if(!e)return null;let o,l=e.row,r=t?e.col-1:e.col+1;for(;!o&&l>=1&&l<=this.activeGrid.getRowCount();){for(;!o&&r>=1&&r<=this.activeGrid.getColCount();)o=this.activeGrid._getCell(l,r),o&&(o.rowMerge||o.colMerge||o.cUntarget?o=null:this.isCellVisible(o)||(o=null)),r=t?r-1:r+1;l=t?l-1:l+1,r=t?this.activeGrid.getColCount():1}return o||(o=e),o},getMoveRowCell(e,t){if(!e)return null;let o,l=e.row,r=e.col;if(!t)return e;for(;!(o||(l+=t,l<1||l>this[e.gId].getRowCount()));)o=this.activeGrid._getCell(l,r),o&&(o.rowMerge||o.colMerge||o.cUntarget?o=null:this.isCellVisible(o)||(o=null));return o||(o=e),o},getMoveColCell(e,t){if(!e)return null;let o,l=e.row,r=e.col;if(!t)return e;for(;!(o||(r+=t,r<1||r>this[e.gId].getColCount()));)o=this.activeGrid._getCell(l,r),o&&(o.rowMerge||o.colMerge||o.cUntarget?o=null:this.isCellVisible(o)||(o=null));return o||(o=e),o},sort(t,o,l,r=!0,n=!1){const i=this.deepCopy(o),a=this[t];return i.sort(((t,o)=>{const i=t.find((e=>e.id===l)),s=o.find((e=>e.id===l));let c=i?i.value:null;const d=i?i.dataType:null;let u=s?s.value:null;const C=s?s.dataType:null;let f=n;if("number"!=typeof c&&"number"!=typeof u||(f=!0),c===a.info.gNullValue&&(c=null),u===a.info.gNullValue&&(u=null),"select"===d&&null!==c&&Array.isArray(c)){let e=c.find((e=>e.selected));c=e?e.text:c.length>0&&void 0!==c[0].text?c[0].text:null}else"link"===d&&null!==c&&c.constructor===Object&&(c=c.text);if("select"===C&&null!==u&&Array.isArray(u)){let e=u.find((e=>e.selected));u=e?e.text:u.length>0&&void 0!==u[0].text?u[0].text:null}else"link"===C&&null!==u&&u.constructor===Object&&(u=u.text);if(e.dataType&&Object.keys(e.dataType).forEach((t=>{if(d===t)if(e.dataType[t].getSortValue){if("function"!=typeof e.dataType[t].getSortValue)throw new Error("getSortValue must be a function.");c=e.dataType[t].getSortValue(c)}else c=i.text;if(C===t)if(e.dataType[t].getSortValue){if("function"!=typeof e.dataType[t].getSortValue)throw new Error("getSortValue must be a function.");u=e.dataType[t].getSortValue(u)}else u=s.text})),f){const e=null===c?NaN:Number(c),t=null===u?NaN:Number(u);if(!isNaN(e)&&!isNaN(t))return!1!==r?e-t:t-e;isNaN(e)&&(c=null),isNaN(t)&&(u=null)}return null===c&&null===u?0:null===c?!1!==r?1:-1:null===u?!1!==r?-1:1:c.localeCompare||u.localeCompare?c.localeCompare?u.localeCompare?f?!1!==r?c.localeCompare(u,void 0,{numeric:!0}):u.localeCompare(c,void 0,{numeric:!0}):!1!==r?c.localeCompare(u):u.localeCompare(c):!1!==r?-1:1:!1!==r?1:-1:0})),a.variables._sortToggle[l]=r,i},setFilterOptions(e,t){const o=e.value;this.removeAllChild(e),t.forEach((t=>{option=document.createElement("option"),option.value=t.value,option.textContent=t.text,e.appendChild(option)})),o&&(e.value=o)},reloadFilterValue(t,o){const l=this[t];if(!l||!l.info.gFilterable)return;const r=l._getColInfo(o);if(r.cFilterable){r.cFilterValues=new Set;for(let t=1;t<=l.getRowCount();t++){let o,n=l._getCell(t,r.cIndex);n&&n.cRowVisible&&n.cColVisible&&(o=this.getCellText(n),Object.keys(e.dataType).forEach((t=>{if(n.cDataType===t&&e.dataType[t].getFilterValue){if("function"!=typeof e.dataType[t].getFilterValue)throw new Error("getFilterValue must be a function.");o=e.dataType[t].getFilterValue(n.cValue)}})),""!==o&&null!=o&&o!==l.info.gNullValue||(o="$$NULL"),r.cFilterValues.add(o))}this.reloadFilter(t,o)}},reloadFilter(e,t){const o=this[e],l=o._getHeaderFilter(t);if(!l)return;const r=o._getColInfo(t),n=r.cFilterValues,i=r.cDataType;if(!n)return;let a=[],s={value:"$$ALL",text:"*"};a.push(s),n.forEach((e=>{s={},s.value=e,s.text=e,"$$NULL"===e&&(s.text=o.info.gNullValue),"checkbox"===i&&(s.text=e===o.info.gCheckedValue?"☑":"☐"),a.push(s)}));const c=l.value;this.removeAllChild(l),a.forEach((e=>{s=document.createElement("option"),s.value=e.value,s.textContent=e.text,l.appendChild(s)})),c&&(l.value=c,r.cFilterValue=c)},reloadColForMerge(e,o){const l=t[e],r=l._getColInfo(o);let n,i,a,s;if(r.cRowMerge){for(s=r.cIndex,a=1;a<=l.getRowCount();a++)i=l._getCell(a,s),delete i.rowSpan,delete i.rowMerge,delete i.colSpan,delete i.colMerge;for(a=2;a<=l.getRowCount();a++)if(n=l._getCell(a-1,s),i=l._getCell(a,s),n&&this.isCellVisible(n)&&n.cDataType===i.cDataType&&this.getCellText(n)===this.getCellText(i)){for(let e=n.row-1;e>0;e--)if(n=l._getCell(e,s),!0!==n.rowMerge){n.rowSpan=this.nvl(n.rowSpan,1)+1;break}i.rowMerge=!0}for(a=1;a<=l.getRowCount();a++)i=l._getCell(a,s),this.reConnectedCallbackElement(i)}if(r.cColMerge&&!l._getColInfo(o-1).cRowMerge){const e=l._getCells();for(a=1;a<=l.getRowCount();a++)for(s=r.cIndex-1;s<=r.cIndex;s++)i=l._getCell(a,s),delete i.rowSpan,delete i.rowMerge,delete i.colSpan,delete i.colMerge;for(s=r.cIndex,a=1;a<=l.getRowCount();a++)if(n=e[a-1][s-2],i=e[a-1][s-1],n&&this.isCellVisible(n)&&n.cDataType===i.cDataType&&this.getCellText(n)===this.getCellText(i)){for(let t=n.col-1;t>2;t--)if(n=e[a-1][t],!0!==n.colMerge){n.colSpan=this.nvl(n.colSpan,1)+1;break}i.colMerge=!0}for(a=1;a<=l.getRowCount();a++)for(s=r.cIndex-1;s<=r.cIndex;s++)i=l._getCell(a,s),this.reConnectedCallbackElement(i)}},reloadGridWithModifyCell(e,t){this.reloadFooterValue(e),this.reloadFilterValue(e,t);const o=this[e]._getColInfo(t+1);o&&o.cColMerge?this.reloadColForMerge(e,t+1):this.reloadColForMerge(e,t)},reloadGridForMerge(e){for(let o=3;o<=t[e].getColCount();o++)this.reloadColForMerge(e,o)},reloadFooterValue(e){const t=this[e]._getFooterCells();for(const e of t)for(const t of e)null!==t.cFooter&&void 0!==t.cFooter&&this.reConnectedCallbackElement(t)},setGridDataRowCol(e,t,o){e.row=t,e.col=o,e.cIndex=o,this.setGridDataPosition(e)},setGridDataPosition(e){row=e.row,col=e.col,e.style.gridRowStart=row,e.style.gridRowEnd=row+1,e.style.gridColumnStart=col,e.style.gridColumnEnd=col+1},getGridCell(e,o,l,r,n){let i,a,s;if(l&&l.constructor===Object)i={},i.value=l[o.cId];else if(l&&Array.isArray(l))for(s of l)if(s.id===o.cId){i=s;break}i||(i={},i.value=null);const c=document.createElement("v-g-d");switch(c.gId=e,c.gType="gbd",Object.keys(o).forEach((e=>{["cHeader","cFooter","cRowMerge","cColMerge","cFilterValue","cIndex"].indexOf(e)<0&&(a=e.charAt(1).toLowerCase()+e.slice(2),c[e]=a in i?i[a]:o[e])})),c.cId){case"v-g-rownum":c.cValue=r;break;case"v-g-status":c.cValue=t.getCodeValue(["C","U","D"],null,i.value);break;default:c.cValue=t.getValidValue(c,i.value)}return o.cFilterable&&c.cColVisible&&o.cFilterValues.add(c.textContent),this.setGridDataRowCol(c,r,n),c},isCellVisible(e){if(e)return!(!1===e.cColVisible||!1===e.cRowVisible||!0===e.cFilter)},getFirstCellValidNumber(e,t){let o,l;for(let r=1;r<e.getRowCount();r++)if(l=e._getCell(r,t.col),this.isCellVisible(l)&&(o=this.getOnlyNumberWithNaNToNull(l.cValue),o))return o;return null},recodeGridModify(e,t){if(t.length<=0)return;const o=this[e];o.variables._recodeseq<o.variables._recodes.length&&o.variables._recodes.splice(o.variables._recodeseq),o.variables._recodes.push(t),o.variables._recodeseq=o.variables._recodeseq+1,o.variables._recodeseq>o.info.gRedoCount&&(o.variables._recodes.shift(),o.variables._recodeseq=o.variables._recodeseq-1)},redoundo(e,t){const o=this[e];if(!o.info.gRedoable)return!1;const l=!1!==t;if(l&&o.variables._recodeseq<=0)return!1;if(!l&&o.variables._recodeseq+1>o.variables._recodes.length)return!1;if(o.variables._recodeseq=l?o.variables._recodeseq-1:o.variables._recodeseq+1,redoCellInfos=l?o.variables._recodes[o.variables._recodeseq]:o.variables._recodes[o.variables._recodeseq-1],!redoCellInfos||!Array.isArray(redoCellInfos))return!1;this.selectCell(redoCellInfos[0].cell);for(const e of redoCellInfos)e.cell.cValue=l?e.oldValue:e.newValue,this.reConnectedCallbackElement(e.cell),this.reloadGridWithModifyCell(e.cell.gId,e.cell.cIndex);return!0},removeGridEditor(){if(!this.activeGridEditor)return!1;const e=this.activeGridEditor.targetCell;return this.doEventWithCheckChanged(e.gId,"_onEditEnding",e.row,e.cId,this.editOldValue,this.editNewValue),e.style.padding="",e.style.fontSize="",this.activeGridEditor.parentNode.removeChild(this.activeGridEditor),this.activeGridEditor=null,!0},addBagicEventListenerToGridEditor(e){e.addEventListener("keydown",(function(e){const o=t.activeGrid,l=o.gId,r=o.variables._targetCell;if(!1===t.doEventWithCheckChanged(l,"_onKeydownEditor",e))return e.stopPropagation(),void e.preventDefault();let n;switch(e.key){case"Enter":e.shiftKey||(t.modifyCell(),n=t.getMoveRowCell(r,1),t.selectCell(n),e.stopPropagation(),e.preventDefault());break;case"Escape":t.editNewValue=t.editOldValue,t.removeGridEditor(),e.stopPropagation(),e.preventDefault();break;case"Tab":t.modifyCell(),n=t.getTabCell(r,e.shiftKey),t.selectCell(n),e.stopPropagation(),e.preventDefault();break;case"F2":t.modifyCell(),e.stopPropagation(),e.preventDefault()}})),e.addEventListener("input",(function(e){const o=t.activeGrid.gId;t.doEventWithCheckChanged(o,"_onInputEditor",e)}))},setBagicAttributesToGridEditor(e,t){e.eId=t.gId+"_Editor",e.gId=t.gId,e.targetCell=t,e.style.width=t.offsetWidth+"px",e.style.height=t.scrollHeight+e.offsetHeight-e.clientHeight+"px",e.classList.add(e.gId+"_editor")},createGridEditorTextarea(e){const o=document.createElement("textarea");this.setBagicAttributesToGridEditor(o,e),o.placeholder,o.classList.add(o.gId+"_editor_textarea");const l=this[e.gId].info.gNullValue===e.cValue?null:e.cValue;return this.editOldValue=l,o.value=this.editOldValue,o.addEventListener("input",(function(e){e.target.style.height=e.target.scrollHeight+o.offsetHeight-o.clientHeight+"px"}),!1),o.addEventListener("keyup",(function(e){e.target.value&&e.target.parentNode&&e.target.parentNode.cMaxLength&&(e.target.value=e.target.value.substring(0,e.target.parentNode.cMaxLength)),e.target.value&&e.target.parentNode&&e.target.parentNode.cMaxByte&&(e.target.value=t.getCutByteLength(e.target.value,e.target.parentNode.cMaxByte))}),!1),this.addBagicEventListenerToGridEditor(o),o},createGridEditorNumber(e){const t=document.createElement("input");this.setBagicAttributesToGridEditor(t,e),t.classList.add(t.gId+"_editor_number"),t.setAttribute("type","number");const o=this[e.gId].info.gNullValue===e.cValue?null:e.cValue;return this.editOldValue=o,t.value=this.editOldValue,this.addBagicEventListenerToGridEditor(t),t},createGridEditorDate(e){const t=document.createElement("input");return this.setBagicAttributesToGridEditor(t,e),t.classList.add(t.gId+"_editor_date"),t.setAttribute("type","date"),this.editOldValue=this.getDateWithInputDateFormat(e.cValue),t.value=this.editOldValue,this.addBagicEventListenerToGridEditor(t),t},createGridEditorMonth(e){const t=document.createElement("input");return this.setBagicAttributesToGridEditor(t,e),t.classList.add(t.gId+"_editor_month"),t.setAttribute("type","month"),this.editOldValue=this.getDateWithInputMonthFormat(e.cValue),t.value=this.editOldValue,this.addBagicEventListenerToGridEditor(t),t},createGridEditorMask(e){const o=document.createElement("input");this.setBagicAttributesToGridEditor(o,e),o.classList.add(o.gId+"_editor_mask"),o.setAttribute("type","text");const l=this[e.gId].info.gNullValue===e.cValue?null:e.cValue;return this.editOldValue=l,o.value=this.editOldValue,o.addEventListener("keyup",(function(e){e.target.value=t.getMaskValue(e.target.targetCell.cFormat,e.target.value)})),this.addBagicEventListenerToGridEditor(o),o},createGridEditorCode(e){const t=document.createElement("input");this.setBagicAttributesToGridEditor(t,e),t.classList.add(t.gId+"_editor_code"),t.setAttribute("type","text");const o=e.cValue;return this.editOldValue=o,t.value=this.editOldValue,this.addBagicEventListenerToGridEditor(t),t},createGridEditor(o,l=!1){if(o.cLocked||o.cUntarget)return;if(["select","checkbox","button","link"].indexOf(o.cDataType)>=0)return;let r;switch(this.removeGridEditor(),o.cDataType){case"text":r=this.createGridEditorTextarea(o);break;case"number":r=this.createGridEditorNumber(o);break;case"date":r=this.createGridEditorDate(o);break;case"month":r=this.createGridEditorMonth(o);break;case"mask":r=this.createGridEditorMask(o);break;case"code":r=this.createGridEditorCode(o);break;default:Object.keys(e.dataType).forEach((l=>{if(o.cDataType===l&&e.dataType[l].getEditor){if("function"!=typeof e.dataType[l].getEditor)throw new Error("getEditor must be a function.");const n=()=>{t.editNewValue=t.editOldValue,t.removeGridEditor()},i=()=>{this.modifyCell()};if(r=e.dataType[l].getEditor(o,this[o.gId]._getData(o),(()=>{i()}),(()=>{n()})),!(r instanceof HTMLElement)||1!==r.nodeType)throw new Error("getEditor must return an html element.");r.eId=o.gId+"_Editor",r.gId=o.gId,r.targetCell=o,r.classList.add(r.gId+"_editor_"+l),r.classList.add(r.gId+"_editor"),this.editOldValue=o.cValue}}))}!1!==this.doEventWithCheckChanged(o.gId,"_onEditEnter",o.row,o.cId,r)&&r&&(o.style.padding="0",o.style.fontSize="0px",o.appendChild(r),r.focus(),l&&r.select(),this.activeGridEditor=r,this.doEventWithCheckChanged(o.gId,"_onEditEnter",o.row,o.cId,r))},getValidValue(t,o){const l=this.nvl(this[t.gId].info.gNullValue,null);if(!t)return null;if("code"!==t.cDataType){if(null==o||""===o)return l;if(o===l)return l}switch(t.cDataType){case"text":return t.cMaxLength&&(o=o.substring(0,t.cMaxLength)),t.cMaxByte&&(o=this.getCutByteLength(o,t.cMaxByte)),o;case"mask":return this.nvl(this.getMaskValue(t.cFormat,o),l);case"date":return this.nvl(this.getDateWithValueDateFormat(o),l);case"month":return this.nvl(this.getDateWithValueMonthFormat(o),l);case"number":if(null===(o=this.getOnlyNumberWithNaNToNull(o)))return l;const r=t.cMaxNumber,n=t.cMinNumber,i=t.cRoundNumber;null!=r&&"number"==typeof r&&o>r&&(o=r),null!=n&&"number"==typeof n&&o<n&&(o=n);let a=parseFloat(o);if(null==i||"number"!=typeof i)return Number(o);if(i>=0){let e=a.toFixed(i);return e=e.replace(/(\.[0-9]*?)0+$/,"$1"),e=e.replace(/\.$/,""),Number(e)}{const e=Math.pow(10,-i);return Number((Math.round(a/e)*e).toFixed(-i))}case"select":case"button":case"link":return o;case"checkbox":if("boolean"==typeof o)return o;return this[t.gId].info.gCheckedValue===o;case"code":return this.getCodeValue(t.cCodes,t.cDefaultCode,o);default:return e.dataType&&Object.keys(e.dataType).forEach((l=>{if(t.cDataType===l&&e.dataType[l].getValue){if("function"!=typeof e.dataType[l].getValue)throw new Error("getValue must be a function.");o=e.dataType[l].getValue(o)}})),o}},getCellText(o){if(!o)return null;let l=null;const r=this[o.gId];let n=this.nvl(o.cValue,r.info.gNullValue);switch(o.cDataType){case"number":l=n===r.info.gNullValue?n:t.nvl(this.getFormatNumber(o),r.info.gNullValue);break;case"date":l=n===r.info.gNullValue?n:t.nvl(this.getDateWithGridDateFormat(o),r.info.gNullValue);break;case"month":l=n===r.info.gNullValue?n:t.nvl(this.getDateWithGridMonthFormat(o),r.info.gNullValue);break;case"select":if(Array.isArray(o.cValue)&&o.cValue.length>0){l=o.cValue[0].text;for(const e of o.cValue)e.selected&&(l=e.text);null==l&&(l=r.info.gNullValue)}break;case"link":l=o.cValue&&o.cValue.text?o.cValue.text:n;break;default:l=n,e.dataType&&Object.keys(e.dataType).forEach((t=>{if(o.cDataType===t&&e.dataType[t].getText){if("function"!=typeof e.dataType[t].getText)throw new Error("getText must be a function.");l=e.dataType[t].getText(l)}}))}return l},selectAndCheckboxOnChange(e){if(!e.nType)return;const o=e.parentNode;let l=!0;if("select"===e.nType?t.editNewValue=e.value:"checkbox"===e.nType&&(t.editNewValue=e.checked?t[e.parentNode.gId].info.gCheckedValue:t[e.parentNode.gId].info.gUncheckedValue),!1===this.doEventWithCheckChanged(o.gId,"_onBeforeChange",o.row,o.cId,t.editOldValue,t.editNewValue)&&(l=!1),!l||o.cUntarget||o.cLocked){switch(e.nType){case"select":e.value=t.editOldValue;break;case"checkbox":e.checked=!e.checked}return t.editOldValue=null,!1}switch(e.nType){case"select":t.recodeGridModify(o.gId,t.getRecodesWithModifyValue(o,t.getSelectOptions(e)));break;case"checkbox":t.recodeGridModify(o.gId,t.getRecodesWithModifyValue(o,t.editNewValue))}this.doEventWithCheckChanged(o.gId,"_onAfterChange",o.row,o.cId,t.editOldValue,t.editNewValue)},getFormatNumber(e){if(!e.cFormat)return e.cValue;if(null===e.cValue||void 0===e.cValue)return null;let t=e.cValue;const o=e.cFormat.match(/^(.*?)([#0,.]+)(.*?)$/);if(!o)return Number(e.cValue);const l=e=>isNaN(e)||!isFinite(e)?0:Number(e),r=e=>isNaN(e)||!isFinite(e)?0:parseFloat(e),n=o[1],i=o[2],a=o[3],s=i.split(".")[0],c=i.split(".").length>1?i.split(".")[1]:"";"%"!==a&&" %"!==a||(t*=100);let d=String(t);const u="-"===d[0];d=u?d.substring(1):d;let C,f=d.split(".")[0],g=d.split(".").length>1?d.split(".")[1]:"";switch(g=r("0."+g).toLocaleString("en",{minimumFractionDigits:c.lastIndexOf("0")+1,maximumFractionDigits:c.length}),g="0"===g?"":g.substring(1),s){case"#,###":0===l(f)?C=g:(f=r(f).toLocaleString("en"),C=f+g);break;case"#,##0":f=r(f).toLocaleString("en"),C=f+g;break;case"#":C=0===l(f)?g:f+g;break;case"0":C=f+g;break;default:return e.cValue}return C=u?"-"+C:C,n+C+a},getCellChildNode(o){if(!o)return null;const l=o.gId;let r;switch(o.cDataType){case"text":r=document.createElement("span"),r.classList.add(l+"_data-value-text"),r.innerText=o.cValue,r.nType="text";break;case"number":r=document.createElement("span"),r.classList.add(l+"_data-value-number"),null===o.cValue||void 0===o.cValue||o.cValue===this[l].info.gNullValue?r.innerText=this[l].info.gNullValue:r.innerText=t.getFormatNumber(o),r.nType="number";break;case"mask":r=document.createElement("span"),r.classList.add(l+"_data-value-mask"),r.innerText=o.cValue,r.nType="mask";break;case"date":r=document.createElement("span"),r.classList.add(l+"_data-value-date"),null===o.cValue||void 0===o.cValue||o.cValue===this[l].info.gNullValue?r.innerText=this[l].info.gNullValue:r.innerText=t.getDateWithGridDateFormat(o),r.nType="date";break;case"month":r=document.createElement("span"),r.classList.add(l+"_data-value-month"),null===o.cValue||void 0===o.cValue||o.cValue===this[l].info.gNullValue?r.innerText=this[l].info.gNullValue:r.innerText=t.getDateWithGridMonthFormat(o),r.nType="month";break;case"select":Array.isArray(o.cValue)&&o.cValue.length>0?(r=document.createElement("select"),r.classList.add(l+"_data-value-select"),r.addEventListener("change",(function(e){t.selectAndCheckboxOnChange(e.target)})),this.setSelectOptions(r,o.cValue),r.nType="select",o.cSelectSize&&(r.style.width=o.cSelectSize)):(r=document.createElement("span"),r.classList.add(l+"_data-value-text"),r.innerText=this[l].info.gNullValue,r.nType="text");break;case"checkbox":r=document.createElement("input"),r.classList.add(l+"_data-value-checkbox"),r.addEventListener("change",(function(e){t.selectAndCheckboxOnChange(e.target)})),r.type="checkbox",r.nType="checkbox",this.getCheckboxCellTrueOrFalse(o)&&r.setAttribute("checked","");break;case"button":null===o.cValue||void 0===o.cValue||o.cValue===this[l].info.gNullValue?(r=document.createElement("span"),r.classList.add(l+"_data-value-text"),r.innerText=this[l].info.gNullValue,r.nType="text"):(r=document.createElement("button"),r.classList.add(l+"_data-value-button"),r.innerText=o.cValue,r.nType="button");break;case"link":null===o.cValue||void 0===o.cValue||o.cValue===this[l].info.gNullValue?(r=document.createElement("span"),r.classList.add(l+"_data-value-text"),r.innerText=this[l].info.gNullValue,r.nType="text"):(r=document.createElement("a"),r.classList.add(l+"_data-value-link"),r.innerText=o.cValue.text,r.setAttribute("href",o.cValue.value),r.setAttribute("target",o.cValue.target?o.cValue.target:"_blank"),r.nType="link");break;case"code":r=document.createElement("span"),r.classList.add(l+"_data-value-code"),r.innerText=o.cValue,r.nType="code";break;default:e.dataType&&Object.keys(e.dataType).forEach((t=>{if(t===o.cDataType){if(e.dataType[t].getChildNode){if("function"!=typeof e.dataType[t].getChildNode)throw new Error("getChildNode must be a function.");if(r=e.dataType[t].getChildNode(this[l]._getData(o)),!(r instanceof HTMLElement)||1!==r.nodeType)throw new Error("getChildNode must return an html element.")}else r=document.createElement("span"),r.innerText=o.cValue;r.classList.add(l+"_data-value-"+t),r.nType=t}}))}return r.classList.add(l+"_data-value"),r.gType="gbdv",r},getDateWithValueDateFormat(e){const t=/^(\d{4})[-/.]? ?(\d{2})[-/.]? ?(\d{2})$/.exec(e.replace(/\s+/g,""));if(!t)return null;const o=t[1],l=t[2],r=t[3];return this.isValidDate(o,l,r)?`${o}${l}${r}`:null},getDateWithValueMonthFormat(e){e=e.replace(/\s+/g,"");const t=/^(\d{4})[-/.]? ?(\d{2})[-/.]? ?(\d{2})?$/.exec(e),o=/^(\d{4})[-/.]? ?(\d{2})$/.exec(e);let l,r;if(t)l=t[1],r=t[2];else{if(!o)return null;l=o[1],r=o[2]}return this.isValidDate(l,r,"01")?`${l}${r}`:null},getDateWithInputDateFormat(e){const t=/^(\d{4})[-/.]?(\d{2})[-/.]?(\d{2})$/.exec(e);if(!t)return null;const o=t[1],l=t[2],r=t[3];return this.isValidDate(o,l,r)?`${o}-${l}-${r}`:null},getDateWithInputMonthFormat(e){const t=/^(\d{4})[-/.]?(\d{2})$/.exec(e);if(!t)return null;const o=t[1],l=t[2];return this.isValidDate(o,l,"01")?`${o}-${l}`:null},getDateWithGridDateFormat(e){const t=/^(\d{4})[-/.]?(\d{2})[-/.]?(\d{2})$/.exec(e.cValue);if(!t)return null;const o=t[1],l=t[2],r=t[3];if(!this.isValidDate(o,l,r))return null;switch(this[e.gId].info.gDateFormat){case"yyyy-mm-dd":default:return`${o}-${l}-${r}`;case"yyyy/mm/dd":return`${o}/${l}/${r}`;case"yyyy. mm. dd":return`${o}. ${l}. ${r}`;case"yyyymmdd":return`${o}${l}${r}`}},getDateWithGridMonthFormat(e){const t=/^(\d{4})[-/.]?(\d{2})$/.exec(e.cValue);if(!t)return null;const o=t[1],l=t[2];if(!this.isValidDate(o,l,"01"))return null;switch(this[e.gId].info.gMonthFormat){case"yyyy-mm":default:return`${o}-${l}`;case"yyyy. mm":return`${o}. ${l}`;case"yyyy/mm":return`${o}/${l}`;case"yyyymm":return`${o}${l}`}},getCodeValue:(e,t,o)=>e&&Array.isArray(e)&&e.indexOf(o)>=0?o:t,getMaskValue(e,o){if("string"!=typeof e)return null;if("string"!=typeof o)return null;const l=e.split(""),r=o.split("");let n,i="";return l.every(((e,o)=>{switch(n=!1,e){case"A":/^[A-Z]$/.test(r[o])?(i+=r[o],n=!0):/^[a-z]$/.test(r[o])&&(i+=t.toUpperCase(r[o]),n=!0);break;case"a":/^[a-z]$/.test(r[o])?(i+=r[o],n=!0):/^[A-Z]$/.test(r[o])&&(i+=t.toLowerCase(r[o]),n=!0);break;case"9":/^[0-9]$/.test(r[o])&&(i+=r[o],n=!0);break;default:e===r[o]&&(i+=r[o],n=!0)}return n})),i},setSelectOptions(e,t){Array.isArray(t)&&(this.removeAllChild(e),t.forEach((t=>{option=document.createElement("option"),option.value=t.value,option.textContent=t.text,t.selected&&option.setAttribute("selected",""),t.disabled&&option.setAttribute("disabled",""),t.label&&option.setAttribute("label",t.label),e.appendChild(option)})))},getSelectOptions(e){if(!e)return null;const t=e.options;if(!t)return null;const o=[];for(const e of t){let t={};t.value=e.value,t.text=e.textContent,e.selected&&(t.selected=!0),e.disabled&&(t.disabled=!0),e.label&&(t.label=e.label),o.push(t)}return 0===o.length?null:o},doEventWithCheckChanged(e,t,...o){if(this[e].events[e+t]!==window[e+t])throw new Error("Abnormal access has been detected. An initially defined event has changed. \nevent : "+e+t);return window[e+t](...o)}},o=Object.freeze({PIXEL:"px",PERCENT:"%"}),l={TEXT:"text",NUMBER:"number",DATE:"date",MONTH:"month",MASK:"mask",SELECT:"select",CHECKBOX:"checkbox",BUTTON:"button",LINK:"link",CODE:"code"};e.dataType&&Object.keys(e.dataType).forEach((e=>{l[t.toUpperCase(e)]=e})),Object.freeze(l);const r=Object.freeze({LEFT:"left",CENTER:"center",RIGHT:"right"}),n=Object.freeze({TOP:"top",CENTER:"center",BOTTOM:"bottom"}),i=Object.freeze({MAX:"$$MAX",MIN:"$$MIN",SUM:"$$SUM",AVG:"$$AVG"}),a=Object.freeze({CREATE:"C",UPDATE:"U",DELETE:"D"}),s=Object.freeze({SINGLE:"single",RANGE:"range",NONE:"none"}),c=document.querySelectorAll("vanilla-grid");let d=[];for(vanillagrid of c)d.push(vanillagrid.getAttribute("id"));if(new Set(d).size!==d.length)throw new Error("There is a duplicate grid ID.");for(vanillagrid of c){const i=[],c=[],d=[];let u,C;const f=[];let g=0,h=0;const b=t.getAttributeWithCheckRequired("id",vanillagrid);vanillagrid.classList.add(b+"_vanillagrid");const v=document.createElement("v-g");if(v.info={},v.gId=b,v.info.gIndex=1,v.info.gType="g",v.info.gName=t.nvl(vanillagrid.getAttribute("name"),b),v.info.gLocked=t.nvl(t.getAttributeOnlyBoolean("locked",vanillagrid),e.defaultGridInfo.locked),v.info.gLockedColor=t.nvl(t.getAttributeOnlyBoolean("lockedColor",vanillagrid),e.defaultGridInfo.lockedColor),v.info.gResizable=t.nvl(t.getAttributeOnlyBoolean("resizable",vanillagrid),e.defaultGridInfo.resizable),v.info.gRedoable=t.nvl(t.getAttributeOnlyBoolean("redoable",vanillagrid),e.defaultGridInfo.redoable),v.info.gRedoCount=t.nvl(t.getAttributeOnlyNumberIntegerOrZero("redoCount",vanillagrid),e.defaultGridInfo.redoCount),v.info.gVisible=t.nvl(t.getAttributeOnlyBoolean("visible",vanillagrid),e.defaultGridInfo.visible),v.info.gRownumVisible=t.nvl(t.getAttributeOnlyBoolean("rownumVisible",vanillagrid),e.defaultGridInfo.rownumVisible),v.info.gRownumSize=t.nvl(vanillagrid.getAttribute("rownumSize"),e.defaultGridInfo.rownumSize),v.info.gRownumLockedColor=t.nvl(t.getAttributeOnlyBoolean("rownumLockedColor",vanillagrid),v.info.gLocked),v.info.gStatusVisible=t.nvl(t.getAttributeOnlyBoolean("statusVisible",vanillagrid),e.defaultGridInfo.statusVisible),v.info.gStatusLockedColor=t.nvl(t.getAttributeOnlyBoolean("statusLockedColor",vanillagrid),v.info.gLocked),v.info.gSelectionPolicy=t.nvl(t.isIncludeEnum(s,t.toLowerCase(vanillagrid.getAttribute("selectionPolicy")))?t.toLowerCase(vanillagrid.getAttribute("selectionPolicy")):"",e.defaultGridInfo.selectionPolicy),v.info.gNullValue=t.nvl(vanillagrid.getAttribute("nullValue"),e.defaultGridInfo.nullValue),v.info.gDateFormat=t.nvl(vanillagrid.getAttribute("dateFormat"),e.defaultGridInfo.dateFormat),v.info.gMonthFormat=t.nvl(vanillagrid.getAttribute("monthFormat"),e.defaultGridInfo.monthFormat),v.info.gAlterRow=t.nvl(t.getAttributeOnlyBoolean("alterRow",vanillagrid),e.defaultGridInfo.alterRow),v.info.gFrozenColCount=t.nvl(t.getAttributeOnlyNumberIntegerOrZero("frozenColCount",vanillagrid),e.defaultGridInfo.frozenColCount),v.info.gFrozenRowCount=t.nvl(t.getAttributeOnlyNumberIntegerOrZero("frozenRowCount",vanillagrid),e.defaultGridInfo.frozenRowCount),v.info.gSortable=t.nvl(t.getAttributeOnlyBoolean("sortable",vanillagrid),e.defaultGridInfo.sortable),v.info.gFilterable=t.nvl(t.getAttributeOnlyBoolean("filterable",vanillagrid),e.defaultGridInfo.filterable),v.info.gAllCheckable=t.nvl(t.getAttributeOnlyBoolean("allCheckable",vanillagrid),e.defaultGridInfo.allCheckable),v.info.gCheckedValue=t.nvl(vanillagrid.getAttribute("checkedValue"),e.defaultGridInfo.checkedValue),v.info.gUncheckedValue=t.nvl(vanillagrid.getAttribute("uncheckedValue"),e.defaultGridInfo.uncheckedValue),v.info.gCheckedValue===v.info.gUncheckedValue)throw new Error("Checked and unchecked values cannot be the same.");v.cssInfo={},v.cssInfo.width=t.nvl(vanillagrid.getAttribute("width"),e.defaultGridCssInfo.width),v.cssInfo.height=t.nvl(vanillagrid.getAttribute("height"),e.defaultGridCssInfo.height),v.cssInfo.margin=t.nvl(vanillagrid.getAttribute("margin"),e.defaultGridCssInfo.margin),v.cssInfo.padding=t.nvl(vanillagrid.getAttribute("padding"),e.defaultGridCssInfo.padding),v.cssInfo.sizeLevel=t.nvl(t.getAttributeOnlyNumberIntegerOrZero("sizeLevel",vanillagrid),e.defaultGridCssInfo.sizeLevel),v.cssInfo.verticalAlign=t.nvl(t.isIncludeEnum(n,t.toLowerCase(vanillagrid.getAttribute("verticalAlign")))?t.toLowerCase(vanillagrid.getAttribute("verticalAlign")):"",e.defaultGridCssInfo.verticalAlign),v.cssInfo.cellFontSize=t.nvl(vanillagrid.getAttribute("cellFontSize"),(v.cssInfo.sizeLevel+15)/20*e.defaultGridCssInfo.cellFontSize+"px"),v.cssInfo.cellMinHeight=t.nvl(vanillagrid.getAttribute("cellMinHeight"),(v.cssInfo.sizeLevel+15)/20*e.defaultGridCssInfo.cellMinHeight+"px"),v.cssInfo.horizenBorderSize=t.nvl(t.getAttributeOnlyNumberIntegerOrZero("horizenBorderSize",vanillagrid),e.defaultGridCssInfo.horizenBorderSize),v.cssInfo.verticalBorderSize=t.nvl(t.getAttributeOnlyNumberIntegerOrZero("verticalBorderSize",vanillagrid),e.defaultGridCssInfo.verticalBorderSize),v.cssInfo.gridFontFamily=t.nvl(vanillagrid.getAttribute("gridFontFamily"),e.defaultGridCssInfo.gridFontFamily),v.cssInfo.editorFontFamily=t.nvl(vanillagrid.getAttribute("editorFontFamily"),e.defaultGridCssInfo.editorFontFamily),v.cssInfo.color=t.nvl(vanillagrid.getAttribute("color"),e.defaultGridCssInfo.color),v.cssInfo.colorSet=t.nvl(vanillagrid.getAttribute("colorSet"),e.defaultGridCssInfo.colorSet),v.cssInfo.linkHasUnderLine=t.nvl(t.getAttributeOnlyBoolean("linkHasUnderLine",vanillagrid),e.defaultGridCssInfo.linkHasUnderLine),v.cssInfo.invertColor=t.nvl(t.getAttributeOnlyBoolean("invertColor",vanillagrid),e.defaultGridCssInfo.invert),v.cssInfo.colorSet?(v.cssInfo.color=t.getColorFromColorSet(v.cssInfo.colorSet),t.setColorSet(v.cssInfo)):t.setColorSet(v.cssInfo),v.cssInfo.gridBorderColor=t.nvl(vanillagrid.getAttribute("gridBorderColor"),t.nvl(e.defaultGridCssInfo.gridBorderColor,v.cssInfo.gridBorderColor)),v.cssInfo.headerCellBackColor=t.nvl(vanillagrid.getAttribute("headerCellBackColor"),t.nvl(e.defaultGridCssInfo.headerCellBackColor,v.cssInfo.headerCellBackColor)),v.cssInfo.headerCellBorderColor=t.nvl(vanillagrid.getAttribute("headerCellBorderColor"),t.nvl(e.defaultGridCssInfo.headerCellBorderColor,v.cssInfo.headerCellBorderColor)),v.cssInfo.headerCellFontColor=t.nvl(vanillagrid.getAttribute("headerCellFontColor"),t.nvl(e.defaultGridCssInfo.headerCellFontColor,v.cssInfo.headerCellFontColor)),v.cssInfo.footerCellBackColor=t.nvl(vanillagrid.getAttribute("footerCellBackColor"),t.nvl(e.defaultGridCssInfo.footerCellBackColor,v.cssInfo.footerCellBackColor)),v.cssInfo.footerCellBorderColor=t.nvl(vanillagrid.getAttribute("footerCellBorderColor"),t.nvl(e.defaultGridCssInfo.footerCellBorderColor,v.cssInfo.footerCellBorderColor)),v.cssInfo.footerCellFontColor=t.nvl(vanillagrid.getAttribute("footerCellFontColor"),t.nvl(e.defaultGridCssInfo.footerCellFontColor,v.cssInfo.footerCellFontColor)),v.cssInfo.bodyBackColor=t.nvl(vanillagrid.getAttribute("bodyBackColor"),t.nvl(e.defaultGridCssInfo.bodyBackColor,v.cssInfo.bodyBackColor)),v.cssInfo.bodyCellBackColor=t.nvl(vanillagrid.getAttribute("bodyCellBackColor"),t.nvl(e.defaultGridCssInfo.bodyCellBackColor,v.cssInfo.bodyCellBackColor)),v.cssInfo.bodyCellBorderColor=t.nvl(vanillagrid.getAttribute("bodyCellBorderColor"),t.nvl(e.defaultGridCssInfo.bodyCellBorderColor,v.cssInfo.bodyCellBorderColor)),v.cssInfo.bodyCellFontColor=t.nvl(vanillagrid.getAttribute("bodyCellFontColor"),t.nvl(e.defaultGridCssInfo.bodyCellFontColor,v.cssInfo.bodyCellFontColor)),v.cssInfo.editorBackColor=t.nvl(vanillagrid.getAttribute("editorBackColor"),t.nvl(e.defaultGridCssInfo.editorBackColor,v.cssInfo.editorBackColor)),v.cssInfo.editorFontColor=t.nvl(vanillagrid.getAttribute("editorFontColor"),t.nvl(e.defaultGridCssInfo.editorFontColor,v.cssInfo.editorFontColor)),v.cssInfo.selectCellBackColor=t.nvl(vanillagrid.getAttribute("selectCellBackColor"),t.nvl(e.defaultGridCssInfo.selectCellBackColor,v.cssInfo.selectCellBackColor)),v.cssInfo.selectCellFontColor=t.nvl(vanillagrid.getAttribute("selectCellFontColor"),t.nvl(e.defaultGridCssInfo.selectCellFontColor,v.cssInfo.selectCellFontColor)),v.cssInfo.selectColBackColor=t.nvl(vanillagrid.getAttribute("selectColBackColor"),t.nvl(e.defaultGridCssInfo.selectColBackColor,v.cssInfo.selectColBackColor)),v.cssInfo.selectColFontColor=t.nvl(vanillagrid.getAttribute("selectColFontColor"),t.nvl(e.defaultGridCssInfo.selectColFontColor,v.cssInfo.selectColFontColor)),v.cssInfo.selectRowBackColor=t.nvl(vanillagrid.getAttribute("selectRowBackColor"),t.nvl(e.defaultGridCssInfo.selectRowBackColor,v.cssInfo.selectRowBackColor)),v.cssInfo.selectRowFontColor=t.nvl(vanillagrid.getAttribute("selectRowFontColor"),t.nvl(e.defaultGridCssInfo.selectRowFontColor,v.cssInfo.selectRowFontColor)),v.cssInfo.mouseoverCellBackColor=t.nvl(vanillagrid.getAttribute("mouseoverCellBackColor"),t.nvl(e.defaultGridCssInfo.mouseoverCellBackColor,v.cssInfo.mouseoverCellBackColor)),v.cssInfo.mouseoverCellFontColor=t.nvl(vanillagrid.getAttribute("mouseoverCellFontColor"),t.nvl(e.defaultGridCssInfo.mouseoverCellFontColor,v.cssInfo.mouseoverCellFontColor)),v.cssInfo.lockCellBackColor=t.nvl(vanillagrid.getAttribute("lockCellBackColor"),t.nvl(e.defaultGridCssInfo.lockCellBackColor,v.cssInfo.lockCellBackColor)),v.cssInfo.lockCellFontColor=t.nvl(vanillagrid.getAttribute("lockCellFontColor"),t.nvl(e.defaultGridCssInfo.lockCellFontColor,v.cssInfo.lockCellFontColor)),v.cssInfo.alterRowBackColor=t.nvl(vanillagrid.getAttribute("alterRowBackColor"),t.nvl(e.defaultGridCssInfo.alterRowBackColor,v.cssInfo.alterRowBackColor)),v.cssInfo.alterRowFontColor=t.nvl(vanillagrid.getAttribute("alterRowFontColor"),t.nvl(e.defaultGridCssInfo.alterRowFontColor,v.cssInfo.alterRowFontColor)),v.cssInfo.buttonFontColor=t.nvl(vanillagrid.getAttribute("buttonFontColor"),t.nvl(e.defaultGridCssInfo.buttonFontColor,v.cssInfo.buttonFontColor)),v.cssInfo.buttonBorderColor=t.nvl(vanillagrid.getAttribute("buttonBorderColor"),t.nvl(e.defaultGridCssInfo.buttonBorderColor,v.cssInfo.buttonBorderColor)),v.cssInfo.buttonBackColor=t.nvl(vanillagrid.getAttribute("buttonBackColor"),t.nvl(e.defaultGridCssInfo.buttonBackColor,v.cssInfo.buttonBackColor)),v.cssInfo.buttonHoverFontColor=t.nvl(vanillagrid.getAttribute("buttonHoverFontColor"),t.nvl(e.defaultGridCssInfo.buttonHoverFontColor,v.cssInfo.buttonHoverFontColor)),v.cssInfo.buttonHoverBackColor=t.nvl(vanillagrid.getAttribute("buttonHoverBackColor"),t.nvl(e.defaultGridCssInfo.buttonHoverBackColor,v.cssInfo.buttonHoverBackColor)),v.cssInfo.buttonActiveFontColor=t.nvl(vanillagrid.getAttribute("buttonActiveFontColor"),t.nvl(e.defaultGridCssInfo.buttonActiveFontColor,v.cssInfo.buttonActiveFontColor)),v.cssInfo.buttonActiveBackColor=t.nvl(vanillagrid.getAttribute("buttonActiveBackColor"),t.nvl(e.defaultGridCssInfo.buttonActiveBackColor,v.cssInfo.buttonActiveBackColor)),v.cssInfo.linkFontColor=t.nvl(vanillagrid.getAttribute("linkFontColor"),t.nvl(e.defaultGridCssInfo.linkFontColor,v.cssInfo.linkFontColor)),v.cssInfo.linkHoverFontColor=t.nvl(vanillagrid.getAttribute("linkHoverFontColor"),t.nvl(e.defaultGridCssInfo.linkHoverFontColor,v.cssInfo.linkHoverFontColor)),v.cssInfo.linkActiveFontColor=t.nvl(vanillagrid.getAttribute("linkActiveFontColor"),t.nvl(e.defaultGridCssInfo.linkActiveFontColor,v.cssInfo.linkActiveFontColor)),v.cssInfo.linkVisitedFontColor=t.nvl(vanillagrid.getAttribute("linkVisitedFontColor"),t.nvl(e.defaultGridCssInfo.linkVisitedFontColor,v.cssInfo.linkVisitedFontColor)),v.cssInfo.linkFocusFontColor=t.nvl(vanillagrid.getAttribute("linkFocusFontColor"),t.nvl(e.defaultGridCssInfo.linkFocusFontColor,v.cssInfo.linkFocusFontColor)),v.cssInfo.invertColor&&t.setInvertColor(v.cssInfo),v.classList.add(b+"_v-g");const I=document.createElement("v-g-h");I.gId=b,I.gType="gh",I.classList.add(b+"_v-g-h");const w=document.createElement("v-g-b");w.gId=b,w.gType="gb",w.classList.add(b+"_v-g-b");const _=document.createElement("v-g-f");_.gId=b,_.gType="gf",_.classList.add(b+"_v-g-f");let p,y=1,m=0;Array.from(vanillagrid.querySelectorAll("v-col")).forEach((e=>{if(!e.getAttribute("header"))throw new Error("Column header is required.");if(y=y>e.getAttribute("header").split(";").length?y:e.getAttribute("header").split(";").length,e.getAttribute("footer")&&(m=m>e.getAttribute("footer").split(";").length?m:e.getAttribute("footer").split(";").length),p=e.getAttribute("width")?" "+e.getAttribute("width"):" 80px",!t.isIncludeEnum(o,t.extractNumberAndUnit(p).unit))throw new Error("Width units can only be pixel or %.")}));let k=v.info.gRownumVisible?v.info.gRownumSize+" ":"0px ",x=v.info.gStatusVisible?"60px ":"0px ",F={cId:"v-g-rownum",cIndex:1,cName:"status"};F.cHeader=new Array(y),F.cHeader[0]="",F.cUntarget=!1,F.cRowMerge=!1,F.cColMerge=!1,F.cColVisible=v.info.gRownumVisible,F.cRowVisible=!0,F.cRequired=!1,F.cResizable=!1,F.cSortable=!1,F.cFilterable=!1,F.cOriginWidth=k,F.cDataType="text",F.cSelectSize=null,F.cLocked=!0,F.cLockedColor=v.info.gRownumLockedColor,F.cFormat=null,F.cCodes=null,F.cDefaultCode=null,F.cMaxLength=null,F.cMaxByte=null,F.cMaxNumber=null,F.cMinNumber=null,F.cRoundNumber=null,F.cFilterValues=null,F.cFilterValue=null,F.cFilter=!1,F.cAlign="center",F.cVerticalAlign=null,F.cBackColor=null,F.cFontColor=null,F.cFontBold=!1,F.cFontItalic=!1,F.cFontThruline=!1,F.cFontUnderline=!1,f.push(F),F={},F.cId="v-g-status",F.cIndex=2,F.cName="status",F.cHeader=new Array(y),F.cHeader[0]="status",F.cUntarget=!0,F.cRowMerge=!1,F.cColMerge=!1,F.cColVisible=v.info.gStatusVisible,F.cRowVisible=!0,F.cRequired=!1,F.cResizable=!1,F.cSortable=!1,F.cFilterable=!1,F.cOriginWidth=x,F.cDataType="code",F.cSelectSize=null,F.cLocked=!0,F.cLockedColor=v.info.gStatusLockedColor,F.cFormat=null,F.cCodes=["C","U","D"],F.cDefaultCode=null,F.cMaxLength=null,F.cMaxByte=null,F.cMaxNumber=null,F.cMinNumber=null,F.cRoundNumber=null,F.cFilterValues=null,F.cFilterValue=null,F.cFilter=!1,F.cAlign="center",F.cVerticalAlign=null,F.cBackColor=null,F.cFontColor=null,F.cFontBold=!1,F.cFontItalic=!1,F.cFontThruline=!1,F.cFontUnderline=!1,f.push(F),g=2,Array.from(vanillagrid.querySelectorAll("v-col")).forEach((i=>{if(F={},g++,!i.getAttribute("id"))throw new Error("Column ID is required.");if(f.some((e=>e.cId===i.getAttribute("id"))))throw new Error("Column ID is primary key.");if(F.cId=i.getAttribute("id"),F.cIndex=g,F.cName=t.nvl(t.toLowerCase(i.getAttribute("name")),F.cId),i.getAttribute("header")){F.cHeader=i.getAttribute("header").split(";");for(let e=F.cHeader.length;e<y;e++)F.cHeader.push("")}else F.cHeader=new Array(y),F.cHeader[0]=F.cId;if(i.getAttribute("footer")){F.cFooter=i.getAttribute("footer").split(";");for(let e=F.cFooter.length;e<m;e++)F.cFooter.push("")}const a=t.toLowerCase(i.getAttribute("dataType"));if(!t.isIncludeEnum(l,a))throw new Error("Please insert a valid dataType.");F.cDataType=a,F.cUntarget=t.nvl(t.getAttributeOnlyBoolean("untarget",i),"none"===v.info.gSelectionPolicy),F.cRowMerge=t.nvl(t.getAttributeOnlyBoolean("rowMerge",i),e.defaultColInfo.rowMerge),F.cColMerge=t.nvl(t.getAttributeOnlyBoolean("colMerge",i),e.defaultColInfo.colMerge),F.cColVisible=t.nvl(t.getAttributeOnlyBoolean("visible",i),e.defaultColInfo.colVisible),F.cRowVisible=!0,F.cRequired=t.nvl(t.getAttributeOnlyBoolean("required",i),e.defaultColInfo.required),F.cResizable=t.nvl(t.getAttributeOnlyBoolean("resizable",i),e.defaultColInfo.resizable),F.cSortable=t.nvl(t.getAttributeOnlyBoolean("sortable",i),e.defaultColInfo.sortable),F.cFilterable=t.nvl(t.getAttributeOnlyBoolean("filterable",i),e.defaultColInfo.filterable),"checkbox"===F.cDataType&&(F.cSortable=!1),p=i.getAttribute("width")?" "+i.getAttribute("width"):" "+e.defaultColInfo.originWidth,F.cOriginWidth=p,F.cSelectSize=t.nvl(t.isIncludeEnum(o,t.extractNumberAndUnit(i.getAttribute("selectSize")).unit)?i.getAttribute("selectSize"):"",e.defaultColInfo.selectSize),F.cLocked=t.nvl(t.getAttributeOnlyBoolean("locked",i),v.info.gLocked),F.cLockedColor=t.nvl(t.getAttributeOnlyBoolean("lockedColor",i),v.info.gLockedColor),F.cFormat=t.nvl(i.getAttribute("format"),e.defaultColInfo.format),F.cCodes=i.getAttribute("codes")?i.getAttribute("codes").split(";"):e.defaultColInfo.codes,F.cDefaultCode=t.nvl(i.getAttribute("defaultCode"),e.defaultColInfo.defaultCode),F.cMaxLength=t.nvl(t.getAttributeOnlyNumberIntegerOrZero("maxLength",i),e.defaultColInfo.maxLength),F.cMaxByte=t.nvl(t.getAttributeOnlyNumberIntegerOrZero("maxByte",i),e.defaultColInfo.maxByte),F.cMaxNumber=t.nvl(t.getAttributeOnlyNumber("maxNumber",i),e.defaultColInfo.maxNumber),F.cMinNumber=t.nvl(t.getAttributeOnlyNumber("minNumber",i),e.defaultColInfo.minNumber),F.cRoundNumber=t.nvl(t.getAttributeOnlyNumberInteger("roundNumber",i),e.defaultColInfo.roundNumber),F.cFilterValues=new Set,F.cFilterValue=F.cFilterable?"$$ALL":void 0,F.cFilter=!1,F.cAlign=t.nvl(t.isIncludeEnum(r,t.toLowerCase(i.getAttribute("align")))?t.toLowerCase(i.getAttribute("align")):"",e.defaultColInfo.align),F.cVerticalAlign=t.nvl(t.isIncludeEnum(n,t.toLowerCase(i.getAttribute("verticalAlign")))?t.toLowerCase(i.getAttribute("verticalAlign")):"",e.defaultColInfo.verticalAlign),F.cBackColor=t.nvl(t.toLowerCase(i.getAttribute("backColor")),e.defaultColInfo.backColor),F.cFontColor=t.nvl(t.toLowerCase(i.getAttribute("fontColor")),e.defaultColInfo.fontColor),F.cFontBold=t.nvl(t.getAttributeOnlyBoolean("fontBold",i),e.defaultColInfo.fontBold),F.cFontItalic=t.nvl(t.getAttributeOnlyBoolean("fontItalic",i),e.defaultColInfo.fontItalic),F.cFontThruline=t.nvl(t.getAttributeOnlyBoolean("fontThruline",i),e.defaultColInfo.fontThruline),F.cFontUnderline=t.nvl(t.getAttributeOnlyBoolean("fontUnderline",i),e.defaultColInfo.fontUnderline),f.push(F),vanillagrid.removeChild(i)})),v._getDefaultColInfo=(t,o=!1)=>{if(!t||!t.id)throw new Error("Column ID is required.");if(o)for(const e of f)if(t.id===e.cId)throw new Error("Column ID is primary key.");return resultnewColInfo={},resultnewColInfo.cId=t.id,resultnewColInfo.cName=t.name?t.name:t.id,t.header&&"string"==typeof t.header?resultnewColInfo.cHeader=t.header.split(";"):(resultnewColInfo.cHeader=new Array(v.getHeaderRowCount()),resultnewColInfo.cHeader[0]=t.id),t.footer&&"string"==typeof t.footer&&(resultnewColInfo.cFooter=t.footer.split(";")),resultnewColInfo.cUntarget=t.untarget?t.untarget:"none"===v.info.gSelectionPolicy,resultnewColInfo.cRowMerge=t.rowMerge?t.rowMerge:e.defaultColInfo.rowMerge,resultnewColInfo.cColMerge=t.colMerge?t.colMerge:e.defaultColInfo.colMerge,resultnewColInfo.cColVisible=t.colVisible?t.colVisible:e.defaultColInfo.colVisible,resultnewColInfo.cRequired=t.required?t.required:e.defaultColInfo.required,resultnewColInfo.cResizable=t.resizable?t.resizable:e.defaultColInfo.resizable,resultnewColInfo.cSortable=t.sortable?t.sortable:e.defaultColInfo.sortable,resultnewColInfo.cFilterable=t.filterable?t.filterable:e.defaultColInfo.filterable,resultnewColInfo.cOriginWidth=t.originWidth?t.originWidth:e.defaultColInfo.originWidth,resultnewColInfo.cDataType=t.dataType?t.dataType:e.defaultColInfo.dataType,resultnewColInfo.cSelectSize=t.selectSize?t.selectSize:e.defaultColInfo.selectSize,resultnewColInfo.cLocked=t.locked?t.locked:v.info.gLocked,resultnewColInfo.cLockedColor=t.lockedColor?t.lockedColor:v.info.gLockedColor,resultnewColInfo.cFormat=t.format?t.format:e.defaultColInfo.format,resultnewColInfo.cCodes=t.codes?t.codes:e.defaultColInfo.codes,resultnewColInfo.cDefaultCode=t.defaultCode?t.defaultCode:e.defaultColInfo.defaultCode,resultnewColInfo.cMaxLength=t.maxLength?t.maxLength:e.defaultColInfo.maxLength,resultnewColInfo.cMaxByte=t.maxByte?t.maxByte:e.defaultColInfo.maxByte,resultnewColInfo.cMaxNumber=t.maxNumber?t.maxNumber:e.defaultColInfo.maxNumber,resultnewColInfo.cMinNumber=t.minNumber?t.minNumber:e.defaultColInfo.minNumber,resultnewColInfo.cRoundNumber=t.roundNumber?t.roundNumber:e.defaultColInfo.roundNumber,resultnewColInfo.cAlign=t.align?t.align:e.defaultColInfo.align,resultnewColInfo.cVerticalAlign=t.verticalAlign?t.verticalAlign:e.defaultColInfo.verticalAlign,resultnewColInfo.cBackColor=t.backColor?t.backColor:e.defaultColInfo.backColor,resultnewColInfo.cFontColor=t.fontColor?t.fontColor:e.defaultColInfo.fontColor,resultnewColInfo.cFontBold=t.fontBold?t.fontBold:e.defaultColInfo.fontBold,resultnewColInfo.cFontItalic=t.fontItalic?t.fontItalic:e.defaultColInfo.fontItalic,resultnewColInfo.cFontThruline=t.fontThruline?t.fontThruline:e.defaultColInfo.fontThruline,resultnewColInfo.cFontUnderline=t.fontUnderline?t.fontUnderline:e.defaultColInfo.fontUnderline,resultnewColInfo.cRowVisible=!0,resultnewColInfo.cFilterValues=new Set,resultnewColInfo.cFilterValue=resultnewColInfo.cFilterable?"$$ALL":void 0,resultnewColInfo.cFilter=!1,resultnewColInfo},v._getColInfo=(e,t=!1)=>{let o;if("number"==typeof e)o=f[e-1];else for(const t of f)t.cId===e&&(o=t);if(!o){if(t)throw new Error("There is no "+("number"==typeof e?e+"th":e)+" colunm.");return null}return o},v._getColIndex=(e,t=!1)=>{if("number"==typeof e)return t&&v._checkColIndex(e),e;for(const t of f)if(t.cId===e)return t.cIndex;if(t)throw new Error("There is no "+("number"==typeof e?e+"th":e)+" colunm.");return null},v._setGridColSize=()=>{const e=[];for(const t of f)e.push(t.cColVisible?t.cOriginWidth:"0px");const t=e.join(" ");if(t.includes("%")&&0!==v.info.gFrozenColCount)throw new Error(b+" has error. If you set the horizontal size to a percentage, property A is not available.");I.style.gridTemplateColumns=t,w.style.gridTemplateColumns=t,_.style.gridTemplateColumns=t},v._loadHeader=()=>{for(v._setGridColSize(),t.removeAllChild(I),i.length=0,h=1;h<=v.getHeaderRowCount();h++){C=[],g=1;for(const e of f){if(u=document.createElement("v-g-d"),u.gId=b,u.gType="ghd",Object.keys(e).forEach((t=>{["cHeader","cFooter","cRowMerge","cColMerge","cFilterValue","cIndex"].indexOf(t)<0&&(u[t]=e[t])})),Array.isArray(e.cHeader)?u.cValue=e.cHeader[h-1]?e.cHeader[h-1].replaceAll("\\n","\n"):"":u.cValue=e.cHeader,t.setGridDataRowCol(u,h,g),1!==g){if(!e.cHeader[h-1]){for(let t=h-2;t>=0;t--)e.cHeader[t]&&(u.rowMerge=!0);if(!u.rowMerge)for(let e=g-2;e>=0;e--)f[e].cHeader[h-1]&&(u.colMerge=!0)}}else 1!==h&&(u.rowMerge=!0);u.addEventListener("mousemove",(function(e){if(e.target.style.cursor&&this.style.removeProperty("cursor"),!t[e.target.gId]||!t[e.target.gId].info.gResizable)return;if("ghd"!==e.target.gType)return;const{left:o,right:l}=e.target.getBoundingClientRect(),r=e.clientX;let n,i;if(r-o<20){if(e.target.col<=3)return;if(e.target.frozenCol)return;for(let o=e.target.col-1;o>1&&(i=t[b]._getHeaderCell(1,o),!0!==i.cColVisible);o--);if(!i.cResizable)return;e.target.style.cursor="ew-resize",t.onHeaderDragging=!0,t.isHeaderDragging&&(n=r-t.mouseX,t.modifyColSize(e.target.gId,i,n),t.mouseX=r)}else if(l-r<20){if(e.target.col<3)return;if(e.target.frozenCol)return;for(let o=e.target.col;o>1&&(i=t[b]._getHeaderCell(1,o),!0!==i.cColVisible);o--);if(!i.cResizable)return;e.target.style.cursor="ew-resize",t.onHeaderDragging=!0,t.isHeaderDragging&&(n=r-t.mouseX,t.modifyColSize(e.target.gId,i,n),t.mouseX=r)}else e.target.style.cursor="",t.onHeaderDragging=!1})),u.addEventListener("mousedown",(function(e){t.mouseX=e.clientX,t.onHeaderDragging&&(t.isHeaderDragging=!0)})),C.push(u),g++}i.push(C)}for(const e of i)for(const t of e)I.append(t)},v._getHeaderRow=e=>t.getArrayElementWithBoundCheck(i,e-1),v._getHeaderCell=(e,o)=>{if("number"==typeof o)return t.getArrayElementWithBoundCheck(v._getHeaderRow(e),o-1);for(const t of v._getHeaderRow(e))if(t.cId===o)return t;throw new Error("There is no "+("number"==typeof o?o+"th":o)+" colunm.")},v._getHeaderCells=()=>i,v.getHeaderRowCount=()=>{let e=0;for(const t of f)t.cHeader.length>e&&(e=t.cHeader.length);return e},v.getHeaderText=e=>v._getColInfo(e,!0).cHeader.join(";"),v.setHeaderText=(e,t)=>{const o=t.split(";");for(let e=o.length;e<v.getHeaderRowCount();e++)o.push("");for(let e=o.length;e>v.getHeaderRowCount();e--)f.forEach((e=>{e.cHeader.push("")}));return v._getColInfo(colId,!0).cHeader=o,v._loadHeader(),v.reloadFilterValue(),!0},v._getHeaderFilter=e=>{const t=v._getColIndex(e);if(!f[t-1].cFilterable)return null;let o,l;for(let e=1;e<=v.getHeaderRowCount();e++)if(o=v._getHeaderCell(e,t),o&&(l=o.querySelectorAll("."+v.gId+"_filterSelect"),l[0]))return l[0];return null},v.reloadFilterValue=()=>{for(const e of f)v.reloadColFilter(e.cIndex);return!0},v.reloadColFilter=e=>(t.reloadFilterValue(v.gId,e),!0),v._loadFooter=()=>{for(t.removeAllChild(_),c.length=0,h=1;h<=v.getFooterRowCount();h++){for(F of(C=[],g=1,f))u=document.createElement("v-g-d"),u.gId=b,u.gType="gfd",Object.keys(F).forEach((e=>{["cHeader","cFooter","cRowMerge","cColMerge","cFilterValue","cIndex"].indexOf(e)<0&&(u[e]=F[e])})),F.cFooter&&F.cFooter[h-1]&&(u.cFooter=F.cFooter[h-1]),t.setGridDataRowCol(u,h,g),C.push(u),g++;c.push(C)}for(const e of c)for(const t of e)_.append(t)},v._getFooterRow=e=>t.getArrayElementWithBoundCheck(c,e-1),v._getFooterCell=(e,o)=>{if("number"==typeof o)return t.getArrayElementWithBoundCheck(v._getFooterRow(e),o-1);for(const t of v._getFooterRow(e))if(t.cId===o)return t;throw new Error("There is no "+("number"==typeof o?o+"th":o)+" colunm.")},v._getFooterCells=()=>c,v.getFooterRowCount=()=>{let e=0;for(const t of f)t.cFooter&&t.cFooter.length>e&&(e=t.cFooter.length);return e},v.reloadFooterValue=()=>(t.reloadFooterValue(v.gId),!0),v.setFooterValue=(e,t,o)=>{const l=v._getFooterCell(e,t);return l.cValue=o,l.innerText=o,!0},v.getFooterValue=(e,t)=>v._getFooterCell(e,t).cValue,v.setFooterFormula=(e,t)=>(v._getColInfo(e,!0).cFooter=t.split(";"),v._loadFooter(),!0),v.getFooterFormula=e=>{const o=t.deepCopy(v._getColInfo(e,!0).cFooter);if(o&&Array.isArray(o)){for(let e=0;e<o.length;e++)"function"==typeof o[e]&&(o[e]="$$FUNC");return o.join(";")}return null},v.setFooterFunction=(e,o,l)=>{const r=v._getColInfo(o,!0).cFooter;return r?(t.getArrayElementWithBoundCheck(r,e-1),r[e-1]=l):(v._getColInfo(o,!0).cFooter=new Array(v.getFooterRowCount()).fill(""),v._getColInfo(o,!0).cFooter[e-1]=l),v._loadFooter(),!0},v._getRow=e=>d[e-1],v._getCell=(e,t)=>{try{if("number"==typeof t)return d[e-1][t-1];for(const o of d[e-1])if(o.cId===t)return o}catch(e){return null}return null},v._getCells=()=>d,v._gridBodyCellsReConnected=()=>{if(v.variables._isDrawable)for(const e of d)for(const o of e)t.reConnectedCallbackElement(o)},v._mountGridBodyCell=()=>{if(v.variables._isDrawable){t.removeAllChild(w);for(const e of d)for(const t of e)w.append(t);t.reloadGridForMerge(b),v.reloadFilterValue(),v.reloadFooterValue()}},v._clear=()=>{d.length=0,v.variables._activeRows=[],v.variables._activeCols=[],v.variables._activeCells=[],v.variables._targetCell=null,v.variables._recodes=[],v.variables._recodeseq=0},v._checkRowIndex=e=>{if(!e||"number"!=typeof e||e<1||e>v.getRowCount())throw new Error("Please insert a row of valid range.")},v._checkColRownumOrStatus=e=>{if("number"==typeof e){if(e<=2)throw new Error("The row number or status columns info cannot be modified.")}else if("v-g-rownum"===e||"v-g-status"===e)throw new Error("The row number or status columns info cannot be modified.")},v._checkColIndex=e=>{if(!e||"number"!=typeof e||e<1||e>v.getColCount())throw new Error("Please insert a col of valid range.")},v.getGridInfo=()=>{const e=v.info,o={};return Object.keys(e).forEach((l=>{const r=l.charAt(1).toLowerCase()+l.slice(2);"type"!==r&&(o[r]=t.deepCopy(e[l]))})),o.id=b,o},v.load=e=>{if(!e)return!1;if(!Array.isArray(e))throw new Error("Please insert valid datas.");const o=t.checkIsValueOrData(e);if(v._clear(),o){const o=e;for(let e=1;e<=o.length;e++){C=[];const l=o[e-1];for(let o=1;o<=f.length;o++)u=t.getGridCell(b,f[o-1],l,e,o),C.push(u);d.push(C)}}else{const o=e;for(let e=1;e<=o.length;e++){C=[];const l=o[e-1];for(let o=1;o<=f.length;o++)u=t.getGridCell(b,f[o-1],l,e,o),C.push(u);d.push(C)}}return v._mountGridBodyCell(),!0},v.clear=()=>(t.removeAllChild(w),v.variables._sortToggle={},v.variables._filters=[],v._clear(),!0),v.clearStatus=()=>{for(let e=1;e<=v.getRowCount();e++)cell=v._getCell(e,2),cell.cValue=null,t.reConnectedCallbackElement(cell);return!0},v.getRowCount=()=>d.length,v.getColCount=()=>f.length,v.getValues=()=>{const e=[];let o;for(const l of d){o={};for(const e of l)o[e.cId]=t.deepCopy(e.cValue);e.push(o)}return e},v._getDatasWithoutExceptedProperty=(e=[])=>{const t=[];let o;for(const l of d){o=[];for(const t of l){const l=v._getData(t,e);o.push(l)}t.push(o)}return t},v.getDatas=()=>v._getDatasWithoutExceptedProperty(),v.sort=(e,o=!0,l=!1)=>{const r=v.getDatas(),n=t.sort(v.gId,r,e,o,l),i=v.variables._sortToggle[e];return v.load(n),v.variables._sortToggle[e]=i,!0},v.checkRequired=e=>{if(e&&"function"!=typeof e)throw new Error("Please insert a valid function.");for(const t of d)for(const o of t)if(o.cRequired&&["select","checkbox","button","link"].indexOf(o.cDataType)<0&&(""===o.cValue||null===o.cValue||void 0===o.cValue||o.cValue===v.info.gNullValue))return e?!1!==e(v._getData(o))&&v.editCell(o.row,o.col):(alert(v.info.gName+" row 1, "+o.cName+" column is a required value."),v.editCell(o.row,o.col)),!1;return!0},v.setGridMount=e=>(e=!0===e,v.variables._isDrawable=e,e&&v._mountGridBodyCell(),!0),v.getGridFilter=()=>v.variables._filters,v.setGridWidth=e=>{if(!e)throw new Error("Please insert cssText of width.");return v.cssInfo.width=e,v._setGridCssStyle(),!0},v.setGridHeight=e=>{if(!e)throw new Error("Please insert cssText of height.");return v.cssInfo.height=e,v._setGridCssStyle(),!0},v.setGridSizeLevel=e=>{if(!(e=t.getOnlyNumberWithNaNToNull(e)))throw new Error("Please insert number of size level.");return v.cssInfo.sizeLevel=e,v.cssInfo.cellFontSize=(v.cssInfo.sizeLevel+15)/20*14+"px",v.cssInfo.cellMinHeight=(v.cssInfo.sizeLevel+15)/20*21+"px",v._setGridCssStyle(),!0},v.setGridVerticalAlign=e=>{if(!e)throw new Error("Please insert vertical align.");if(!t.isIncludeEnum(n,e))throw new Error("Please insert valid vertical align. (top, center, bottom)");const o=t.getVerticalAlign(e);return v.cssInfo.verticalAlign=o,v._setGridCssStyle(),!0},v.setCellFontSize=e=>{if(!e)throw new Error("Please insert cssText of cell font size.");return v.cssInfo.cellFontSize=e,v._setGridCssStyle(),!0},v.setCellMinHeight=e=>{if(!e)throw new Error("Please insert cssText of cell min height.");return v.cssInfo.cellMinHeight=e,v._setGridCssStyle(),!0},v.setHorizenBorderSize=e=>(t.validatePositiveIntegerAndZero(e),v.cssInfo.horizenBorderSize=e,v._setGridCssStyle(),!0),v.setVerticalBorderSize=e=>(t.validatePositiveIntegerAndZero(e),v.cssInfo.verticalBorderSize=e,v._setGridCssStyle(),!0),v.setGridColor=e=>{if(!/^#[0-9a-fA-F]{6}$/.test(e))throw new Error("Please insert valid cssText of hexadecimal color. (#ffffff)");return v.cssInfo.color=e,t.setColorSet(v.cssInfo),v._setGridCssStyle(),!0},v.setGridColorSet=e=>{const o=t.getColorFromColorSet(e);return v.cssInfo.color=o,t.setColorSet(v.cssInfo),v._setGridCssStyle(),!0},v.invertColor=e=>((e=!0===e)?t.setInvertColor(v.cssInfo):t.setColorSet(v.cssInfo),v._setGridCssStyle(),!0),v.setGridName=e=>{if(!e)throw new Error("Please insert a gridName.");return v.info.gName=String(e),!0},v.getGridName=()=>v.info.gName,v.setGridLocked=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");v.info.gLocked=e,f.forEach(((t,o)=>{o>=2&&(t.cLocked=e)}));const t=v._getDatasWithoutExceptedProperty(["locked"]);return v.load(t),!0},v.isGridLocked=()=>v.info.gLocked,v.setGridLockedColor=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");v.info.gLockedColor=e,f.forEach(((t,o)=>{o>=2&&(t.cLockedColor=e)}));const t=v._getDatasWithoutExceptedProperty(["lockedColor"]);return v.load(t),!0},v.setGridResizable=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");return v.info.gResizable=e,!0},v.isGridResizable=()=>v.info.gResizable,v.setGridRecodeCount=e=>(e=t.validatePositiveIntegerAndZero(e),v.info.gRedoCount=e,!0),v.getGridRecodeCount=()=>v.info.gRedoCount,v.setGridRedoable=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");v.info.gRedoable=e},v.isGridRedoable=()=>v.info.gRedoable,v.setGridVisible=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");return v.info.gVisible=e,v._setGridCssStyle(),!0},v.isGridVisible=()=>v.info.gVisible,v.setGridRownumLockedColor=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");v.info.gRownumLockedColor=e,f[0].cLockedColor=e;for(const o of d)o[0].cLockedColor=e,t.reConnectedCallbackElement(o[0]);return!0},v.isGridRownumLockedColor=()=>v.info.gRownumLockedColor,v.setGridRownumSize=e=>{e=t.validatePositiveIntegerAndZero(e);const o=f[0];return o.cOriginWidth=String(e)+t.extractNumberAndUnit(o.cOriginWidth).unit,t.changeColSize(b,o.cIndex,e),o.cColVisible=0!==e,t.reloadGridWithModifyCell(b,o.cIndex),!0},v.getGridRownumSize=()=>f[0].cOriginWidth,v.setGridStatusLockedColor=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");v.info.gStatusLockedColor=e,f[1].cLockedColor=e;for(const o of d)o[1].cLockedColor=e,t.reConnectedCallbackElement(o[1]);return!0},v.isGridStatusLockedColor=()=>v.info.gStatusLockedColor,v.setGridSelectionPolicy=e=>{if(!t.isIncludeEnum(s,e))throw new Error("Please insert the correct selectionPolicy properties. (single, range, none)");return v.info.gSelectionPolicy=e,!0},v.getGridSelectionPolicy=e=>v.info.gSelectionPolicy,v.setGridNullValue=e=>(v.info.gNullValue=e,v._gridBodyCellsReConnected(),!0),v.getGridNullValue=()=>t.deepCopy(v.info.gNullValue),v.setGridDateFormat=e=>(v.info.gDateFormat=e,v._gridBodyCellsReConnected(),!0),v.getGridDateFormat=()=>v.info.gDateFormat,v.setGridMonthFormat=e=>(v.info.gMonthFormat=e,v._gridBodyCellsReConnected(),!0),v.getGridMonthFormat=()=>v.info.gMonthFormat,v.setGridAlterRow=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");return v.info.gAlterRow=e,v._gridBodyCellsReConnected(),!0},v.setGridFrozenColCount=e=>{e=t.validatePositiveIntegerAndZero(e);if(I.style.gridTemplateColumns.includes("%")&&0!==v.info.gFrozenColCount)throw new Error(b+" has error. If you set the horizontal size to a percentage, property A is not available.");v.info.gFrozenColCount=e;const o=v.getDatas();return v._loadHeader(),v._loadFooter(),v.load(o),!0},v.getGridFrozenColCount=()=>v.info.gFrozenColCount,v.setGridFrozenRowCount=e=>{e=t.validatePositiveIntegerAndZero(e),v.info.gFrozenRowCount=e;const o=v.getDatas();return v._loadHeader(),v._loadFooter(),v.load(o),!0},v.getGridFrozenRowCount=()=>v.info.gFrozenRowCount,v.setGridSortable=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");return v.info.gSortable=e,!0},v.isGridSortable=()=>v.info.gSortable,v.setGridFilterable=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");v.info.gFilterable=e;const t=v.getDatas();return v._loadHeader(),v._loadFooter(),v.load(t),!0},v.isGridFilterable=()=>v.info.gFilterable,v.setGridAllCheckable=e=>{if("boolean"!=typeof e)throw new Error("Please insert a boolean type.");return v.info.gAllCheckable=e,!0},v.isGridAllCheckable=()=>v.info.gAllCheckable,v.setGridCheckedValue=e=>{if("string"!=typeof e)throw new Error("Please insert a string type.");if(v.info.gUncheckedValue===e)throw new Error("Checked and unchecked values cannot be the same.");const t=v.getDatas();for(const o of t)for(const t of o)"checkbox"===t.dataType&&t.value===v.info.gCheckedValue&&(t.value=e);return v.info.gCheckedValue=e,v._loadHeader(),v._loadFooter(),v.load(t),!0},v.getGridCheckedValue=()=>v.info.gCheckedValue,v.setGridUncheckedValue=e=>{if("string"!=typeof e)throw new Error("Please insert a string type.");if(v.info.gCheckedValue===e)throw new Error("Checked and unchecked values cannot be the same.");const t=v.getDatas();for(const o of t)for(const t of o)"checkbox"===t.dataType&&t.value!==v.info.gCheckedValue&&(t.value=e);return v.info.gUncheckedValue=e,v._loadHeader(),v._loadFooter(),v.load(t),!0},v.getGridUncheckedValue=()=>v.info.gUncheckedValue,v.addCol=(e,t)=>{let o=v._getColIndex(e);if(o<2)throw new Error("You cannot add new columns between the row number and status columns.");(!o||o>v.getColCount())&&(o=v.getColCount());const l=v._getDefaultColInfo(t,!0),r=v.getDatas();return f.splice(o,0,l),f.forEach(((e,t)=>{e.cIndex=t+1})),v._loadHeader(),v._loadFooter(),v.load(r),!0},v.removeCol=e=>{const t=v._getColIndex(e,!0);if(t<=2)throw new Error("The row number or status columns cannot be removed.");const o=v.getColValues(t);f.splice(t-1,1),f.forEach(((e,t)=>{e.cIndex=t+1}));const l=v.getDatas();return v._loadHeader(),v._loadFooter(),v.load(l),o},v.setColInfo=e=>{if(!e)throw new Error("Column info is required.");if(e.constructor!==Object)throw new Error("Please insert a valid column info");let t;if(e.index&&(t=e.index),e.id&&(t=e.id),!t)throw new Error("Column id is required.");const o=v._getColIndex(t,!0);if(o<=2)throw new Error("The row number or status columns are immutable.");const l=v._getDefaultColInfo(e);f[o-1]=l,f.forEach(((e,t)=>{e.cIndex=t+1}));const r=v.getDatas();return r.forEach((e=>{for(const t of e)t.id===l.cId&&Object.keys(l).forEach((e=>{if(["cHeader","cFooter","cRowMerge","cColMerge","cFilterValue"].indexOf(e)<0){const o=e.charAt(1).toLowerCase()+e.slice(2);t[o]=l[e]}}))})),v._loadHeader(),v._loadFooter(),v.load(r),!0},v.getColInfo=e=>{F=v._getColInfo(e);const o={};return o.id=F.cId,o.index=F.cIndex,o.name=F.cName,o.untarget=F.cUntarget,o.colVisible=F.cColVisible,o.required=F.cRequired,o.resizable=F.cResizable,o.originWidth=F.cOriginWidth,o.dataType=F.cDataType,o.selectSize=F.cSelectSize,o.locked=F.cLocked,o.lockedColor=F.cLockedColor,o.format=F.cFormat,o.codes=t.deepCopy(F.cCodes),o.defaultCode=F.cDefaultCode,o.maxLength=F.cMaxLength,o.maxByte=F.cMaxByte,o.maxNumber=F.cMaxNumber,o.minNumber=F.cMinNumber,o.roundNumber=F.cRoundNumber,o.align=F.cAlign,o.verticalAlign=F.cVerticalAlign,o.backColor=F.cBackColor,o.fontColor=F.cFontColor,o.fontBold=F.cFontBold,o.fontItalic=F.cFontItalic,o.fontThruline=F.cFontThruline,o.fontUnderline=F.cFontUnderline,F.cHeader&&Array.isArray(F.cHeader)&&(o.header=F.cHeader.join(";")),F.cFooter&&Array.isArray(F.cFooter)&&(o.footer=F.cFooter.join(";")),o.rowMerge=F.cRowMerge,o.colMerge=F.cColMerge,o.sortable=F.cSortable,o.filterable=F.cFilterable,o.filterValues=t.deepCopy(F.cFilterValues),o.filterValue=t.deepCopy(F.cFilterValue),o},v.getColDatas=e=>{const t=v._getColIndex(e,!0),o=[];for(let e=1;e<=v.getRowCount();e++)o.push(v.getCellData(e,t));return o},v.setColSameValue=(e,o,l=!1)=>{if(v._checkColRownumOrStatus(e),l){const l=[];for(let r=1;r<=v.getRowCount();r++){let n=v._getCell(r,e),i=t.getRecodesWithModifyValue(n,o,!0);Array.isArray(i)&&i.length>0&&l.push(i[0])}t.recodeGridModify(v.gId,l)}else{for(let l=1;l<=v.getRowCount();l++){let r=v._getCell(l,e);r.cValue=t.getValidValue(r,o),t.reConnectedCallbackElement(r)}t.reloadGridWithModifyCell(b,e)}return!0},v.getColValues=e=>{const o=v._getColIndex(e,!0),l=[];for(let e=1;e<=v.getRowCount();e++){let r=v._getCell(e,o);l.push(t.deepCopy(r.cValue))}return l},v.getColTexts=e=>{const t=v._getColIndex(e,!0),o=[];for(let e=1;e<=v.getRowCount();e++)o.push(v.getCellText(e,t));return o},v.isColUnique=e=>{const o=v._getColIndex(e,!0),l=[];for(let e=1;e<=v.getRowCount();e++){let r=v._getCell(e,o);switch(r.cDataType){case"select":case"checkbox":case"button":case"link":l.push(t.getCellText(r));break;default:l.push(r.cValue)}}return l.length===new Set(l).size},v._doFilter=()=>{let o;if(v.variables._filters=[],v._getHeader().querySelectorAll("."+b+"_filterSelect").forEach((function(e){"$$ALL"!==e.value&&(o={},o.cId=e.cId,o.value=e.value,v._getColInfo(e.parentNode.parentNode.cIndex).cFilterValue=e.value,"$$NULL"!==o.value&&null!==o.value&&void 0!==o.value&&""!==o.value||(o.value=v.info.gNullValue),v.variables._filters.push(o))})),0===v.variables._filters.length)v._getCells().forEach((function(e){e.forEach((function(e){e.cFilter=!1}))}));else{let o=1;v._getCells().forEach((function(l){let r=!1;l.forEach((function(o){v.variables._filters.forEach((function(l){if(o.cId===l.cId){let n=t.getCellText(o);Object.keys(e.dataType).forEach((t=>{if(o.cDataType===t&&e.dataType[t].getFilterValue){if("function"!=typeof e.dataType[t].getFilterValue)throw new Error("getFilterValue must be a function.");n=e.dataType[t].getFilterValue(o.cValue)}})),n!==l.value&&(r=!0)}}))})),v._getRow(o).forEach((function(e){e.cFilter=r})),o++}))}v.load(v.getDatas())},v.openColFilter=e=>(v._getHeaderFilter(e).style.display="block",!0),v.closeColFilter=e=>(v._getHeaderFilter(e).style.display="none",!0),v.setColFilterValue=(e,t)=>{const o=v._getColInfo(e,!0);if(!o.cFilterValues.has(t))throw new Error("Please insert a valid filterValue. "+Array.from(o.cFilterValues).join(", "));let l,r;for(let e=1;e<=v.getHeaderRowCount();e++)if(l=v._getHeaderCell(e,o.cIndex),r=l.querySelectorAll("."+b+"_filterSelect"),r.length>0){r=r[0];break}return r.value=t,"$$ALL"!==r.value&&(r.style.display="block"),v._doFilter(),!0},v.getColFilterValues=e=>{const t=v._getColInfo(e,!0);return Array.from(t.cFilterValues)},v.getColFilterValue=e=>v._getColInfo(e,!0).cFilterValue,v.getColId=e=>v._getColInfo(e,!0).cId,v.getColIndex=e=>v._getColIndex(e,!0),v.setColName=(e,t)=>{const o=v._getColIndex(e,!0);if(!t)throw new Error("Column Name is required");if("string"!=typeof t)throw new Error("Please insert a string type.");v._getColInfo(o).cName=t;for(let e=1;e<=v.getRowCount();e++)v._getCell(e,o).cName=t;return!0},v.getColName=e=>v._getColInfo(e).cName,v.setColUntarget=(e,t)=>{v._checkColRownumOrStatus(e);const o=v._getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");v._getColInfo(o).cUntarget=t;for(let e=1;e<=v.getRowCount();e++)v._getCell(e,o).cUntarget=t;return!0},v.setColRowMerge=(e,t)=>{v._checkColRownumOrStatus(e);const o=v._getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");v._getColInfo(o).cRowMerge=t;const l=v.getDatas();return v.load(l),!0},v.isColRowMerge=e=>v._getColInfo(e,!0).cRowMerge,v.setColColMerge=(e,t)=>{v._checkColRownumOrStatus(e);const o=v._getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");v._getColInfo(o).cColMerge=t;const l=v.getDatas();return v.load(l),!0},v.isColColMerge=e=>v._getColInfo(e,!0).cColMerge,v.setColVisible=(e,o)=>{if("boolean"!=typeof o)throw new Error("Please insert a boolean type.");const l=v._getColInfo(e,!0);return o?t.changeColSize(b,l.cIndex,t.extractNumberAndUnit(l.cOriginWidth).number):t.changeColSize(b,l.cIndex,0),l.cColVisible=o,v._loadHeader(),t.reloadGridWithModifyCell(b,l.cIndex),!0},v.isColVisible=e=>v._getColInfo(e,!0).cColVisible,v.setColRequired=(e,t)=>{v._checkColRownumOrStatus(e);const o=v._getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");v._getColInfo(o,!0).cRequired=t;for(let e=1;e<=v.getRowCount();e++)v._getCell(e,o).cRequired=t;return!0},v.isColRequired=e=>v._getColInfo(e,!0).cRequired,v.setColResizable=(e,t)=>{if(v._checkColRownumOrStatus(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");return v._getColInfo(e,!0).cResizable=t,v._loadHeader(),!0},v.isColResizable=e=>v._getColInfo(e,!0).cResizable,v.setColSortable=(e,t)=>{if(v._checkColRownumOrStatus(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");return v._getColInfo(e,!0).cSortable=t,!0},v.isColSortable=e=>v._getColInfo(e,!0).cSortable,v.setColFilterable=(e,o)=>{v._checkColRownumOrStatus(e);const l=v._getColIndex(e,!0);if("boolean"!=typeof o)throw new Error("Please insert a boolean type.");return v._getColInfo(l,!0).cFilterable=o,v._loadHeader(),t.reloadFilterValue(b,l),!0},v.isColFilterable=e=>v._getColInfo(e,!0).cFilterable,v.setColOriginWidth=(e,l)=>{const r=v._getColInfo(e,!0),n=t.extractNumberAndUnit(l);if(!t.isIncludeEnum(o,n.unit))throw new Error("Width units can only be pixel or %.");return r.cOriginWidth=n.number+n.unit,t.changeColSize(b,r.cIndex,n.number),0===n.number?r.cColVisible=!1:r.cColVisible=!0,v._loadHeader(),t.reloadGridWithModifyCell(b,r.cIndex),!0},v.getColOriginWidth=e=>v._getColInfo(e,!0).cOriginWidth,v.setColDataType=(e,o)=>{v._checkColRownumOrStatus(e);const r=v._getColIndex(e,!0);if(!t.isIncludeEnum(l,o))throw new Error("Please insert a valid dataType.");v._getColInfo(r).cDataType=o;for(let e=1;e<=v.getRowCount();e++){const l=v._getCell(e,r);l.cDataType=o,t.reConnectedCallbackElement(l)}return t.reloadGridWithModifyCell(b,r),!0},v.getColDataType=e=>v._getColInfo(e,!0).cDataType,v.setColSelectSize=(e,t)=>{v._checkColRownumOrStatus(e);const o=v._getColIndex(e,!0);v._getColInfo(o).cSelectSize=t;for(let e=1;e<=v.getRowCount();e++){const l=v._getCell(e,o);l.cSelectSize=t,v._gridCellReConnectedWithControlSpan(l)}return!0},v.getColSelectSize=e=>v._getColInfo(e,!0).cSelectSize,v.setColLocked=(e,t)=>{v._checkColRownumOrStatus(e);const o=v._getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");v._getColInfo(o).cLocked=t;for(let e=1;e<=v.getRowCount();e++){const l=v._getCell(e,o);l.cLocked=t,v._gridCellReConnectedWithControlSpan(l)}return!0},v.isColLocked=e=>v._getColInfo(e,!0).cLocked,v.setColLockedColor=(e,t)=>{const o=v._getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");v._getColInfo(o).cLockedColor=t;for(let e=1;e<=v.getRowCount();e++){const l=v._getCell(e,o);l.cLockedColor=t,v._gridCellReConnectedWithControlSpan(l)}return!0},v.isColLockedColor=e=>v._getColInfo(e,!0).cLockedColor,v.setColFormat=(e,o)=>{v._checkColRownumOrStatus(e);const l=v._getColIndex(e,!0);if("string"!=typeof o)throw new Error("Please insert a string type.");v._getColInfo(l).cFormat=o;for(let e=1;e<=v.getRowCount();e++){const r=v._getCell(e,l);r.cFormat=o,"mask"===r.cDataType&&(r.cValue=t.getValidValue(r,r.cValue)),t.reConnectedCallbackElement(r)}return t.reloadGridWithModifyCell(b,l),!0},v.getColFormat=e=>v._getColInfo(e,!0).cFormat,v.setColCodes=(e,o)=>{v._checkColRownumOrStatus(e);const l=v._getColIndex(e,!0);if(!Array.isArray(o))throw new Error("Please insert a vaild codes. (Array)");v._getColInfo(l).cCodes=o;for(let e=1;e<=v.getRowCount();e++){const r=v._getCell(e,l);r.cCodes=o,"code"===r.cDataType&&(r.cValue=t.getValidValue(r,r.cValue)),t.reConnectedCallbackElement(r)}return t.reloadGridWithModifyCell(b,l),!0},v.getColCodes=e=>v._getColInfo(e,!0).cCodes,v.setColDefaultCode=(e,o)=>{v._checkColRownumOrStatus(e);const l=v._getColIndex(e,!0);v._getColInfo(l).cDefaultCode=o;for(let e=1;e<=v.getRowCount();e++){const r=v._getCell(e,l);r.cDefaultCode=o,"code"===r.cDataType&&(r.cValue=t.getValidValue(r,r.cValue)),t.reConnectedCallbackElement(r)}return t.reloadGridWithModifyCell(b,l),!0},v.getColDefaultCode=e=>v._getColInfo(e,!0).cDefaultCode,v.setColMaxLength=(e,o)=>{v._checkColRownumOrStatus(e);const l=v._getColIndex(e,!0);o=t.validatePositiveIntegerAndZero(o);v._getColInfo(l).cMaxLength=o;for(let e=1;e<=v.getRowCount();e++){const r=v._getCell(e,l);r.cMaxLength=o,"text"===r.cDataType&&(r.cValue=t.getValidValue(r,r.cValue)),t.reConnectedCallbackElement(r)}return t.reloadGridWithModifyCell(b,l),!0},v.getColMaxLength=e=>v._getColInfo(e,!0).cMaxLength,v.setColMaxByte=(e,o)=>{v._checkColRownumOrStatus(e);const l=v._getColIndex(e,!0);o=t.validatePositiveIntegerAndZero(o);v._getColInfo(l).cMaxByte=o;for(let e=1;e<=v.getRowCount();e++){const r=v._getCell(e,l);r.cMaxByte=o,"text"===r.cDataType&&(r.cValue=t.getValidValue(r,r.cValue)),t.reConnectedCallbackElement(r)}return t.reloadGridWithModifyCell(b,l),!0},v.getColMaxByte=e=>v._getColInfo(e,!0).cMaxByte,v.setColMaxNumber=(e,o)=>{v._checkColRownumOrStatus(e);const l=v._getColIndex(e,!0);o=t.validateNumber(o);v._getColInfo(l).cMaxNumber=o;for(let e=1;e<=v.getRowCount();e++){const r=v._getCell(e,l);r.cMaxNumber=o,"number"===r.cDataType&&(r.cValue=t.getValidValue(r,r.cValue)),t.reConnectedCallbackElement(r)}return t.reloadGridWithModifyCell(b,l),!0},v.getColMaxNumber=e=>v._getColInfo(e,!0).cMaxNumber,v.setColMinNumber=(e,o)=>{v._checkColRownumOrStatus(e);const l=v._getColIndex(e,!0);o=t.validateNumber(o);v._getColInfo(l).cMinNumber=o;for(let e=1;e<=v.getRowCount();e++){const r=v._getCell(e,l);r.cMinNumber=o,"number"===r.cDataType&&(r.cValue=t.getValidValue(r,r.cValue)),t.reConnectedCallbackElement(r)}return t.reloadGridWithModifyCell(b,l),!0},v.getColMinNumber=e=>v._getColInfo(e,!0).cMinNumber,v.setColRoundNumber=(e,o)=>{v._checkColRownumOrStatus(e);const l=v._getColIndex(e,!0);o=t.validateIntegerAndZero(o);v._getColInfo(l).cRoundNumber=o;for(let e=1;e<=v.getRowCount();e++){const r=v._getCell(e,l);r.cRoundNumber=o,"number"===r.cDataType&&(r.cValue=t.getValidValue(r,r.cValue)),t.reConnectedCallbackElement(r)}return t.reloadGridWithModifyCell(b,l),!0},v.getColRoundNumber=e=>v._getColInfo(e,!0).cRoundNumber,v.setColAlign=(e,o)=>{const l=v._getColIndex(e,!0);if(!t.isIncludeEnum(r,o))throw new Error("Please insert a vaild align. (left, center, right)");v._getColInfo(l).cAlign=o;for(let e=1;e<=v.getRowCount();e++){const t=v._getCell(e,l);t.cAlign=o,v._gridCellReConnectedWithControlSpan(t)}return!0},v.getColAlign=e=>v._getColInfo(e,!0).cAlign,v.setColVerticalAlign=(e,o)=>{const l=v._getColIndex(e,!0);if(!t.isIncludeEnum(n,o))throw new Error("Please insert a vaild align. (top, center, bottom)");v._getColInfo(l).cVerticalAlign=o;for(let e=1;e<=v.getRowCount();e++){const t=v._getCell(e,l);t.cVerticalAlign=o,v._gridCellReConnectedWithControlSpan(t)}return!0},v.getColVerticalAlign=e=>v._getColInfo(e,!0).cVerticalAlign,v.setColBackColor=(e,o)=>{const l=v._getColIndex(e,!0);if("#000"!==o&&"#000000"!==o&&"#000000"===t.getHexColorFromColorName(o))throw new Error("Please enter the correct hexadecimal color. (#ffffff)");v._getColInfo(l).cBackColor=o;for(let e=1;e<=v.getRowCount();e++){const t=v._getCell(e,l);t.cBackColor=o,v._gridCellReConnectedWithControlSpan(t)}return!0},v.getColBackColor=e=>v._getColInfo(e,!0).cBackColor,v.setColFontColor=(e,o)=>{const l=v._getColIndex(e,!0);if("#000"!==o&&"#000000"!==o&&"#000000"===t.getHexColorFromColorName(o))throw new Error("Please enter the correct hexadecimal color. (#ffffff)");v._getColInfo(l).cFontColor=o;for(let e=1;e<=v.getRowCount();e++){const t=v._getCell(e,l);t.cFontColor=o,v._gridCellReConnectedWithControlSpan(t)}return!0},v.getColFontColor=e=>v._getColInfo(e,!0).cFontColor,v.setColFontBold=(e,t)=>{const o=v._getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");v._getColInfo(o).cFontBold=t;for(let e=1;e<=v.getRowCount();e++){const l=v._getCell(e,o);l.cFontBold=t,v._gridCellReConnectedWithControlSpan(l)}return!0},v.isColFontBold=e=>v._getColInfo(e,!0).cFontBold,v.setColFontItalic=(e,t)=>{const o=v._getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");v._getColInfo(o).cFontItalic=t;for(let e=1;e<=v.getRowCount();e++){const l=v._getCell(e,o);l.cFontItalic=t,v._gridCellReConnectedWithControlSpan(l)}return!0},v.isColFontItalic=e=>v._getColInfo(e,!0).cFontItalic,v.setColFontThruline=(e,t)=>{const o=v._getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");v._getColInfo(o).cFontThruline=t;for(let e=1;e<=v.getRowCount();e++){const l=v._getCell(e,o);l.cFontThruline=t,v._gridCellReConnectedWithControlSpan(l)}return!0},v.isColFontThruline=e=>v._getColInfo(e,!0).cFontThruline,v.setColFontUnderline=(e,t)=>{const o=v._getColIndex(e,!0);if("boolean"!=typeof t)throw new Error("Please insert a boolean type.");v._getColInfo(o).cFontUnderline=t;for(let e=1;e<=v.getRowCount();e++){const l=v._getCell(e,o);l.cFontUnderline=t,v._gridCellReConnectedWithControlSpan(l)}return!0},v.isColFontUnderline=e=>v._getColInfo(e,!0).cFontUnderline,v.addRow=(e,o)=>{let l,r;if(0===e&&(e=1),e?"number"==typeof e?(l=e-1,r=o):r=e:r=o,(null==l||l>v.getRowCount())&&(l=v.getRowCount()),r=r?[r]:[[{}]],null===r||!Array.isArray(r))throw new Error("Please insert valid datas.");const n=t.checkIsValueOrData(r),i=v.getDatas();let a=0;for(const e of r){if(n){const t=[];let o;for(const l in e)o={},o.id=l,o.value=e[l],t.push(o);i.splice(l+a,0,t)}else i.splice(l+a,0,e);a++}v.load(i);for(let e=l;e<l+a;e++)v.setRowStatus(e+1,"C");return t.focusCell(v._getCell(l+1,"v-g-status")),!0},v.removeRow=e=>{v._checkRowIndex(e);const t=v.getRowValues(e);t[0]["v-g-status"]="D";const o=v.getDatas();return o.splice(e-1,1),v.load(o),t},v.setRowStatus=(e,o)=>{if(v._checkRowIndex(e),!t.isIncludeEnum(a,o))throw new Error("Please insert the correct status code. (C, U, D)");const l=v._getCell(e,"v-g-status");return l.cValue=o,t.reConnectedCallbackElement(l),!0},v.getRowStatus=e=>(v._checkRowIndex(e),v._getCell(e,"v-g-status").cValue),v.setRowDatas=(e,t)=>{for(const o of t)v._setCellData(e,o.id,o,!1);return!0},v.getRowDatas=e=>{v._checkRowIndex(e);const t=[];for(const o of f)t.push(v.getCellData(e,o.cIndex));return t},v.setRowValues=(e,o,l=!1)=>{if(2,v._checkRowIndex(2),!o||o.constructor!==Object)throw new Error("Please insert a valid value.");let r=null,n=null;if(l){const e=[];let l;for(const i of f)if("v-g-rownum"!==i.cId&&"v-g-status"!==i.cId){for(const e in o)i.cId===e&&(r=o[e]);n=v._getCell(2,i.cIndex),l=t.getRecodesWithModifyValue(n,r,!0),Array.isArray(l)&&l.length>0&&e.push(l[0])}t.recodeGridModify(v.gId,e)}else for(const e of f)if("v-g-rownum"!==e.cId&&"v-g-status"!==e.cId){for(const t in o)e.cId===t&&(r=o[t]);n=v._getCell(2,e.cIndex),n.cValue=t.getValidValue(n,r),t.reConnectedCallbackElement(n),t.reloadGridWithModifyCell(n.gId,n.cIndex)}return!0},v.getRowValues=e=>{v._checkRowIndex(e);const o={};for(const l of d[e-1])o[l.cId]=t.deepCopy(l.cValue);return o},v.getRowTexts=e=>{v._checkRowIndex(e);const o={};for(const l of d[e-1])o[l.cId]=t.getCellText(l);return o},v.setRowVisible=(e,t)=>{if(v._checkRowIndex(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");for(let o=1;o<=v.getColCount();o++){const l=v._getCell(e,o);l.cRowVisible=t,v._gridCellReConnectedWithControlSpan(l)}return!0},v.isRowVisible=e=>{v._checkRowIndex(e);return v._getCell(e,1).cRowVisible},v.setRowDataType=(e,o)=>{if(v._checkRowIndex(e),!t.isIncludeEnum(l,o))throw new Error("Please insert a valid dataType.");for(const l of d[e-1])"v-g-rownum"!==l.cId&&"v-g-status"!==l.cId&&(l.cDataType=o,t.reConnectedCallbackElement(l));return t.reloadGridForMerge(b),v.reloadFilterValue(),v.reloadFooterValue(),!0},v.setRowLocked=(e,t)=>{if(v._checkRowIndex(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");for(const o of d[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cLocked=t,v._gridCellReConnectedWithControlSpan(o));return!0},v.setRowLockedColor=(e,t)=>{if(v._checkRowIndex(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");for(const o of d[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cLockedColor=t,v._gridCellReConnectedWithControlSpan(o));return!0},v.setRowAlign=(e,o)=>{if(v._checkRowIndex(e),!t.isIncludeEnum(r,o))throw new Error("Please insert a vaild align. (left, center, right)");for(const t of d[e-1])"v-g-rownum"!==t.cId&&"v-g-status"!==t.cId&&(t.cAlign=o,v._gridCellReConnectedWithControlSpan(t));return!0},v.setRowVerticalAlign=(e,o)=>{if(v._checkRowIndex(e),!t.isIncludeEnum(n,o))throw new Error("Please insert valid vertical align. (top, center, bottom)");for(const t of d[e-1])"v-g-rownum"!==t.cId&&"v-g-status"!==t.cId&&(t.cVerticalAlign=o,v._gridCellReConnectedWithControlSpan(t));return!0},v.setRowBackColor=(e,o)=>{if(v._checkRowIndex(e),"#000"!==o&&"#000000"!==o&&"#000000"===t.getHexColorFromColorName(o))throw new Error("Please enter the correct hexadecimal color. (#ffffff)");for(const t of d[e-1])"v-g-rownum"!==t.cId&&"v-g-status"!==t.cId&&(t.cBackColor=o,v._gridCellReConnectedWithControlSpan(t));return!0},v.setRowFontColor=(e,o)=>{if(v._checkRowIndex(e),"#000"!==o&&"#000000"!==o&&"#000000"===t.getHexColorFromColorName(o))throw new Error("Please enter the correct hexadecimal color. (#ffffff)");for(const t of d[e-1])"v-g-rownum"!==t.cId&&"v-g-status"!==t.cId&&(t.cFontColor=o,v._gridCellReConnectedWithControlSpan(t));return!0},v.setRowFontBold=(e,t)=>{if(v._checkRowIndex(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");for(const o of d[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cFontBold=t,v._gridCellReConnectedWithControlSpan(o));return!0},v.setRowFontItalic=(e,t)=>{if(v._checkRowIndex(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");for(const o of d[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cFontItalic=t,v._gridCellReConnectedWithControlSpan(o));return!0},v.setRowFontThruline=(e,t)=>{if(v._checkRowIndex(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");for(const o of d[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cFontThruline=t,v._gridCellReConnectedWithControlSpan(o));return!0},v.setRowFontUnderline=(e,t)=>{if(v._checkRowIndex(e),"boolean"!=typeof t)throw new Error("Please insert a boolean type.");for(const o of d[e-1])"v-g-rownum"!==o.cId&&"v-g-status"!==o.cId&&(o.cFontUnderline=t,v._gridCellReConnectedWithControlSpan(o));return!0},v.searchRowsWithMatched=e=>{if(e.constructor!==Object)throw new Error("Please insert a valid matches. (Object)");const t=[];let o;return d.forEach(((l,r)=>{o=!0;for(const t of l)for(const l of Object.keys(e))if(t.cId===l&&t.cValue!==e[l]){o=!1;break}o&&t.push(r)})),t},v.searchRowDatasWithMatched=e=>{const t=v.searchRowsWithMatched(e),o=[];return t.forEach((e=>{o.push(v.getRowDatas(e))})),o},v.searchRowValuesWithMatched=e=>{const t=v.searchRowsWithMatched(e),o=[];return t.forEach((e=>{o.push(...v.getRowValues(e))})),o},v.searchRowsWithFunction=e=>{if("function"!=typeof e)throw new Error("Please insert a valid function.");const t=[];let o;for(let l=1;l<=v.getRowCount();l++)o=e(v.getRowDatas(l)),o&&t.push(l);return t},v.searchRowDatasWithFunction=e=>{const t=v.searchRowsWithFunction(e),o=[];return t.forEach((e=>{o.push(v.getRowDatas(e))})),o},v.searchRowValuesWithFunction=e=>{const t=v.searchRowsWithFunction(e),o=[];return t.forEach((e=>{o.push(...v.getRowValues(e))})),o},v._gridCellReConnectedWithControlSpan=e=>{if(t.reConnectedCallbackElement(e),e.rowSpan)for(let t=e.row+1;t<e.row+e.rowSpan;t++)v._gridCellReConnectedWithControlSpan(v._getCell(t,e.col));if(e.colSpan)for(let t=e.col+1;t<e.col+e.colSpan;t++)v._gridCellReConnectedWithControlSpan(v._getCell(e.row,t))},v._getData=(e,o=[])=>{const l={};return l.gridId=b,l.gridName=v.info.gName,l.id=e.cId,l.index=e.cIndex,l.name=e.cName,l.row=e.row,l.col=e.col,l.untarget=e.cUntarget,l.colVisible=e.cColVisible,l.rowVisible=e.cRowVisible,l.required=e.cRequired,l.resizable=e.cResizable,l.originWidth=e.cOriginWidth,l.dataType=e.cDataType,l.selectSize=e.cSelectSize,l.locked=e.cLocked,l.lockedColor=e.cLockedColor,l.format=e.cFormat,l.codes=t.deepCopy(e.cCodes),l.defaultCode=e.cDefaultCode,l.maxLength=e.cMaxLength,l.maxByte=e.cMaxByte,l.maxNumber=e.cMaxNumber,l.minNumber=e.cMinNumber,l.roundNumber=e.cRoundNumber,l.align=e.cAlign,l.verticalAlign=e.cVerticalAlign,l.backColor=e.cBackColor,l.fontColor=e.cFontColor,l.fontBold=e.cFontBold,l.fontItalic=e.cFontItalic,l.fontThruline=e.cFontThruline,l.fontUnderline=e.cFontUnderline,l.value=t.deepCopy(e.cValue),l.filter=t.deepCopy(e.cFilter),o&&(o.indexOf("untarget")>=0&&delete l.untarget,o.indexOf("colVisible")>=0&&delete l.colVisible,o.indexOf("rowVisible")>=0&&delete l.rowVisible,o.indexOf("required")>=0&&delete l.required,o.indexOf("resizable")>=0&&delete l.resizable,o.indexOf("originWidth")>=0&&delete l.originWidth,o.indexOf("dataType")>=0&&delete l.dataType,o.indexOf("selectSize")>=0&&delete l.selectSize,o.indexOf("locked")>=0&&delete l.locked,o.indexOf("lockedColor")>=0&&delete l.lockedColor,o.indexOf("format")>=0&&delete l.format,o.indexOf("codes")>=0&&delete l.codes,o.indexOf("defaultCode")>=0&&delete l.defaultCode,o.indexOf("maxLength")>=0&&delete l.maxLength,o.indexOf("maxByte")>=0&&delete l.maxByte,o.indexOf("maxNumber")>=0&&delete l.maxNumber,o.indexOf("minNumber")>=0&&delete l.minNumber,o.indexOf("roundNumber")>=0&&delete l.roundNumber,o.indexOf("align")>=0&&delete l.align,o.indexOf("verticalAlign")>=0&&delete l.verticalAlign,o.indexOf("backColor")>=0&&delete l.backColor,o.indexOf("fontColor")>=0&&delete l.fontColor,o.indexOf("fontBold")>=0&&delete l.fontBold,o.indexOf("fontItalic")>=0&&delete l.fontItalic,o.indexOf("fontThruline")>=0&&delete l.fontThruline,o.indexOf("fontUnderline")>=0&&delete l.fontUnderline,o.indexOf("value")>=0&&delete l.value,o.indexOf("filter")>=0&&delete l.filter),l.text=t.getCellText(e),l},v._setCellData=(e,o,l,r=!0)=>{v._checkRowIndex(e);const n=v._getColIndex(o,!0);if(n<=2){if(r)throw new Error("The row number or status columns are immutable.");return!1}const i=v._getCell(e,n);return l.untarget&&(i.cUntarget=l.untarget),l.dataType&&(i.cDataType=l.dataType),l.selectSize&&(i.cSelectSize=l.selectSize),l.locked&&(i.cLocked=l.locked),l.lockedColor&&(i.cLockedColor=l.lockedColor),l.format&&(i.cFormat=l.format),l.codes&&(i.cCodes=l.codes),l.defaultCode&&(i.cDefaultCode=l.defaultCode),l.maxLength&&(i.cMaxLength=l.maxLength),l.maxByte&&(i.cMaxByte=l.maxByte),l.maxNumber&&(i.cMaxNumber=l.maxNumber),l.minNumber&&(i.cMinNumber=l.minNumber),l.roundNumber&&(i.cRoundNumber=l.roundNumber),l.value&&(i.cValue=l.value),l.align&&(i.cAlign=l.align),l.verticalAlign&&(i.cVerticalAlign=l.verticalAlign),l.backColor&&(i.cBackColor=l.backColor),l.fontColor&&(i.cFontColor=l.fontColor),l.fontBold&&(i.cFontBold=l.fontBold),l.fontItalic&&(i.cFontItalic=l.fontItalic),l.fontThruline&&(i.cFontThruline=l.fontThruline),l.fontUnderline&&(i.cFontUnderline=l.fontUnderline),t.reConnectedCallbackElement(i),t.reloadGridWithModifyCell(i.gId,i.cIndex),!0},v.setCellData=(e,t,o)=>v._setCellData(e,t,o),v.getCellData=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);v._checkColIndex(o);const l=v._getCell(e,o);return v._getData(l)},v.setCellValue=(e,o,l,r=!1)=>{v._checkRowIndex(e);const n=v._getColIndex(o,!0);v._checkColIndex(n);const i=v._getCell(e,n);return r?t.recodeGridModify(i.gId,t.getRecodesWithModifyValue(i,l,!0)):(i.cValue=t.getValidValue(i,l),t.reConnectedCallbackElement(i),t.reloadGridWithModifyCell(i.gId,i.cIndex)),!0},v.getCellValue=(e,o)=>{v._checkRowIndex(e);const l=v._getColIndex(o,!0);return v._checkColIndex(l),t.deepCopy(v._getCell(e,l).cValue)},v.getCellText=(e,o)=>{v._checkRowIndex(e);const l=v._getColIndex(o,!0);return v._checkColIndex(l),t.getCellText(v._getCell(e,l))},v.setCellRequired=(e,t,o)=>{v._checkRowIndex(e);const l=v._getColIndex(t,!0);if(v._checkColIndex(l),v._checkColRownumOrStatus(l),"boolean"!=typeof o)throw new Error("Please insert a boolean type.");const r=v._getCell(e,l);return r.cRequired=o,v._gridCellReConnectedWithControlSpan(r),!0},v.getCellRequired=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cRequired},v.setCellDataType=(e,o,r)=>{v._checkRowIndex(e);const n=v._getColIndex(o,!0);if(v._checkColIndex(n),v._checkColRownumOrStatus(n),!t.isIncludeEnum(l,r))throw new Error("Please insert a valid dataType.");const i=v._getCell(e,n);return i.cDataType=r,t.reConnectedCallbackElement(i),t.reloadGridWithModifyCell(b,n),!0},v.getCellDataType=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._checkColRownumOrStatus(o),v._getCell(e,o).cDataType},v.setCellLocked=(e,t,o)=>{v._checkRowIndex(e);const l=v._getColIndex(t,!0);if(v._checkColIndex(l),v._checkColRownumOrStatus(l),"boolean"!=typeof o)throw new Error("Please insert a boolean type.");const r=v._getCell(e,l);return r.cLocked=o,v._gridCellReConnectedWithControlSpan(r),!0},v.isCellLocked=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cLocked},v.setCellLockedColor=(e,t,o)=>{v._checkRowIndex(e);const l=v._getColIndex(t,!0);if(v._checkColIndex(l),v._checkColRownumOrStatus(l),"boolean"!=typeof o)throw new Error("Please insert a boolean type.");const r=v._getCell(e,l);return r.cLockedColor=o,v._gridCellReConnectedWithControlSpan(r),!0},v.isCellLockedColor=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cLockedColor},v.setCellFormat=(e,o,l)=>{v._checkRowIndex(e);const r=v._getColIndex(o,!0);if(v._checkColIndex(r),v._checkColRownumOrStatus(r),"string"!=typeof l)throw new Error("Please insert a string type.");const n=v._getCell(e,r);return n.cFormat=l,"mask"===n.cDataType&&(n.cValue=t.getValidValue(n,n.cValue)),v._gridCellReConnectedWithControlSpan(n),t.reloadGridWithModifyCell(b,r),!0},v.getCellFormat=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cFormat},v.setCellCodes=(e,o,l)=>{v._checkRowIndex(e);const r=v._getColIndex(o,!0);if(v._checkColIndex(r),v._checkColRownumOrStatus(r),!Array.isArray(l))throw new Error("Please insert a vaild codes. (Array)");const n=v._getCell(e,r);return n.cCodes=l,"code"===n.cDataType&&(n.cValue=t.getValidValue(n,n.cValue)),v._gridCellReConnectedWithControlSpan(n),t.reloadGridWithModifyCell(b,r),!0},v.getCellCodes=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cCodes},v.setCellDefaultCode=(e,o,l)=>{v._checkRowIndex(e);const r=v._getColIndex(o,!0);v._checkColIndex(r),v._checkColRownumOrStatus(r);const n=v._getCell(e,r);return n.cDefaultCode=l,"code"===n.cDataType&&(n.cValue=t.getValidValue(n,n.cValue)),v._gridCellReConnectedWithControlSpan(n),t.reloadGridWithModifyCell(b,r),!0},v.getCellDefaultCode=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cDefaultCode},v.setCellMaxLength=(e,o,l)=>{v._checkRowIndex(e);const r=v._getColIndex(o,!0);v._checkColIndex(r),v._checkColRownumOrStatus(r),l=t.validatePositiveIntegerAndZero(l);const n=v._getCell(e,r);return n.cMaxLength=l,"text"===n.cDataType&&(n.cValue=t.getValidValue(n,n.cValue)),v._gridCellReConnectedWithControlSpan(n),t.reloadGridWithModifyCell(b,r),!0},v.getCellMaxLength=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cMaxLength},v.setCellMaxByte=(e,o,l)=>{v._checkRowIndex(e);const r=v._getColIndex(o,!0);v._checkColIndex(r),v._checkColRownumOrStatus(r),l=t.validatePositiveIntegerAndZero(l);const n=v._getCell(e,r);return n.cMaxByte=l,"text"===n.cDataType&&(n.cValue=t.getValidValue(n,n.cValue)),v._gridCellReConnectedWithControlSpan(n),t.reloadGridWithModifyCell(b,r),!0},v.getCellMaxByte=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cMaxByte},v.setCellMaxNumber=(e,o,l)=>{v._checkRowIndex(e);const r=v._getColIndex(o,!0);v._checkColIndex(r),v._checkColRownumOrStatus(r),l=t.validateNumber(l);const n=v._getCell(e,r);return n.cMaxNumber=l,"number"===n.cDataType&&(n.cValue=t.getValidValue(n,n.cValue)),v._gridCellReConnectedWithControlSpan(n),t.reloadGridWithModifyCell(b,r),!0},v.getCellMaxNumber=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cMaxNumber},v.setCellMinNumber=(e,o,l)=>{v._checkRowIndex(e);const r=v._getColIndex(o,!0);v._checkColIndex(r),v._checkColRownumOrStatus(r),l=t.validateNumber(l);const n=v._getCell(e,r);return n.cMinNumber=l,"number"===n.cDataType&&(n.cValue=t.getValidValue(n,n.cValue)),v._gridCellReConnectedWithControlSpan(n),t.reloadGridWithModifyCell(b,r),!0},v.getCellMinNumber=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cMinNumber},v.setCellRoundNumber=(e,o,l)=>{v._checkRowIndex(e);const r=v._getColIndex(o,!0);v._checkColIndex(r),v._checkColRownumOrStatus(r),l=t.validateIntegerAndZero(l);const n=v._getCell(e,r);return n.cRoundNumber=l,"number"===n.cDataType&&(n.cValue=t.getValidValue(n,n.cValue)),v._gridCellReConnectedWithControlSpan(n),t.reloadGridWithModifyCell(b,r),!0},v.getCellRoundNumber=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cRoundNumber},v.setCellAlign=(e,o,l)=>{v._checkRowIndex(e);const n=v._getColIndex(o,!0);if(v._checkColIndex(n),!t.isIncludeEnum(r,l))throw new Error("Please insert a vaild align. (left, center, right)");const i=v._getCell(e,n);return i.cAlign=l,v._gridCellReConnectedWithControlSpan(i),!0},v.getCellAlign=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cAlign},v.setCellVerticalAlign=(e,o,l)=>{v._checkRowIndex(e);const r=v._getColIndex(o,!0);if(v._checkColIndex(r),!t.isIncludeEnum(n,l))throw new Error("Please insert a vaild align. (top, center, bottom)");const i=v._getCell(e,r);return i.cVerticalAlign=l,v._gridCellReConnectedWithControlSpan(i),!0},v.getCellVerticalAlign=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cVerticalAlign},v.setCellBackColor=(e,o,l)=>{v._checkRowIndex(e);const r=v._getColIndex(o,!0);if(v._checkColIndex(r),"#000"!==l&&"#000000"!==l&&"#000000"===t.getHexColorFromColorName(l))throw new Error("Please enter the correct hexadecimal color. (#ffffff)");const n=v._getCell(e,r);return n.cBackColor=l,v._gridCellReConnectedWithControlSpan(n),!0},v.getCellBackColor=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cBackColor},v.setCellFontColor=(e,o,l)=>{v._checkRowIndex(e);const r=v._getColIndex(o,!0);if(v._checkColIndex(r),"#000"!==l&&"#000000"!==l&&"#000000"===t.getHexColorFromColorName(l))throw new Error("Please enter the correct hexadecimal color. (#ffffff)");const n=v._getCell(e,r);return n.cFontColor=l,v._gridCellReConnectedWithControlSpan(n),!0},v.getCellFontColor=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cFontColor},v.setCellFontBold=(e,t,o)=>{v._checkRowIndex(e);const l=v._getColIndex(t,!0);if(v._checkColIndex(l),"boolean"!=typeof o)throw new Error("Please insert a boolean type.");const r=v._getCell(e,l);return r.cFontBold=o,v._gridCellReConnectedWithControlSpan(r),!0},v.isCellFontBold=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cFontBold},v.setCellFontItalic=(e,t,o)=>{v._checkRowIndex(e);const l=v._getColIndex(t,!0);if(v._checkColIndex(l),"boolean"!=typeof o)throw new Error("Please insert a boolean type.");const r=v._getCell(e,l);return r.cFontItalic=o,v._gridCellReConnectedWithControlSpan(r),!0},v.isCellFontItalic=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cFontItalic},v.setCellFontThruline=(e,t,o)=>{v._checkRowIndex(e);const l=v._getColIndex(t,!0);if(v._checkColIndex(l),"boolean"!=typeof o)throw new Error("Please insert a boolean type.");const r=v._getCell(e,l);return r.cFontThruline=o,v._gridCellReConnectedWithControlSpan(r),!0},v.isCellFontThruline=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cFontThruline},v.setCellFontUnderline=(e,t,o)=>{v._checkRowIndex(e);const l=v._getColIndex(t,!0);if(v._checkColIndex(l),"boolean"!=typeof o)throw new Error("Please insert a boolean type.");const r=v._getCell(e,l);return r.cFontUnderline=o,v._gridCellReConnectedWithControlSpan(r),!0},v.isCellFontUnderline=(e,t)=>{v._checkRowIndex(e);const o=v._getColIndex(t,!0);return v._checkColIndex(o),v._getCell(e,o).cFontUnderline},v.setTargetCell=(e,o)=>{v._checkRowIndex(e);const l=v._getColIndex(o,!0);v._checkColIndex(l);const r=v._getCell(e,l);return!!t.isCellVisible(r)&&(t.activeGrid=v,t.selectCell(r))},v.getTargetRow=()=>v.variables._targetCell?v.variables._targetCell.row:null,v.getTargetCol=()=>v.variables._targetCell?v.variables._targetCell.cId:null,v.setActiveCells=(e,o,l,r)=>{v._checkRowIndex(e),v._checkRowIndex(l);const n=v._getColIndex(o,!0),i=v._getColIndex(r,!0);v._checkColIndex(n),v._checkColIndex(i);const a=v._getCell(e,n),s=v._getCell(l,i);return!!t.isCellVisible(a)&&(!!t.isCellVisible(s)&&(t.activeGrid=v,v.variables._targetCell=a,t.unselectCells(v.gId),t.selectCells(a,s,a)))},v.getActiveRows=()=>v.variables._activeRows,v.getActiveCols=()=>{const e=[];return v.variables._activeCols.forEach((t=>{e.push(v._getColInfo(t).cId)})),e},v.getActiveRange=()=>{const e={startRow:null,startColId:null,endRow:null,endColId:null},t=v.variables._activeCells;return t.length>0&&(e.startRow=t[0].row,e.startColId=t[0].cId,e.endRow=t[t.length-1].row,e.endColId=t[t.length-1].cId),e},v.editCell=(e,o)=>{v._checkRowIndex(e);const l=v._getColIndex(o,!0);v._checkColIndex(l),v._checkColRownumOrStatus(l);const r=v._getCell(e,o);if(!(["select","checkbox","button","link"].indexOf(r.cDataType)>=0)&&v.setTargetCell(e,o))return t.createGridEditor(r),!0},v.redo=()=>t.redoundo(b),v.undo=()=>t.redoundo(b,!1),v.removeGridMethod=()=>{delete window[b]},v._getHeader=()=>I,v._getBody=()=>w,v._getFooter=()=>_,v._loadHeader(),v._loadFooter();const E={};Object.keys(v).forEach((e=>{"function"!=typeof v[e]||e.startsWith("_")||(E[e]=(...t)=>v[e](...t))})),t.deepFreeze(E),window[b]=E,v.variables={},v.variables._activeRows=[],v.variables._activeCols=[],v.variables._activeCells=[],v.variables._targetCell=null,v.variables._recodes=[],v.variables._recodeseq=0,v.variables._sortToggle={},v.variables._filters=[],v.variables._isDrawable=!0,I.addEventListener("dblclick",(function(o){if(t.onHeaderDragging)return;let l;if("ghd"===o.target.gType)l=o.target;else{if("sort"!==o.target.gType)return;l=o.target.parentNode}if(!1===t.doEventWithCheckChanged(l.gId,"_onBeforeDblClickHeader",l.row,l.cId))return o.stopPropagation(),void o.preventDefault();if("checkbox"===o.target.cDataType&&v.info.gAllCheckable&&l.isLastCell)return void v.setColSameValue(o.target.cIndex,!t.getCheckboxCellTrueOrFalse(v._getCell(1,o.target.cIndex)),!0);if(!v.info.gSortable)return;if(!v._getColInfo(l.cId).cSortable)return;if(!l.isLastCell)return;v.sort(l.cId,!v.variables._sortToggle[l.cId]);let r;l.parentNode.querySelectorAll("."+l.gId+"_sortSpan").forEach((e=>{e.parentNode.removeChild(e)})),v.variables._sortToggle[l.cId]?e.sortAscSpan?r=e.sortAscSpan.cloneNode(!0):(r=document.createElement("span"),r.style.fontSize="0.5em",r.style.paddingLeft="5px",r.innerText="▲"):e.sortDescSpan?r=e.sortDescSpan.cloneNode(!0):(r=document.createElement("span"),r.style.fontSize="0.5em",r.style.paddingLeft="5px",r.innerText="▼"),r.gId=l.gId,r.isChild=!0,r.gType="sort",r.classList.add(l.gId+"_sortSpan"),r.classList.add(v.variables._sortToggle[l.cId]?l.gId+"_ascSpan":l.gId+"_descSpan"),l.append(r),t.doEventWithCheckChanged(l.gId,"_onAfterDblClickHeader",l.row,l.cId)})),I.addEventListener("click",(function(e){let o;if("ghd"===e.target.gType){if(o=e.target,!1===t.doEventWithCheckChanged(o.gId,"_onBeforeClickHeader",o.row,o.cId))return e.stopPropagation(),void e.preventDefault();t.doEventWithCheckChanged(o.gId,"_onAfterClickHeader",o.row,o.cId)}else if("filter"===e.target.gType){if(o=e.target.parentNode,!1===t.doEventWithCheckChanged(o.gId,"_onClickFilter",o.row,o.cId,e.target))return e.stopPropagation(),void e.preventDefault();const l=o.parentNode.querySelectorAll("."+o.gId+"_filterSelect"),r=e.target.querySelectorAll("."+o.gId+"_filterSelect")[0];l.forEach((e=>{r!==e&&"ALL"===e.value&&(e.style.display="none")})),"none"===r.style.display?r.style.display="block":r.style.display="none"}})),w.addEventListener("mousemove",(function(e){t.isDragging&&(t.mouseX=e.clientX,t.mouseY=e.clientY)})),w.addEventListener("mouseleave",(function(e){if(t.isDragging){const o=e.clientX,l=e.clientY,r=o-t.mouseX,n=l-t.mouseY;let i="";i=Math.abs(r)>Math.abs(n)?r>0?"right":"left":n>0?"down":"up",t.startScrolling(e.target.gId,i)}})),w.addEventListener("mouseenter",(function(e){t.scrollInterval&&t.stopScrolling()})),w.addEventListener("dblclick",(function(e){let o;o="gbdv"===e.target.gType?e.target.parentNode:e.target,"gbd"===o.gType&&!1!==t.doEventWithCheckChanged(o.gId,"_onBeforeDblClickCell",o.row,o.cId)&&(["select","checkbox","button","link"].indexOf(o.cDataType)>=0||(t.createGridEditor(o),t.doEventWithCheckChanged(o.gId,"_onAfterDblClickCell",o.row,o.cId)))})),v.addEventListener("click",(function(e){if(!e.target.gType)return;let o;if(o="gbdv"===e.target.gType?e.target.parentNode:e.target,o&&!o.cUntarget&&"gbd"===o.gType){if(e.target.nType)switch(e.target.nType){case"checkbox":if(!1===t.doEventWithCheckChanged(o.gId,"_onBeforeClickCell",o.row,o.cId))return e.stopPropagation(),void e.preventDefault();if(!1===t.doEventWithCheckChanged(o.gId,"_onClickCheckbox",o.row,o.cId,e.target))return e.stopPropagation(),void e.preventDefault();t.editOldValue=e.target.parentNode.cValue;break;case"button":if(!1===t.doEventWithCheckChanged(o.gId,"_onBeforeClickCell",o.row,o.cId))return e.stopPropagation(),void e.preventDefault();if(!1===t.doEventWithCheckChanged(o.gId,"_onClickButton",o.row,o.cId,e.target))return e.stopPropagation(),void e.preventDefault();break;case"link":if(!1===t.doEventWithCheckChanged(o.gId,"_onBeforeClickCell",o.row,o.cId))return e.stopPropagation(),void e.preventDefault();if(!1===t.doEventWithCheckChanged(o.gId,"_onClickLink",o.row,o.cId,e.target))return e.stopPropagation(),void e.preventDefault()}t.doEventWithCheckChanged(o.gId,"_onAfterClickCell",o.row,o.cId)}})),v.addEventListener("mousedown",(function(e){if(!e.target.gType)return;let o;if(o="gbdv"===e.target.gType?e.target.parentNode:e.target,!o.cUntarget&&"gbd"===o.gType){if(e.target.nType){if("select"===e.target.nType){if(!1===t.doEventWithCheckChanged(o.gId,"_onBeforeClickCell",o.row,o.cId))return e.stopPropagation(),void e.preventDefault();if(!1===t.doEventWithCheckChanged(o.gId,"_onClickSelect",o.row,o.cId,e.target))return e.stopPropagation(),void e.preventDefault();t.editOldValue=e.target.value}}else if(!1===t.doEventWithCheckChanged(o.gId,"_onBeforeClickCell",o.row,o.cId))return e.stopPropagation(),void e.preventDefault();t.activeGrid=this,t.isDragging=!0,"range"===this.info.gSelectionPolicy&&e.shiftKey&&this.variables._targetCell?(t.unselectCells(this.gId),t.selectCells(this.variables._targetCell,o)):t.selectCell(o)}})),v.addEventListener("mousemove",(function(e){"range"===this.info.gSelectionPolicy&&t.mouseoverCell!==e.target&&(t.mouseoverCell=e.target,t.isDragging&&"gbd"===e.target.gType&&this.variables._targetCell&&(t.unselectCells(this.gId),t.selectCells(this.variables._targetCell,e.target)))})),v.addEventListener("mouseleave",(function(e){"range"===this.info.gSelectionPolicy&&(t.mouseoverCell=null,t.isDragging&&(t.isDragging=!1))})),t[b]=v,v.append(I),v.append(w),v.append(_),vanillagrid.append(v),v.events={},window[b+"_onActiveCell"]||(window[b+"_onActiveCell"]=(e,t)=>!0),v.events[b+"_onActiveCell"]=window[b+"_onActiveCell"],window[b+"_onActiveCells"]||(window[b+"_onActiveCells"]=(e,t,o,l)=>!0),v.events[b+"_onActiveCells"]=window[b+"_onActiveCells"],window[b+"_onActiveRow"]||(window[b+"_onActiveRow"]=e=>!0),v.events[b+"_onActiveRow"]=window[b+"_onActiveRow"],window[b+"_onActiveRows"]||(window[b+"_onActiveRows"]=(e,t)=>!0),v.events[b+"_onActiveRows"]=window[b+"_onActiveRows"],window[b+"_onActiveCol"]||(window[b+"_onActiveCol"]=e=>!0),v.events[b+"_onActiveCol"]=window[b+"_onActiveCol"],window[b+"_onActiveCols"]||(window[b+"_onActiveCols"]=(e,t)=>!0),v.events[b+"_onActiveCols"]=window[b+"_onActiveCols"],window[b+"_onBeforeChange"]||(window[b+"_onBeforeChange"]=(e,t,o,l)=>!0),v.events[b+"_onBeforeChange"]=window[b+"_onBeforeChange"],window[b+"_onAfterChange"]||(window[b+"_onAfterChange"]=(e,t,o,l)=>!0),v.events[b+"_onAfterChange"]=window[b+"_onAfterChange"],window[b+"_onBeforeClickCell"]||(window[b+"_onBeforeClickCell"]=(e,t)=>!0),v.events[b+"_onBeforeClickCell"]=window[b+"_onBeforeClickCell"],window[b+"_onAfterClickCell"]||(window[b+"_onAfterClickCell"]=(e,t)=>!0),v.events[b+"_onAfterClickCell"]=window[b+"_onAfterClickCell"],window[b+"_onClickSelect"]||(window[b+"_onClickSelect"]=(e,t,o)=>!0),v.events[b+"_onClickSelect"]=window[b+"_onClickSelect"],window[b+"_onClickCheckbox"]||(window[b+"_onClickCheckbox"]=(e,t,o)=>!0),v.events[b+"_onClickCheckbox"]=window[b+"_onClickCheckbox"],window[b+"_onClickButton"]||(window[b+"_onClickButton"]=(e,t,o)=>!0),v.events[b+"_onClickButton"]=window[b+"_onClickButton"],window[b+"_onClickLink"]||(window[b+"_onClickLink"]=(e,t,o)=>!0),v.events[b+"_onClickLink"]=window[b+"_onClickLink"],window[b+"_onBeforeDblClickCell"]||(window[b+"_onBeforeDblClickCell"]=(e,t)=>!0),v.events[b+"_onBeforeDblClickCell"]=window[b+"_onBeforeDblClickCell"],window[b+"_onAfterDblClickCell"]||(window[b+"_onAfterDblClickCell"]=(e,t)=>!0),v.events[b+"_onAfterDblClickCell"]=window[b+"_onAfterDblClickCell"],window[b+"_onBeforeClickHeader"]||(window[b+"_onBeforeClickHeader"]=(e,t)=>!0),v.events[b+"_onBeforeClickHeader"]=window[b+"_onBeforeClickHeader"],window[b+"_onAfterClickHeader"]||(window[b+"_onAfterClickHeader"]=(e,t)=>!0),v.events[b+"_onAfterClickHeader"]=window[b+"_onAfterClickHeader"],window[b+"_onBeforeDblClickHeader"]||(window[b+"_onBeforeDblClickHeader"]=(e,t)=>!0),v.events[b+"_onBeforeDblClickHeader"]=window[b+"_onBeforeDblClickHeader"],window[b+"_onAfterDblClickHeader"]||(window[b+"_onAfterDblClickHeader"]=(e,t)=>!0),v.events[b+"_onAfterDblClickHeader"]=window[b+"_onAfterDblClickHeader"],window[b+"_onEditEnter"]||(window[b+"_onEditEnter"]=(e,t,o)=>!0),v.events[b+"_onEditEnter"]=window[b+"_onEditEnter"],window[b+"_onEditEnding"]||(window[b+"_onEditEnding"]=(e,t,o,l)=>!0),v.events[b+"_onEditEnding"]=window[b+"_onEditEnding"],window[b+"_onClickFilter"]||(window[b+"_onClickFilter"]=(e,t,o)=>!0),v.events[b+"_onClickFilter"]=window[b+"_onClickFilter"],window[b+"_onChooseFilter"]||(window[b+"_onChooseFilter"]=(e,t,o,l)=>!0),v.events[b+"_onChooseFilter"]=window[b+"_onChooseFilter"],window[b+"_onPaste"]||(window[b+"_onPaste"]=(e,t,o)=>!0),v.events[b+"_onPaste"]=window[b+"_onPaste"],window[b+"_onCopy"]||(window[b+"_onCopy"]=(e,t,o,l)=>!0),v.events[b+"_onCopy"]=window[b+"_onCopy"],window[b+"_onResize"]||(window[b+"_onResize"]=e=>!0),v.events[b+"_onResize"]=window[b+"_onResize"],window[b+"_onKeydownEditor"]||(window[b+"_onKeydownEditor"]=e=>!0),v.events[b+"_onKeydownEditor"]=window[b+"_onKeydownEditor"],window[b+"_onInputEditor"]||(window[b+"_onInputEditor"]=e=>!0),v.events[b+"_onInputEditor"]=window[b+"_onInputEditor"],window[b+"_onKeydownGrid"]||(window[b+"_onKeydownGrid"]=e=>!0),v.events[b+"_onKeydownGrid"]=window[b+"_onKeydownGrid"],Object.freeze(v.events),v._getGridCssStyle=()=>{const e={};return e["."+b+"_vanillagrid"]={width:v.cssInfo.width,height:v.cssInfo.height,display:v.info.gVisible?"block":"none",border:"1px solid "+v.cssInfo.gridBorderColor,overflow:"auto","background-color":"#fff",margin:v.cssInfo.margin,padding:v.cssInfo.padding,"font-family":v.cssInfo.gridFontFamily},e["."+b+"_v-g"]={"background-color":v.cssInfo.bodyBackColor,display:"flex",position:"relative","flex-direction":"column",height:"100%","overflow-x":"auto","overflow-y":"auto","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"},e["."+b+"_v-g-h"]={position:"-webkit-sticky",position:"sticky",top:"0","z-index":"250",display:"grid"},e["."+b+"_v-g-b"]={"margin-bottom":"22px",display:"grid",position:"relative"},e["."+b+"_v-g-f"]={position:"-webkit-sticky",position:"sticky",bottom:"0","z-index":"250",display:"grid","margin-top":"auto"},e["."+b+"_h-v-g-d"]={"background-color":v.cssInfo.headerCellBackColor,"text-align":"center","align-items":v.cssInfo.verticalAlign,"border-bottom":v.cssInfo.horizenBorderSize+"px solid "+v.cssInfo.headerCellBorderColor,"border-right":v.cssInfo.verticalBorderSize+"px solid "+v.cssInfo.headerCellBorderColor,color:v.cssInfo.headerCellFontColor},e["."+b+"_b-v-g-d"]={"align-items":v.cssInfo.verticalAlign,"background-color":v.cssInfo.bodyCellBackColor,"border-bottom":v.cssInfo.horizenBorderSize+"px solid "+v.cssInfo.bodyCellBorderColor,"border-right":v.cssInfo.verticalBorderSize+"px solid "+v.cssInfo.bodyCellBorderColor,color:v.cssInfo.bodyCellFontColor},e["."+b+"_f-v-g-d"]={"align-items":v.cssInfo.verticalAlign,"background-color":v.cssInfo.footerCellBackColor,"border-top":v.cssInfo.horizenBorderSize+"px solid "+v.cssInfo.footerCellBorderColor,color:v.cssInfo.footerCellFontColor},e["."+b+"_f-v-g-d-value"]={"border-right":v.cssInfo.verticalBorderSize+"px solid "+v.cssInfo.bodyCellBorderColor},e["."+b+"_b-v-g-d-alter"]={"align-items":v.cssInfo.verticalAlign,"background-color":v.cssInfo.alterRowBackColor,"border-bottom":v.cssInfo.horizenBorderSize+"px solid "+v.cssInfo.bodyCellBorderColor,"border-right":v.cssInfo.verticalBorderSize+"px solid "+v.cssInfo.bodyCellBorderColor,color:v.cssInfo.alterRowFontColor},e["."+b+"_b-v-g-d-locked"]={"background-color":v.cssInfo.lockCellBackColor,"border-bottom":v.cssInfo.horizenBorderSize+"px solid "+v.cssInfo.bodyCellBorderColor,"border-right":v.cssInfo.verticalBorderSize+"px solid "+v.cssInfo.bodyCellBorderColor,color:v.cssInfo.lockCellFontColor},e["."+b+"_v-g-d"]={"font-size":v.cssInfo.cellFontSize,display:"flex","min-height":v.cssInfo.cellMinHeight,overflow:"hidden","white-space":"nowrap","padding-left":"5px","padding-right":"5px"},e["."+b+"_editor"]={"font-size":v.cssInfo.cellFontSize,"background-color":v.cssInfo.editorBackColor,border:"none",color:v.cssInfo.editorFontColor,overflow:"hidden",resize:"none","box-sizing":"border-box","font-family":v.cssInfo.gridFontFamily,"text-align":"inherit"},e["."+b+"_editor:focus"]={outline:"none"},e["."+b+"_mouseover-cell"]={"background-color":v.cssInfo.mouseoverCellBackColor+" !important",color:v.cssInfo.mouseoverCellFontColor+" !important"},e["."+b+"_selected-cell"]={"background-color":v.cssInfo.selectCellBackColor+" !important",color:v.cssInfo.selectCellFontColor+" !important"},e["."+b+"_selected-col"]={"background-color":v.cssInfo.selectColBackColor,color:v.cssInfo.selectColFontColor},e["."+b+"_selected-row"]={"background-color":v.cssInfo.selectRowBackColor,color:v.cssInfo.selectRowFontColor},e["."+b+"_filterSpan"]={display:"block","font-size":"0.8em","padding-right":"8px",cursor:"pointer"},e["."+b+"_filterSelect"]={position:"absolute","z-index":"300",margin:"5px"},e["."+b+"_data-value-select"]={"font-size":v.cssInfo.cellFontSize,cursor:"pointer",border:"none",background:"none",color:"inherit"},e["."+b+"_data-value-select:focus"]={outline:"none"},e["."+b+"_data-value-checkbox"]={cursor:"pointer"},e["."+b+"_data-value-button"]={height:"90%","font-size":v.cssInfo.cellFontSize,cursor:"pointer",border:"none",color:v.cssInfo.buttonFontColor,"background-color":v.cssInfo.buttonBackColor,"box-shadow":"0.75px 0.75px 1px 0.25px "+v.cssInfo.buttonBorderColor},e["."+b+"_data-value-button:hover"]={color:v.cssInfo.buttonHoverFontColor,"background-color":v.cssInfo.buttonHoverBackColor},e["."+b+"_data-value-button:active"]={color:v.cssInfo.buttonActiveFontColor,"background-color":v.cssInfo.buttonActiveBackColor,"box-shadow":"0px 0px 0.5px 0.25px "+v.cssInfo.buttonBorderColor},e["."+b+"_data-value-button:focus"]={outline:"none"},e["."+b+"_data-value-button:disabled"]={opacity:"0.7"},e["."+b+"_data-value-link"]={color:v.cssInfo.linkFontColor,"text-decoration":v.cssInfo.linkHasUnderLine?"underline":"none"},e["."+b+"_data-value-link:visited"]={color:v.cssInfo.linkVisitedFontColor},e["."+b+"_data-value-link:hover"]={color:v.cssInfo.linkHoverFontColor+" !important"},e["."+b+"_data-value-link:active"]={color:v.cssInfo.linkActiveFontColor+" !important"},e["."+b+"_data-value-link:focus"]={color:v.cssInfo.linkFocusFontColor+" !important"},e},v._setGridCssStyle=()=>{let e="";const o=v._getGridCssStyle(),l=Object.keys(o);for(let r=0;r<l.length;r++)e=e+l[r]+" {"+t.getCssTextFromObject(o[l[r]])+"}\n";let r=document.getElementById(b+"_styles-sheet");r?(t.removeAllChild(r),r.appendChild(document.createTextNode(e))):(r=document.createElement("style"),r.setAttribute("id",b+"_styles-sheet"),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(r))},v._setGridCssStyle()}e._docEvent_mousedown=function(e){t.activeGridEditor&&t.activeGridEditor!==e.target&&t.modifyCell(),t.activeGrid&&!t.activeGrid.contains(e.target)&&(t.activeGrid=null)},document.removeEventListener("mousedown",e._docEvent_mousedown),document.addEventListener("mousedown",e._docEvent_mousedown),e._docEvent_mouseup=function(e){t.mouseX=0,t.mouseY=0,t.stopScrolling(),t.isDragging&&(t.isDragging=!1),t.isHeaderDragging&&(t.isHeaderDragging=!1)},document.removeEventListener("mouseup",e._docEvent_mouseup),document.addEventListener("mouseup",e._docEvent_mouseup),e._docEvent_keydown=function(o){if(t.activeGrid&&!t.activeGridEditor){const l=t.activeGrid,r=l.gId;if(!1===t.doEventWithCheckChanged(r,"_onKeydownGrid",o))return o.stopPropagation(),void o.preventDefault();if(o.ctrlKey||o.metaKey)switch(o.key){case"z":case"Z":t.redoundo(r),o.preventDefault();break;case"y":case"Y":t.redoundo(r,!1),o.preventDefault();break;case"a":case"A":l.variables._targetCell=l._getCell(1,3),t.selectCells(l._getCell(1,1),l._getCell(l.getRowCount(),l.getColCount())),o.preventDefault()}if("none"===l.info.gSelectionPolicy||l.variables._activeCells.length<=0)return;const n=l.variables._activeCells[0],i=l.variables._activeCells[l.variables._activeCells.length-1];let a;switch(o.key){case"Tab":a=t.getTabCell(l.variables._targetCell,o.shiftKey),t.selectCell(a),o.preventDefault();break;case"F2":t.createGridEditor(l.variables._targetCell),o.preventDefault();break;case"Enter":"select"===l.variables._targetCell.cDataType?(t.editOldValue=l.variables._targetCell.firstChild.value,l.variables._targetCell.firstChild.focus()):"checkbox"===l.variables._targetCell.cDataType?(t.editOldValue=l.variables._targetCell.cValue,l.variables._targetCell.firstChild.checked=!l.variables._targetCell.firstChild.checked,t.selectAndCheckboxOnChange(l.variables._targetCell.firstChild),a=t.getMoveRowCell(l.variables._targetCell,1),t.selectCell(a),o.preventDefault()):(Object.keys(e.dataType).forEach((t=>{if(l.variables._targetCell.cDataType===t&&e.dataType[t].onSelectedKeyDownEnter){if("function"!=typeof e.dataType[t].onSelectedKeyDownEnter)throw new Error("onSelectedKeyDownEnter must be a function.");e.dataType[t].onSelectedKeyDownEnter(o,l._getData(l.variables._targetCell))}})),t.createGridEditor(l.variables._targetCell,!0),o.preventDefault());break;case" ":if("select"===l.variables._targetCell.cDataType){if(l.variables._targetCell.cUntarget||l.variables._targetCell.cLocked)return void o.preventDefault();t.editOldValue=l.variables._targetCell.firstChild.value,l.variables._targetCell.firstChild.focus()}else if("button"===l.variables._targetCell.cDataType)l.variables._targetCell.firstChild.focus();else if("checkbox"===l.variables._targetCell.cDataType){if(l.variables._targetCell.cUntarget||l.variables._targetCell.cLocked)return void o.preventDefault();t.editOldValue=l.variables._targetCell.cValue,l.variables._targetCell.firstChild.checked=!l.variables._targetCell.firstChild.checked,t.selectAndCheckboxOnChange(l.variables._targetCell.firstChild),o.preventDefault()}else Object.keys(e.dataType).forEach((t=>{if(l.variables._targetCell.cDataType===t&&e.dataType[t].onSelectedKeyDownSpace){if("function"!=typeof e.dataType[t].onSelectedKeyDownSpace)throw new Error("onSelectedKeyDownSpace must be a function.");e.dataType[t].onSelectedKeyDownSpace(o,l._getData(l.variables._targetCell))}})),o.preventDefault();break;case"ArrowUp":"range"===l.info.gSelectionPolicy&&o.shiftKey?(t.unselectCells(r),l.variables._targetCell.row>=i.row?(a=t.getMoveRowCell(n,-1),t.selectCells(a,i,a)):(a=t.getMoveRowCell(i,-1),t.selectCells(n,a))):(a=t.getMoveRowCell(l.variables._targetCell,-1),t.selectCell(a)),o.preventDefault();break;case"ArrowDown":"range"===l.info.gSelectionPolicy&&o.shiftKey?(t.unselectCells(r),l.variables._targetCell.row<=n.row?(a=t.getMoveRowCell(i,1),t.selectCells(n,a)):(a=t.getMoveRowCell(n,1),t.selectCells(a,i,a))):(a=t.getMoveRowCell(l.variables._targetCell,1),t.selectCell(a)),o.preventDefault();break;case"ArrowLeft":"range"===l.info.gSelectionPolicy&&o.shiftKey?(t.unselectCells(r),l.variables._targetCell.col>=i.col?(a=t.getMoveColCell(n,-1),t.selectCells(a,i,a)):(a=t.getMoveColCell(i,-1),t.selectCells(n,a))):(a=t.getMoveColCell(l.variables._targetCell,-1),t.selectCell(a)),o.preventDefault();break;case"ArrowRight":"range"===l.info.gSelectionPolicy&&o.shiftKey?(t.unselectCells(r),l.variables._targetCell.col<=n.col?(a=t.getMoveColCell(i,1),t.selectCells(n,a)):(a=t.getMoveColCell(n,1),t.selectCells(a,i,a))):(a=t.getMoveColCell(l.variables._targetCell,1),t.selectCell(a)),o.preventDefault()}}},document.removeEventListener("keydown",e._docEvent_keydown),document.addEventListener("keydown",e._docEvent_keydown),e._docEvent_copy=function(e){if(t.activeGrid&&!t.activeGridEditor){const o=t[t.activeGrid.gId].variables._activeCells;o.length>0&&(e.preventDefault(),t.copyGrid(o))}},document.removeEventListener("copy",e._docEvent_copy),document.addEventListener("copy",e._docEvent_copy),e._docEvent_paste=function(e){t.activeGrid&&!t.activeGridEditor&&t[t.activeGrid.gId].variables._activeCells.length>0&&(e.preventDefault(),t.pasteGrid(e,t.activeGrid))},document.removeEventListener("paste",e._docEvent_paste),document.addEventListener("paste",e._docEvent_paste),e._VanillaGrid||(e._VanillaGrid=class extends HTMLElement{constructor(){super()}connectedCallback(){}},customElements.define("v-g",e._VanillaGrid)),e._GridHeader||(e._GridHeader=class extends HTMLElement{constructor(){super()}connectedCallback(){if(!this.style.gridTemplateColumns.includes("%")){const e=t[this.gId];let o=0;for(const t of e._getHeaderRow(1))o+=t.offsetWidth;this.style.width=o+"px"}}},customElements.define("v-g-h",e._GridHeader)),e._GridBody||(e._GridBody=class extends HTMLElement{constructor(){super()}connectedCallback(){if(!this.style.gridTemplateColumns.includes("%")){const e=t[this.gId];let o=0;for(const t of e._getHeaderRow(1))o+=t.offsetWidth;this.style.width=o+"px"}}},customElements.define("v-g-b",e._GridBody)),e._gridFooter||(e._GridFooter=class extends HTMLElement{constructor(){super()}connectedCallback(){if(!this.style.gridTemplateColumns.includes("%")){const e=t[this.gId];let o=0;for(const t of e._getFooterRow(1))o+=t.offsetWidth;this.style.width=o+"px"}}},customElements.define("v-g-f",e._GridFooter)),e._GridData||(e._GridData=class extends HTMLElement{constructor(){super()}connectedCallback(){const o=t[this.gId];switch(this.style.removeProperty("display"),this.style.removeProperty("align-items"),this.style.removeProperty("justify-content"),this.style.removeProperty("text-align"),this.style.removeProperty("z-index"),this.gType){case"ghd":if(this.innerText=this.cValue,o.info.gFrozenRowCount<=0&&this.col<=o.info.gFrozenColCount){let e,t=0;for(let l=this.col-1;l>0;l--)if(e=o._getHeaderCell(this.row,l),e)if(e.rowMerge){let e=this.row-1,r=o._getHeaderCell(e,l);for(;r&&!(e<0)&&r.rowMerge;)e--,r=o._getHeaderCell(e,l);t+=r.offsetWidth}else t+=o._getHeaderCell(this.row,l).offsetWidth;else t+=0;this.style.position="sticky",this.style.zIndex="300",this.style.left=t+"px",this.frozenCol=!0}if(this.rowMerge){let e=this.row-1,t=o._getHeaderCell(e,this.col);for(;t&&!(e<0);){if(!t.rowMerge){t.style.gridRowEnd=this.style.gridRowEnd,t.rowSpan=t.rowSpan?t.rowSpan+1:1,t.style.zIndex=t.style.zIndex?t.style.zIndex:"250";break}e--,t=o._getHeaderCell(e,this.col)}this.style.display="none"}if(this.colMerge){let e=this.col-1,l=o._getHeaderCell(this.row,e);for(;l&&!(e<0);){if(!l.colMerge){if("v-g-rownum"===l.cId||"v-g-status"===l.cId)break;l.style.gridColumnEnd=this.style.gridColumnEnd,l.style.width=t.extractNumberAndUnit(l.style.width).number+this.offsetWidth+"px",l.colSpan=l.colSpan?l.colSpan+1:1,l.style.zIndex=l.style.zIndex?l.style.zIndex:"250";break}e--,l=o._getHeaderCell(this.row,e)}this.style.display="none"}if(this.style.justifyContent="center",this.cColVisible&&this.cRowVisible||(this.style.display="none"),o.getHeaderRowCount()===this.row){let e=this;if(this.rowMerge)for(let t=this.row-1;t>0&&(e=o._getHeaderCell(t,this.col),!e.rowSpan);t--);e&&(e.isLastCell=!0)}if(!0===o.info.gFilterable&&o._getColInfo(this.cId).cFilterable&&o.getHeaderRowCount()===this.row&&"v-g-rownum"!==this.cId&&"v-g-status"!==this.cId){let l;e.filterSpan&&e.filterSpan instanceof HTMLElement&&1===e.filterSpan.nodeType?l=e.filterSpan.cloneNode(!0):(l=document.createElement("span"),l.innerText="σ"),l.gId=this.gId,l.isChild=!0,l.gType="filter",l.classList.add(this.gId+"_filterSpan");const r=document.createElement("select");r.classList.add(this.gId+"_filterSelect"),r.style.display="none",r.gId=this.gId,r.cId=this.cId,r.addEventListener("mousedown",(function(e){t.filterOldValue=e.target.value})),r.addEventListener("change",(function(e){if(t.filterNewValue=e.target.value,!1===t.doEventWithCheckChanged(e.target.parentNode.parentNode.gId,"_onChooseFilter",e.target.parentNode.parentNode.row,e.target.parentNode.parentNode.cId,t.filterOldValue,t.filterNewValue))return e.stopPropagation(),void e.preventDefault();o._doFilter(),"$$ALL"===t.filterNewValue&&(this.style.display="none")})),l.append(r);let n=this;if(this.rowMerge)for(let e=this.row-1;e>0&&(n=o._getHeaderCell(e,this.col),!n.rowSpan);e--);n&&n.insertBefore(l,n.firstChild)}this.classList.add(this.gId+"_h-v-g-d");break;case"gfd":if(o.info.gFrozenRowCount<=0&&this.col<=o.info.gFrozenColCount){let e,t=0;for(let l=this.col-1;l>0;l--)if(e=o._getFooterCell(this.row,l),e)if(e.rowMerge){let e=this.row-1,r=o._getFooterCell(e,l);for(;r&&!(e<0)&&r.rowMerge;)e--,r=o._getFooterCell(e,l);t+=r.offsetWidth}else t+=o._getFooterCell(this.row,l).offsetWidth;else t+=0;this.style.position="sticky",this.style.zIndex="300",this.style.left=t+"px",this.frozenCol=!0}if(this.cFooter){o.cssInfo;let l;this.classList.add(this.gId+"_f-v-g-d-value");try{l=o._getFooterCell(this.row,this.col-1)}catch(e){l=null}if(l&&l.classList.add(this.gId+"_f-v-g-d-value"),this.style.justifyContent="right",t.isIncludeEnum(i,this.cFooter)){let e,l,r;switch(this.cFooter){case"$$MAX":if(o.getRowCount()>0){l=t.getFirstCellValidNumber(o,this),e=l;for(let n=2;n<=o.getRowCount();n++)r=o._getCell(n,this.col),t.isCellVisible(r)&&(l=t.getOnlyNumberWithNaNToNull(r.cValue),l&&l>e&&(e=l))}break;case"$$MIN":if(o.getRowCount()>0){l=t.getFirstCellValidNumber(o,this),e=l;for(let n=2;n<=o.getRowCount();n++)r=o._getCell(n,this.col),t.isCellVisible(r)&&(l=t.getOnlyNumberWithNaNToNull(r.cValue),l&&l<e&&(e=l))}break;case"$$SUM":if(o.getRowCount()>0){e=0;for(let l=1;l<=o.getRowCount();l++)r=o._getCell(l,this.col),t.isCellVisible(r)&&(e=Math.round(1e5*(e+t.getOnlyNumberWithNaNToZero(r.cValue)))/1e5)}break;case"$$AVG":if(o.getRowCount()>0){e=0,l=0;let n=0;for(let l=1;l<=o.getRowCount();l++)r=o._getCell(l,this.col),t.isCellVisible(r)&&(e=Math.round(1e5*(e+t.getOnlyNumberWithNaNToZero(r.cValue)))/1e5,null===r.cValue||void 0===r.cValue||isNaN(r.cValue)||n++);e=0===n?null:(e/n).toFixed(2)}}null==e&&(e="-"),this.innerText=e,this.cValue=e}else if("function"==typeof this.cFooter){const e=this.cFooter(o.getValues());this.innerText=e,this.cValue=e}else this.innerText=this.cFooter,this.cValue=this.cFooter,Array.isArray(e.footerFormula)&&Object.keys(e.footerFormula).forEach((t=>{if(this.cFooter===t){const l=e.footerFormula[t](o.getColValues(this.cIndex));this.innerText=l,this.cValue=l}}))}this.col===o.getColCount()&&this.classList.add(this.gId+"_f-v-g-d-value"),this.cColVisible&&this.cRowVisible||(this.style.display="none"),this.classList.add(this.gId+"_f-v-g-d");break;case"gbd":switch(this.cDataType){case"text":case"mask":this.style.justifyContent="left",this.style.textAlign="left";break;case"number":this.style.justifyContent="right",this.style.textAlign="right";break;case"date":case"month":case"code":case"select":case"checkbox":case"button":case"link":this.style.justifyContent="center",this.style.textAlign="center";break;default:Object.keys(e.dataType).forEach((t=>{this.cDataType===t&&(this.style.justifyContent=e.dataType[t].justifyContent?e.dataType[t].justifyContent:"center",this.style.textAlign=e.dataType[t].textAlign?e.dataType[t].textAlign:"center")}))}if(t.removeAllChild(this),this.append(t.getCellChildNode(this)),this.row<=o.info.gFrozenRowCount){let e,t=o._getHeader().offsetHeight,l=0;for(let t=this.row-1;t>0;t--)if(e=o._getCell(t,this.col),e)if(e.colMerge){let e=this.col-1,r=o._getCell(t,e);for(;r&&!(e<0)&&r.colMerge;)e--,r=o._getCell(t,e);l+=r.offsetHeight}else l+=o._getCell(t,this.col).offsetHeight;else l+=0;this.style.position="sticky",this.style.zIndex="200",this.style.top=t+l+"px",this.row===o.info.gFrozenRowCount&&(this.style.borderBottom=o.cssInfo.verticalBorderSize+"px solid "+o.cssInfo.headerCellBorderColor),this.frozenCol=!0}if(o.info.gFrozenRowCount<=0&&this.col<=o.info.gFrozenColCount){let e,t=0;for(let l=this.col-1;l>0;l--)if(e=o._getCell(this.row,l),e)if(e.rowMerge){let e=this.row-1,r=o._getCell(e,l);for(;r&&!(e<0)&&r.rowMerge;)e--,r=o._getCell(e,l);t+=r.offsetWidth}else t+=o._getCell(this.row,l).offsetWidth;else t+=0;this.style.position="sticky",this.style.zIndex="200",this.col===o.info.gFrozenColCount&&(this.style.borderRight=o.cssInfo.verticalBorderSize+"px solid "+o.cssInfo.headerCellBorderColor),this.style.left=t+"px",this.frozenRow=!0}if(this.rowMerge){let e=this.row-1,l=o._getCell(e,this.col);for(;l&&!(e<0);){if(!l.rowMerge){l.style.gridRowEnd=this.style.gridRowEnd,l.cVerticalAlign||(l.style.alignItems="center"),l.style.zIndex=l.style.zIndex?l.style.zIndex:"50";break}e--,l=o._getCell(e,this.col)}t.isCellVisible(l)&&(this.style.display="none")}if(this.colMerge){let e=this.col-1,t=o._getCell(this.row,e);for(;t&&!(e<0);){if(!t.colMerge){t.style.gridColumnEnd=this.style.gridColumnEnd,t.cAlign||(t.style.justifyContent="center"),t.cAlign||(t.style.textAlign="center"),t.cVerticalAlign||(t.style.alignItems="center"),t.style.zIndex=t.style.zIndex?t.style.zIndex:"50";break}e--,t=o._getCell(this.row,e)}this.style.display="none"}this.cAlign&&(this.style.justifyContent=this.cAlign,this.style.textAlign=this.cAlign),this.cVerticalAlign&&(this.style.alignItems=t.getVerticalAlign(this.cVerticalAlign)),this.cBackColor&&(this.style.backgroundColor=this.cBackColor),this.cFontColor&&(this.firstChild.style.color=this.cFontColor),this.cFontBold&&(this.firstChild.style.fontWeight="bold"),this.cFontItalic&&(this.firstChild.style.fontStyle="italic"),this.cFontThruline&&(this.firstChild.style.textDecoration="line-through"),this.cFontUnderline&&(this.firstChild.style.textDecoration="underline"),this.cColVisible&&this.cRowVisible||(this.style.display="none"),this.cFilter&&(this.style.display="none"),o.info.gAlterRow&&this.row%2==0?(this.classList.add(this.gId+"_b-v-g-d-alter"),this.classList.remove(this.gId+"_b-v-g-d")):(this.classList.add(this.gId+"_b-v-g-d"),this.classList.remove(this.gId+"_b-v-g-d-alter")),this.cLocked&&this.cLockedColor?this.classList.add(this.gId+"_b-v-g-d-locked"):this.classList.remove(this.gId+"_b-v-g-d-locked"),this.cLocked&&("select"===this.cDataType&&this.firstChild&&"select"==this.firstChild.nType||"checkbox"===this.cDataType&&this.firstChild&&"checkbox"==this.firstChild.nType)&&(this.firstChild.disabled=!0,this.firstChild.style.pointerEvents="none"),this.cUntarget&&("button"===this.cDataType&&this.firstChild&&"button"==this.firstChild.nType?(this.firstChild.disabled=!0,this.firstChild.style.pointerEvents="none"):"link"===this.cDataType&&this.firstChild&&"link"==this.firstChild.nType&&(this.firstChild.style.opacity="0.8",this.firstChild.style.pointerEvents="none"))}this.classList.add(this.gId+"_v-g-d"),this.addEventListener("mouseover",(function(e){if(!this.cUntarget&&"gbd"===this.gType&&(this.classList.add(this.gId+"_mouseover-cell"),"link"===this.cDataType)){this.querySelectorAll("*").forEach((e=>{e.classList.add(this.gId+"_mouseover-cell")}))}})),this.addEventListener("mouseout",(function(e){if(!this.cUntarget&&"gbd"===this.gType&&(this.classList.remove(this.gId+"_mouseover-cell"),"link"===this.cDataType)){this.querySelectorAll("*").forEach((e=>{e.classList.remove(this.gId+"_mouseover-cell")}))}}))}},customElements.define("v-g-d",e._GridData))}}}function vanillagrid_onBeforeCreate(e,t){return!0}function vanillagrid_onAfterCreate(e,t){}function vanillanote_onDestroy(e){const t=document.querySelectorAll("vanilla-grid");for(const e of t){const t=e.getAttribute("id");delete window[t];const o=document.getElementById(t+"_styles-sheet");o.parentNode.removeChild(o),e.parentNode.removeChild(e)}return e&&(e._docEvent_mousedown&&document.removeEventListener("mousedown",e._docEvent_mousedown),e._docEvent_mouseup&&document.removeEventListener("mouseup",e._docEvent_mouseup),e._docEvent_keydown&&document.removeEventListener("keydown",e._docEvent_keydown),e._docEvent_copy&&document.removeEventListener("copy",e._docEvent_copy),e._docEvent_paste&&document.removeEventListener("paste",e._docEvent_paste),e._VanillaGrid=null,e._GridHeader=null,e._GridBody=null,e._GridHeader=null,e._GridFooter=null,e._GridData=null,e=null),!0}window.addEventListener("load",(function(e){const t=getVanillagrid();!1!==vanillagrid_onBeforeCreate(e,t)&&(t.create(),vanillagrid_onAfterCreate(e,t))}));
